<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-codestack/solidworks-api/document/assembly/context/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Overview of SOLIDWORKS Assembly context and usage from API | solidworks-GPT</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/context/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Overview of SOLIDWORKS Assembly context and usage from API | solidworks-GPT"><meta data-rh="true" name="description" content="Explanation of assembly contexts and the ways to transform the pointer form assembly context to the model context and vice-versa using SOLIDWORKS API"><meta data-rh="true" property="og:description" content="Explanation of assembly contexts and the ways to transform the pointer form assembly context to the model context and vice-versa using SOLIDWORKS API"><meta data-rh="true" property="og:image" content="https://jiaqiwang969.github.io/solidworks-GPT/assembly-model-context.png"><meta data-rh="true" name="twitter:image" content="https://jiaqiwang969.github.io/solidworks-GPT/assembly-model-context.png"><link data-rh="true" rel="icon" href="/solidworks-GPT/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/context/"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/context/" hreflang="en"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/assembly/context/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/context/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/solidworks-GPT/blog/rss.xml" title="solidworks-GPT RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/solidworks-GPT/blog/atom.xml" title="solidworks-GPT Atom Feed"><link rel="stylesheet" href="/solidworks-GPT/assets/css/styles.ec1106c8.css">
<link rel="preload" href="/solidworks-GPT/assets/js/runtime~main.b7deab76.js" as="script">
<link rel="preload" href="/solidworks-GPT/assets/js/main.49af3e3b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solidworks-GPT/"><div class="navbar__logo"><img src="/solidworks-GPT/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/solidworks-GPT/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">My Site</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/context/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/assembly/context/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/solidworks-GPT/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/solidworks-GPT/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jiaqiwang969/solidworks-GPT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solidworks-GPT/docs/category/codestack">CodeStack</a><button aria-label="Toggle the collapsible sidebar category &#x27;CodeStack&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/docs/category/solidworks-api">solidworks-api</a><button aria-label="Toggle the collapsible sidebar category &#x27;solidworks-api&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/">SOLIDWORKS API Code Exampels for Macros and Add-ins</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/getting-started">getting-started</a><button aria-label="Toggle the collapsible sidebar category &#x27;getting-started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/docs/category/document">document</a><button aria-label="Toggle the collapsible sidebar category &#x27;document&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/">Automating SOLIDWORKS parts, assemblies and drawings using API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/">Automating assemblies using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Automating assemblies using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/components/">Assembly components automation using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Assembly components automation using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/mates/">Automating mates in assemblies using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Automating mates in assemblies using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/add-display-data-marks/">Macro to add display data marks to configuration used by the main SOLIDWORKS assembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/compose-flat-bom/">SOLIDWORKS VBA macro to compose flat BOM table using API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/context/">Overview of SOLIDWORKS Assembly context and usage from API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/display-assembly-visualization-page/">Display assembly visualization page using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/insert-pipe/">Insert pipe component between fittings using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/open-component-ldr/">Open selected components in the Large Design Review (LDR) mode</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/drawing/">Automating drawings using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Automating drawings using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/model-view/">Manipulating model views using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Manipulating model views using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/features-manager/">Features Manager Tree automation using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Features Manager Tree automation using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/selection/">Performing entity selection using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Performing entity selection using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/sketch/">Working with sketch using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with sketch using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/dimensions/">Working with dimensions using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with dimensions using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/tables/">Tables (BOM, General, Revision etc.) automation using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tables (BOM, General, Revision etc.) automation using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/notes/">Working with Notes using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with Notes using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/sheet-metal/">Automation Sheet Metal parts using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Automation Sheet Metal parts using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/cut-lists/">Managing cut-list bodies using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Managing cut-list bodies using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/appearance/">Configuring document appearance using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuring document appearance using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/tracking-objects/">Tracking objects by temp and persistent ids in SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tracking objects by temp and persistent ids in SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/macro-feature/">Utilizing Macro Features in SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Utilizing Macro Features in SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/materials/">Working with part materials using SOLIDWORKS API</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with part materials using SOLIDWORKS API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/auto-part-number-title/">Set title as part number for new file using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/block-model-editing/">Block model editing using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/change-global-variable-value/">Change value of global variable in model using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/clear-layer/">Remove all items from the layer in SOLIDWORKS model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/configuration-bom-options/">Macro to change the Bill Of Materials options (Part Number source and children visibility) of SOLIDWORKS configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/configuration-reviewer/">VBA macro to review SOLIDWORKS sheets and configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/delete-model-equations/">Delete all equations from SOLIDWORKS model using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/file-close-event/">Handling pre and post close notifications using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/manage-external-references/">SOLIDWORKS macro to break, lock or unlock all external references for files and components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/print/">Macro to print SOLIDWORKS documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/rebuild/">Macro to force rebuild SOLIDWORKS document</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/set-bom-quantity-unit-of-measure-property/">Set BOM Quantity (Unit Of Measure) property using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/set-new-file-name/">Automatically assign new file name for SOLIDWORKS files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/suspend-graphics-update/">Macro to suspend graphics update using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/suspend-rebuild/">Macro to suspend rebuild operation in SOLIDWORKS model using API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/upgrade-cosmetic-threads/">Upgrade cosmetic threads in active SOLIDWORKS part or assembly using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/solidworks-api/document/versions-report/">Generate report for the SOLIDWORKS file versions (created and last saved) for all the files in the folder</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/application">application</a><button aria-label="Toggle the collapsible sidebar category &#x27;application&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/data-storage">data-storage</a><button aria-label="Toggle the collapsible sidebar category &#x27;data-storage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/geometry">geometry</a><button aria-label="Toggle the collapsible sidebar category &#x27;geometry&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/adornment">adornment</a><button aria-label="Toggle the collapsible sidebar category &#x27;adornment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/import-export">import-export</a><button aria-label="Toggle the collapsible sidebar category &#x27;import-export&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/options">options</a><button aria-label="Toggle the collapsible sidebar category &#x27;options&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/deployment">deployment</a><button aria-label="Toggle the collapsible sidebar category &#x27;deployment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/motion-study">motion-study</a><button aria-label="Toggle the collapsible sidebar category &#x27;motion-study&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/troubleshooting">troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/solidworks-pdm-api">solidworks-pdm-api</a><button aria-label="Toggle the collapsible sidebar category &#x27;solidworks-pdm-api&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/solidworks-document-manager-api">solidworks-document-manager-api</a><button aria-label="Toggle the collapsible sidebar category &#x27;solidworks-document-manager-api&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/edrawings-api">edrawings-api</a><button aria-label="Toggle the collapsible sidebar category &#x27;edrawings-api&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/solidworks-tools">solidworks-tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;solidworks-tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/visual-basic">visual-basic</a><button aria-label="Toggle the collapsible sidebar category &#x27;visual-basic&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/hosting">hosting</a><button aria-label="Toggle the collapsible sidebar category &#x27;hosting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/angular">angular</a><button aria-label="Toggle the collapsible sidebar category &#x27;angular&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/docs/category/hosting-1">hosting</a><button aria-label="Toggle the collapsible sidebar category &#x27;hosting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/CONTRIBUTING">CONTRIBUTING</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/LICENSE">LICENSE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/docs/codestack/">README</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solidworks-GPT/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/solidworks-GPT/docs/tutorial-basics/create-a-page">Tutorial - Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/solidworks-GPT/docs/tutorial-extras/manage-docs-versions">Tutorial - Extras</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/solidworks-GPT/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/docs/category/codestack"><span itemprop="name">CodeStack</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/docs/category/solidworks-api"><span itemprop="name">solidworks-api</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/docs/category/document"><span itemprop="name">document</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/"><span itemprop="name">Automating assemblies using SOLIDWORKS API</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Overview of SOLIDWORKS Assembly context and usage from API</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Overview of SOLIDWORKS Assembly context and usage from API</h1></header><p><img loading="lazy" alt="Assembly and Model contexts" src="/solidworks-GPT/assets/images/assembly-model-context-807e12b07cbde7ee863756265cf7576d.png" width="1338" height="899" class="img_ev3q">{ width=450 }</p><p>All SOLIDWORKS entities in 3D models (parts and assemblies) can be presented in 2 different contexts:</p><ul><li>Model context - this is the context the entity is created in. For example feature created in the part document, dimension added in the part. Solid body with the faces generated by boss-extrude feature</li><li>Assembly context - this is the context where the models (and all their entities) are instantiated. For example the same part can be added twice into the assembly, so the elements of this part would have two different sets of pointers in the assembly which correspond to the corresponding components.</li></ul><p>It is important to use the correct contexts when working with elements from SOLIDWORKS API. When assembly in-context editing is performed all the pointers must be provided in the assembly context.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-features-into-part-in-the-context-of-the-assembly">Adding features into part in the context of the assembly<a href="#adding-features-into-part-in-the-context-of-the-assembly" class="hash-link" aria-label="Direct link to Adding features into part in the context of the assembly" title="Direct link to Adding features into part in the context of the assembly">​</a></h2><p>It is required to always use the pointer to active assembly document (<a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isldworks~activedoc.html" target="_blank" rel="noopener noreferrer">ISldWorks::ActiveDoc</a>) while editing or adding new features in the feature tree even if component is in editing state.</p><p><img loading="lazy" alt="Editing the component in the context" src="/solidworks-GPT/assets/images/in-context-editing-5e9451b70170d397e3c872197b9648dc.png" width="824" height="651" class="img_ev3q">{ width=250 }</p><p>For example to insert the extruded feature into the part document from the image above which is edited in the context the <a href="https://help.solidworks.com/2012/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IFeatureManager~FeatureExtrusion2.html" target="_blank" rel="noopener noreferrer">IFeatureManager::FeatureExtrusion2</a> must be called on the <a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imodeldoc2_methods.html" target="_blank" rel="noopener noreferrer">IModelDoc2</a> which is an active assembly but not the model of the component being edited.</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swAssy As SldWorks.AssemblyDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swAssy = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If Not swAssy Is Nothing Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swAssy.InsertNewVirtualPart Nothing, swComp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swComp.Select4 False, Nothing, False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swAssy.EditPart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Debug.Assert swComp.GetModelDoc2() Is swAssy.GetEditTarget() &#x27;current editing model equals to the component&#x27;s model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Debug.Assert Not swComp.GetModelDoc2() Is swAssy &#x27;component&#x27;s model doesn&#x27;t equal to the assembly model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swRefPlaneFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swRefPlaneFeat = FindStandardPlane(swComp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swSketchFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;Creating circle in the context of the current editing model via the main assembly model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swSketchFeat = CreateCircle(swRefPlaneFeat, swAssy)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;Creating extrude in the context of the current editing model via the main assembly model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CreateExtrude swSketchFeat, swAssy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swAssy.EditAssembly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swAssy.EditRebuild</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MsgBox &quot;Please open assembly&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function FindStandardPlane(comp As SldWorks.Component2) As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swCompModel As SldWorks.ModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swCompModel = comp.GetModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swRefPlaneFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swRefPlaneFeat = swCompModel.FeatureByPositionReverse(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i = i + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Loop While swRefPlaneFeat.GetTypeName2() &lt;&gt; &quot;RefPlane&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;converting the pointer of the feature into the assembly context so it can be selected in the assembly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set FindStandardPlane = comp.GetCorresponding(swRefPlaneFeat)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function CreateCircle(plane As SldWorks.Feature, model As SldWorks.ModelDoc2) As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plane.Select2 False, -1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.SketchManager.InsertSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.SketchManager.AddToDB = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set CreateCircle = model.SketchManager.ActiveSketch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.ClearSelection2 True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.SketchManager.CreateCircleByRadius 0, 0, 0, 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.SketchManager.AddToDB = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.ClearSelection2 True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.SketchManager.InsertSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub CreateExtrude(sketch As SldWorks.Feature, model As SldWorks.ModelDoc2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sketch.Select2 False, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.FeatureManager.FeatureExtrusion2 True, False, False, 0, 0, 0.01, 0.01, False, False, False, False, 0, 0, False, False, False, False, True, True, True, 0, 0, False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model.ClearSelection2 True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="converting-the-pointers">Converting the pointers<a href="#converting-the-pointers" class="hash-link" aria-label="Direct link to Converting the pointers" title="Direct link to Converting the pointers">​</a></h2><p>SOLIDWORKS API provides the method to convert the pointers between contexts:</p><ul><li><a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imodeldocextension~getcorresponding.html" target="_blank" rel="noopener noreferrer">IModelDocExtension::GetCorresponding</a> converts the pointer from the assembly context into the underlying component&#x27;s model context</li><li><a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.icomponent2~getcorresponding.html" target="_blank" rel="noopener noreferrer">IComponent2::GetCorresponding</a> converts the pointer from the underlying model context to the assembly context for this component.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="model-operations-in-the-context-of-the-assembly">Model operations in the context of the assembly<a href="#model-operations-in-the-context-of-the-assembly" class="hash-link" aria-label="Direct link to Model operations in the context of the assembly" title="Direct link to Model operations in the context of the assembly">​</a></h2><p><img loading="lazy" alt="3D Sketch with a sketch point within the component" src="/solidworks-GPT/assets/images/component-3dsketch-c3c7ed093083f6639cf0fa8bc13a16b8.png" width="721" height="537" class="img_ev3q">{ width=350 }</p><p>The following test cases will demonstrate different approaches and results while working with context in assembly. <a target="_blank" href="/solidworks-GPT/assets/files/SketchAssm-b7bdab20534be14a124e4b840d9b9de9.SLDASM">Download Sample Assembly</a>. This assembly consists of a single virtual component (this can be an external components as well). There is a 3D Sketch (<em>3DSketch1</em>) with a point in the component&#x27;s model. For simplicity another sketch called <em>Reference</em> is added to the assembly which displays current point coordinate.</p><p>The purposes of the following cases is to move the point in the 3D Sketch in XYZ by 10 mm from the assembly.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-case-1-moving-by-acquiring-the-pointers-directly-from-the-assembly-context">Test Case 1: Moving by acquiring the pointers directly from the assembly context<a href="#test-case-1-moving-by-acquiring-the-pointers-directly-from-the-assembly-context" class="hash-link" aria-label="Direct link to Test Case 1: Moving by acquiring the pointers directly from the assembly context" title="Direct link to Test Case 1: Moving by acquiring the pointers directly from the assembly context">​</a></h3><p>When assembly is opened pointer to any object retrieved directly from the assembly or from the component will have the active assembly context.</p><p>For example:</p><ul><li><a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iselectionmgr~getselectedobject6.html" target="_blank" rel="noopener noreferrer">ISelectionMgr::GetSelectedObject6</a> of the object selected in the component (e.g. face or feature) will be valid in the current assembly</li><li><a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.icomponent2~firstfeature.html" target="_blank" rel="noopener noreferrer">IComponent2::FirstFeature</a> returns the pointer for the first feature in the component&#x27;s model in the context of the assembly.</li></ul><p>These pointers are safe to work with within the context of this assembly. For example face colour can be changed, feature can be renamed, point coordinate can be modified.</p><ul><li>Open downloaded sample assembly</li><li>Select the <em>3DSketch1</em> feature in the tree</li><li>Run the following macro</li></ul><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swAssy As SldWorks.AssemblyDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swAssy = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If Not swAssy Is Nothing Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swFeat = swAssy.SelectionManager.GetSelectedObject6(1, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MoveSketchPoints swFeat, swAssy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;exit edit in context model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swAssy.ClearSelection2 True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swAssy.EditAssembly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MsgBox &quot;Please open assembly document&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub MoveSketchPoints(sketchFeat As SldWorks.Feature, editModel As SldWorks.ModelDoc2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swSketch As SldWorks.Sketch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swSketch = sketchFeat.GetSpecificFeature2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Print &quot;Sketch Feature Selected: &quot; &amp; sketchFeat.Select2(False, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    editModel.SketchManager.Insert3DSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim vSkPts As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vSkPts = swSketch.GetSketchPoints2()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For i = 0 To UBound(vSkPts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swSkPt As SldWorks.SketchPoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swSkPt = vSkPts(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.X = swSkPt.X + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.Y = swSkPt.Y + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.Z = swSkPt.Z + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    editModel.SketchManager.Insert3DSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As the result sketch point is moved by 10 mm in XYZ directions.</p><p><img loading="lazy" alt="Sketch point updated its location" src="data:image/png;base64,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" width="298" height="403" class="img_ev3q">{ width=250 }</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-case-2-accessing-the-objects-from-the-underlying-model-context-in-the-context-of-the-assembly">Test Case 2: Accessing the objects from the underlying model context in the context of the assembly<a href="#test-case-2-accessing-the-objects-from-the-underlying-model-context-in-the-context-of-the-assembly" class="hash-link" aria-label="Direct link to Test Case 2: Accessing the objects from the underlying model context in the context of the assembly" title="Direct link to Test Case 2: Accessing the objects from the underlying model context in the context of the assembly">​</a></h3><p>It is not always possible to retrieve the pointer to the required object directly from the assembly context. If out of context object (i.e. object which was retrieved or converted to the underlying component&#x27;s model) is used within the assembly context this may produce unexpected results.</p><blockquote><p>Using of out of context object equivalent of invoking the APIs on the invisible model. In some cases this will produce correct behaviour, in some cases it may fail or even cause the crash.</p></blockquote><p>The following example demonstrates the result of using out of context pointers by converting the context from assembly to the underlying document via <a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imodeldocextension~getcorresponding.html" target="_blank" rel="noopener noreferrer">IModelDocExtension::GetCorresponding</a></p><p>Follow the steps from previous test case and run the following macro</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swAssy As SldWorks.AssemblyDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swAssy = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If Not swAssy Is Nothing Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swFeat = swAssy.SelectionManager.GetSelectedObject6(1, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swComp = swFeat.GetComponent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swCorrFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swCompModel As SldWorks.ModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swCompModel = swComp.GetModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swCorrFeat = swCompModel.Extension.GetCorresponding(swFeat)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swCorrFeatByName As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swCorrFeatByName = swCompModel.FeatureByName(swFeat.Name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Debug.Print &quot;Pointers are equal: &quot; &amp; (swCorrFeat Is swCorrFeatByName)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MoveSketchPoints swCorrFeat, swCompModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MsgBox &quot;Please open assembly document&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub MoveSketchPoints(sketchFeat As SldWorks.Feature, editModel As SldWorks.ModelDoc2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swSketch As SldWorks.Sketch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swSketch = sketchFeat.GetSpecificFeature2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Print &quot;Sketch Feature Selected: &quot; &amp; sketchFeat.Select2(False, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    editModel.SketchManager.Insert3DSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim vSkPts As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vSkPts = swSketch.GetSketchPoints2()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For i = 0 To UBound(vSkPts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swSkPt As SldWorks.SketchPoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swSkPt = vSkPts(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.X = swSkPt.X + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.Y = swSkPt.Y + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.Z = swSkPt.Z + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    editModel.SketchManager.Insert3DSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As the result sketch points are not moved despite the output window displays the success</p><p><img loading="lazy" alt="Sketch point is not moved despite no errors displayed" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcAAAAHJCAMAAAAl9BmJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAAAD/AJCQOpDb/8nx++n6/vf4+P7+/3ZMADqQ26zFwQA6kGza9VRUVJq10QAAMv/bkGaQkMDAwSgAM+zs7HJycrPMxTo6OmCo3yYAADo6kN6ShB4eHv+2Zn1PTqG717XO5s1zYwArfZqamsvLzdnZ2wBmtrhDLLZmAGLX9GYAOv//tu7u7rDr+eLi4tuQOqnC3aqofbnQ6GYAAJ651HpuMuzFvwAAWmVSgSZunkMUIqqqqrHK5I+/24qJibZmOma2/6S+2TMzM/Hx8WYAZpA6AGEsAOCroObm5sbGytHR1KzF4CcAW37J46zFnwBNnoCAgJBmkJA6OoBWVruam08mNXa/29WFdpies5qRXIuRqdmajkYAMl09TWJhYfTTzFNWZiZuv9XV2MViT5WWld3d3r29vToAAJjk+NqdkZfI4s7O0Lb//6CgoESM3o9rMa+uroLf9gAAZjoAOmZmZl5eXuS0q7CPW0NDQ5NvWtv2/JdxMzoAZnh3d2Su5LpJMkUAAOGZjH5RAL9UPyUlJeSfkrHKo6uMWb3u+7Kysry8v8/P0bGugAAAOmlpaei9tQBRo3jc9u/IwfDLxAAtgJPF4ChyxKXo+N2jmHrE3pnL5Y3i97GRW+jo6ZlyM4DM5pJuMkgANHpOAFApOEWN4IBSAJHD3XvF4CdxwigAACdvwQAAAJnMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwAM8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8Amf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+ZzP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///xA4/uMAAACsdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wAFlRWxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASwUlEQVR4Xu3dj2Mb513HcYWCTRlmrlGWMhbatXbrESMHAg3YJmssstnxWA20MPajhJCkjMwsjHYrbKWjLSuZu+z3GNtcQtaxwV/J9/t9nrvnudPpl2PJ93nu814sne6H7nQv30mWtK01y6AjIHgEBI+A4BEQPAKCR0DwCAheDrjJ6paXGVwA9NesLo0N+CusThEQPAKCR0DwZgiI3fiAv8vq1C8QEDsCgvfPBMRufMBH2PT7+KfW4j71cT/+kUfGB7zIpt9zz/5V3LPP+fEXL/48ARFa+/a/xX17zY8nIEhr3/rXuG8FwH8/LOBnW63H/tAPD+uzz1y8+Ivn/9zfYuO39tSvxz11P4BnfXcf+x8/NLS7z/gB35ujL8qstU88+eSTv3Hliv6ToU+s+fFnz/4WAREywCuzs/qvCPgf9wV47w8+1Gr9/W//Wuv8f54t3jh7t9V698NyfU9Otb8ngPf++uxZmdbSpVqtlozJ5mDD80egAJSPwPEBd3x3H/vuzr13P7xzt/XYd3/pQ8/sFG/o1DfP/3Tnnl63dOr/7ez808M7NvFNGZnPwUbIAFXQ/ATQj9/Z+dv7AxSNj375HUcS3/joJx/eEax37NqmKKCmc+pPNocbywbnj8ClpSV/BPrxhwHc8H3xO3+38drPNja+8sl/2dj4QunGF+QsKb3z1kf+WGf9xoZN3fiijJM5de5sDrsvNqS1T7/66qvip/9k6NNrfvzGxg8PDfj2d36w8dr3vNmPSjd+dF7hZNCu31bA72185csyl85pP34ONkpr33/99df/7MoV/SdD3w+A/zAZwLd+Va4ld/2aA7TDURfTubM52Citffhv4j58VIA/UbP/9oDFG+f/a+M9vy/X6tUSQJmqZm/9r46QifkcbITWPv/+uM8HwG8eFvBteTb7QX/AjZ/IE5yMeI/8afENPYXqVF3mL2WijNQxbg42Qmtf/4u4r98P4KNs+v342afinv2xH//oo79MQIQ+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" width="448" height="457" class="img_ev3q">{ width=250 }</p><p>The reason of this behaviour caused by the fact that sketch cannot be edited if the model is not opened in its own window.</p><p>Now, open the component in its own window</p><p><img loading="lazy" alt="Open part in its own window from the component" src="/solidworks-GPT/assets/images/open-part-from-component-5b514d0d8b08ef626a684ded5ad68a03.png" width="512" height="518" class="img_ev3q">{ width=250 }</p><p>Activate the assembly and rerun the macro. Now slightly different result is displayed. Component is marked as modified and needs rebuilding. If model rebuilt sketch is updated accordingly.</p><p><img loading="lazy" alt="Component needs rebuilding after out of the context modification" src="/solidworks-GPT/assets/images/needs-rebuild-component-9fb8e6a35fd28a6cf91fa77c7249f805.png" width="321" height="523" class="img_ev3q">{ width=200 }</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-case-3-converting-the-context-of-objects">Test Case 3: Converting the context of objects<a href="#test-case-3-converting-the-context-of-objects" class="hash-link" aria-label="Direct link to Test Case 3: Converting the context of objects" title="Direct link to Test Case 3: Converting the context of objects">​</a></h3><p>In many cases the initial pointer is available in the context of the underlying model. And if modifications required in the context of assembly it is required to convert the pointer via <a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.icomponent2~getcorresponding.html" target="_blank" rel="noopener noreferrer">IComponent2::GetCorresponding</a> method.</p><ul><li>Close all models and reopen sample assembly</li><li>Open the part component in its own window.</li></ul><p><img loading="lazy" alt="Open part in its own window from the component" src="/solidworks-GPT/assets/images/open-part-from-component-5b514d0d8b08ef626a684ded5ad68a03.png" width="512" height="518" class="img_ev3q">{ width=250 }</p><ul><li>Select the <em>3DSketch1</em> in the active part document</li><li>Run the following macro</li></ul><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swModel As SldWorks.ModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swModel = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If Not swModel Is Nothing Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swFeat = swModel.SelectionManager.GetSelectedObject6(1, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Stop &#x27;Activate assembly and select the component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swAssy As SldWorks.AssemblyDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swAssy = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swComp = swAssy.SelectionManager.GetSelectedObjectsComponent4(1, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swCompFeat As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swCompFeat = swComp.GetCorresponding(swFeat)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swCompFeatByName As SldWorks.Feature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swCompFeatByName = swComp.FeatureByName(swFeat.Name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Debug.Print &quot;Pointers are equal: &quot; &amp; (swCompFeat Is swCompFeatByName)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MoveSketchPoints swCompFeat, swAssy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MsgBox &quot;Please open assembly document&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub MoveSketchPoints(sketchFeat As SldWorks.Feature, editModel As SldWorks.ModelDoc2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swSketch As SldWorks.Sketch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swSketch = sketchFeat.GetSpecificFeature2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Print &quot;Sketch Feature Selected: &quot; &amp; sketchFeat.Select2(False, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    editModel.SketchManager.Insert3DSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim vSkPts As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vSkPts = swSketch.GetSketchPoints2()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For i = 0 To UBound(vSkPts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swSkPt As SldWorks.SketchPoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set swSkPt = vSkPts(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.X = swSkPt.X + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.Y = swSkPt.Y + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        swSkPt.Z = swSkPt.Z + 0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    editModel.SketchManager.Insert3DSketch True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Macro stops execution</li><li>Activate the assembly (you can just close the part document)</li><li>Select the component and continue the macro</li></ul><p>Macro will convert the context and change the coordinate so the coordinates can be successfully updated in the context of the assembly</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><ul><li><p>When adding or editing features of the components in the context of the assembly call <a href="https://help.solidworks.com/2017/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iassemblydoc~editpart2.html" target="_blank" rel="noopener noreferrer">IAssemblyDoc::EditPart2</a>/<a href="https://help.solidworks.com/2017/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.iassemblydoc~editassembly.html" target="_blank" rel="noopener noreferrer">IAssemblyDoc::EditAssembly</a> to start/finish editing the component in the context</p></li><li><p>It is not required to explicitly set the <em>Edit In Context</em> state to perform certain operations (for example editing the sketch points location, deleting features etc.). The behaviour matches the user interface behaviour (i.e. if it is required to call <em>Edit Part</em> command to perform certain operation it is required to call corresponding API as well)</p></li><li><p>Do not use the pointer of the component&#x27;s underlying model (<a href="https://help.solidworks.com/2017/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.icomponent2~getmodeldoc2.html" target="_blank" rel="noopener noreferrer">IComponent2::GetModelDoc2</a>) to perform the operation of the current editing target component. Use the pointer to top level document (i.e. active assembly)</p></li><li><p>Avoid using the incorrect context. This may result in unexpected behaviour.</p></li><li><p>Use ::GetCorresponding functions to convert the pointer between contexts when needed</p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/document/assembly/context/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/compose-flat-bom/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SOLIDWORKS VBA macro to compose flat BOM table using API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solidworks-GPT/docs/codestack/solidworks-api/document/assembly/display-assembly-visualization-page/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Display assembly visualization page using SOLIDWORKS API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#adding-features-into-part-in-the-context-of-the-assembly" class="table-of-contents__link toc-highlight">Adding features into part in the context of the assembly</a></li><li><a href="#converting-the-pointers" class="table-of-contents__link toc-highlight">Converting the pointers</a></li><li><a href="#model-operations-in-the-context-of-the-assembly" class="table-of-contents__link toc-highlight">Model operations in the context of the assembly</a><ul><li><a href="#test-case-1-moving-by-acquiring-the-pointers-directly-from-the-assembly-context" class="table-of-contents__link toc-highlight">Test Case 1: Moving by acquiring the pointers directly from the assembly context</a></li><li><a href="#test-case-2-accessing-the-objects-from-the-underlying-model-context-in-the-context-of-the-assembly" class="table-of-contents__link toc-highlight">Test Case 2: Accessing the objects from the underlying model context in the context of the assembly</a></li><li><a href="#test-case-3-converting-the-context-of-objects" class="table-of-contents__link toc-highlight">Test Case 3: Converting the context of objects</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/solidworks-GPT/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/solidworks-GPT/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/jiaqiwang969/solidowrks-GPT" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/solidworks-GPT/assets/js/runtime~main.b7deab76.js"></script>
<script src="/solidworks-GPT/assets/js/main.49af3e3b.js"></script>
</body>
</html>