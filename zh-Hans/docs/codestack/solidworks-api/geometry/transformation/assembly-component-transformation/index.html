<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-codestack/solidworks-api/geometry/transformation/assembly-component-transformation/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">装配中的组件变换 | solidworks-GPT</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="装配中的组件变换 | solidworks-GPT"><meta data-rh="true" name="description" content="本示例说明了装配中组件的旋转和平移变换"><meta data-rh="true" property="og:description" content="本示例说明了装配中组件的旋转和平移变换"><link data-rh="true" rel="icon" href="/solidworks-GPT/zh-Hans/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/" hreflang="en"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/solidworks-GPT/zh-Hans/blog/rss.xml" title="solidworks-GPT RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/solidworks-GPT/zh-Hans/blog/atom.xml" title="solidworks-GPT Atom Feed"><link rel="stylesheet" href="/solidworks-GPT/zh-Hans/assets/css/styles.ec1106c8.css">
<link rel="preload" href="/solidworks-GPT/zh-Hans/assets/js/runtime~main.45a3328d.js" as="script">
<link rel="preload" href="/solidworks-GPT/zh-Hans/assets/js/main.3d1c5466.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solidworks-GPT/zh-Hans/"><div class="navbar__logo"><img src="/solidworks-GPT/zh-Hans/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/solidworks-GPT/zh-Hans/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">My Site</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/solidworks-GPT/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/solidworks-GPT/zh-Hans/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/solidworks-GPT/zh-Hans/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jiaqiwang969/solidworks-GPT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solidworks-GPT/zh-Hans/docs/category/codestack">CodeStack</a><button aria-label="打开/收起侧边栏菜单「CodeStack」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-api">solidworks-api</a><button aria-label="打开/收起侧边栏菜单「solidworks-api」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/getting-started">getting-started</a><button aria-label="打开/收起侧边栏菜单「getting-started」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/document">document</a><button aria-label="打开/收起侧边栏菜单「document」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/application">application</a><button aria-label="打开/收起侧边栏菜单「application」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/data-storage">data-storage</a><button aria-label="打开/收起侧边栏菜单「data-storage」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/geometry">geometry</a><button aria-label="打开/收起侧边栏菜单「geometry」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/bodies-diff/">使用SOLIDWORKS宏比较零件的几何差异</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/body-extreme-points/">使用SOLIDWORKS API获取物体上的极值点的宏</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/body-rotate-animation/">使用SOLIDWORKS API创建物体旋转动画</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/create-bspline-curve/">使用SOLIDWORKS API创建和显示B样条曲线</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/create-selectable-bounding-box/">使用SOLIDWORKS API创建可选择的3D边界框草图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/cylindrical-face-type/">使用SOLIDWORKS API获取圆柱面的类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/determine-hole-boss/">使用SOLIDWORKS API确定所选面是孔还是凸台</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/face-iso-curves/">使用SOLIDWORKS API创建面的ISO曲线的宏</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/fill-hole/">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/get-bounding-cylinder/">使用SOLIDWORKS API查找体的边界圆柱体</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/get-bspline-parameters/">Get B-Spline Parameters from Selected Edge using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/get-face-center-parameters/">使用SOLIDWORKS API获取面的质心参数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/">使用SOLIDWORKS API处理几何图形（IModeler）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/insert-bodies-to-part/">将实体保存为单独的SOLIDWORKS零件文档的宏</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/offset-planar-wire-body/">使用SOLIDWORKS API偏移平面曲线（线体）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/precise-bounding-box/">使用SOLIDWORKS API创建精确的零件边界框的宏</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/primitives/">Code Examples for Creating Geometric Primitives using the SOLIDWORKS API</a><button aria-label="打开/收起侧边栏菜单「Code Examples for Creating Geometric Primitives using the SOLIDWORKS API」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/ray-intersection/">射线交点</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/read-body-from-file/">使用SOLIDWORKS API读取和显示文件中的实体</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/reconstruct-spherical-surface/">使用 SOLIDWORKS 模型 API 重建球面的宏</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/save-body-to-file/">使用SOLIDWORKS API将选定的实体保存到外部文件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/selected-edge-create-sketch-points/">使用SOLIDWORKS API在选定边上创建草图点</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/sheet-body-geometry-type/">使用SOLIDWORKS API获取图纸体几何类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/slice-body/">使用SOLIDWORKS API将实体切片为多个截面</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/split-body-by-faces/">使用SOLIDWORKS API拆分面的SOLIDWORKS宏</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/store-restore-body/">Store and Restore Bodies to Third-Party Storage using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/surface-curve-intersection/">SOLIDWORKS宏查找曲面和曲线之间的交点</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/surface-offset-equal/">SOLIDWORKS VBA宏复制预选面</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/">使用变换在SOLIDWORKS API中操作</a><button aria-label="打开/收起侧边栏菜单「使用变换在SOLIDWORKS API中操作」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/">装配中的组件变换</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/circular-pattern-data-rotational-transformation/">通过SOLIDWORKS API创建圆形模式的旋转变换</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/get-coordinate-system-transform/">使用SOLIDWORKS API获取坐标系的变换矩阵</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/vector-normal-to-screen-view/">创建垂直于屏幕视图的矢量</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/untrim-surface/">使用SOLIDWORKS API取消修剪面或曲面</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/adornment">adornment</a><button aria-label="打开/收起侧边栏菜单「adornment」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/import-export">import-export</a><button aria-label="打开/收起侧边栏菜单「import-export」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/options">options</a><button aria-label="打开/收起侧边栏菜单「options」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/deployment">deployment</a><button aria-label="打开/收起侧边栏菜单「deployment」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/motion-study">motion-study</a><button aria-label="打开/收起侧边栏菜单「motion-study」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/troubleshooting">troubleshooting</a><button aria-label="打开/收起侧边栏菜单「troubleshooting」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/">SOLIDWORKS API宏和插件的代码示例</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-pdm-api">solidworks-pdm-api</a><button aria-label="打开/收起侧边栏菜单「solidworks-pdm-api」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-document-manager-api">solidworks-document-manager-api</a><button aria-label="打开/收起侧边栏菜单「solidworks-document-manager-api」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/edrawings-api">edrawings-api</a><button aria-label="打开/收起侧边栏菜单「edrawings-api」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-tools">solidworks-tools</a><button aria-label="打开/收起侧边栏菜单「solidworks-tools」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/visual-basic">visual-basic</a><button aria-label="打开/收起侧边栏菜单「visual-basic」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/hosting">hosting</a><button aria-label="打开/收起侧边栏菜单「hosting」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/angular">angular</a><button aria-label="打开/收起侧边栏菜单「angular」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/hosting-1">hosting</a><button aria-label="打开/收起侧边栏菜单「hosting」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/CONTRIBUTING">CONTRIBUTING</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/LICENSE">LICENSE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack/">README</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solidworks-GPT/zh-Hans/docs/intro">教程介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/solidworks-GPT/zh-Hans/docs/tutorial-basics/create-a-page">Tutorial - Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/solidworks-GPT/zh-Hans/docs/tutorial-extras/manage-docs-versions">Tutorial - Extras</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/solidworks-GPT/zh-Hans/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/category/codestack"><span itemprop="name">CodeStack</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-api"><span itemprop="name">solidworks-api</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/category/geometry"><span itemprop="name">geometry</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/"><span itemprop="name">使用变换在SOLIDWORKS API中操作</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">装配中的组件变换</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>装配中的组件变换</h1></header><p>本示例说明了装配中组件的旋转和平移变换
image: comp-translation.png
labels: <!-- -->[acos, 角度, 组件, 示例, 方向, 点, 位置, 旋转, solidworks api, 变换, 平移, 向量]<!-- -->
redirect-from:</p><ul><li>/2018/03/component-transformation-in-assembly.html</li></ul><hr><p>SOLIDWORKS组件是另一个父装配中模型（零件或装配）的实例。组件在其空间中的位置由其变换驱动（无论组件是否受到约束或通过自由拖放操作在空间中移动）。变换由3个组件组成：平移、旋转和缩放。</p><p>要获取组件的变换，请使用<a href="https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.icomponent2~transform2.html" target="_blank" rel="noopener noreferrer">SOLIDWORKS API属性IComponent2::Transform2</a>。在这种情况下，变换表示组件原点坐标系与根装配原点坐标系之间的关系。不需要将子装配的变换乘以其子组件的变换，以获得这些组件相对于根装配的总变换。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="平移变换">平移变换<a href="#平移变换" class="hash-link" aria-label="平移变换的直接链接" title="平移变换的直接链接">​</a></h2><p>在下面的示例中，组件在空间中沿X、Y和Z坐标移动。以下示例将计算组件原点的新位置：</p><p><img loading="lazy" alt="组件平移变换" src="/solidworks-GPT/zh-Hans/assets/images/comp-translation-8a9967500f25a80145a7db4225edef5c.png" width="640" height="348" class="img_ev3q">{ width=640 }</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swMathUtils As SldWorks.MathUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swModel As SldWorks.ModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swSelMgr As SldWorks.SelectionMgr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swMathUtils = swApp.GetMathUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swModel = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swSelMgr = swModel.SelectionManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swComp = swSelMgr.GetSelectedObject6(1, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swTransform As SldWorks.MathTransform</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swTransform = swComp.Transform2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim dOrigPt(2) As Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dOrigPt(0) = 0: dOrigPt(1) = 0: dOrigPt(2) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swMathPt As SldWorks.MathPoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swMathPt = swMathUtils.CreatePoint(dOrigPt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swMathPt = swMathPt.MultiplyTransform(swTransform)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim vCompOriginPt As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vCompOriginPt = swMathPt.ArrayData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Print &quot;沿X轴: &quot; &amp; vCompOriginPt(0) * 1000 &amp; &quot;mm; &quot; &amp; &quot;沿Y轴: &quot; &amp; vCompOriginPt(1) * 1000 &amp; &quot;mm; &quot; &amp; &quot;沿Z轴: &quot; &amp; vCompOriginPt(2) * 1000 &amp; &quot;mm&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在运行此宏时，将在监视窗口输出以下行，作为对<a target="_blank" href="/solidworks-GPT/zh-Hans/assets/files/transform-translation-4857f84bab8baee550c36b8c98b73fee.SLDASM">此示例模型</a>的结果：</p><blockquote><p>沿X轴: 75mm; 沿Y轴: -50mm; 沿Z轴: -100mm</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="旋转变换">旋转变换<a href="#旋转变换" class="hash-link" aria-label="旋转变换的直接链接" title="旋转变换的直接链接">​</a></h2><p>现在让我们旋转组件并尝试找到旋转角度。该组件在所有方向上都进行了旋转。下图中的<strong>红线</strong>是装配的X轴，<strong>绿线</strong>是Y轴，<strong>蓝线</strong>是Z轴。New X、New Y和New Z是组件中相应轴的方向，尺寸表示这些轴之间的角度。</p><p><img loading="lazy" alt="组件旋转变换" src="/solidworks-GPT/zh-Hans/assets/images/comp-rotation-3c750ab3ee00ea90d922c2ea84a2f890.png" width="638" height="598" class="img_ev3q">{ width=640 }</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Const PI As Double = 3.14159265359</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swMathUtils As SldWorks.MathUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swModel As SldWorks.ModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swSelMgr As SldWorks.SelectionMgr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swMathUtils = swApp.GetMathUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swModel = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swSelMgr = swModel.SelectionManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swComp = swSelMgr.GetSelectedObject6(1, -1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swTransform As SldWorks.MathTransform</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swTransform = swComp.Transform2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Print &quot;X轴之间的角度: &quot; &amp; Round(GetAngle(1, 0, 0, swTransform) * 180 / PI, 2) &amp; &quot; deg&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Print &quot;Y轴之间的角度: &quot; &amp; Round(GetAngle(0, 1, 0, swTransform) * 180 / PI, 2) &amp; &quot; deg&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Print &quot;Z轴之间的角度: &quot; &amp; Round(GetAngle(0, 0, 1, swTransform) * 180 / PI, 2) &amp; &quot; deg&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function GetAngle(x As Double, y As Double, z As Double, transform As SldWorks.MathTransform) As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim dVect(2) As Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dVect(0) = x: dVect(1) = y: dVect(2) = z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swMathVecOrig As SldWorks.MathVector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swMathVecTrans As SldWorks.MathVector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swMathVecOrig = swMathUtils.CreateVector(dVect)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swMathVecTrans = swMathVecOrig.MultiplyTransform(transform)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;cos a= a*b/(|a|*|b|)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GetAngle = ACos(swMathVecOrig.Dot(swMathVecTrans) / (swMathVecOrig.GetLength() * swMathVecTrans.GetLength()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function ACos(val As Double) As Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If val = 1 Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ACos = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ElseIf val = -1 Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ACos = 4 * Atn(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ACos = Atn(-val / Sqr(-val * val + 1)) + 2 * Atn(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>运行上述代码将为<a target="_blank" href="/solidworks-GPT/zh-Hans/assets/files/transform-rotation-552d0f6bdd876478958056133a07a7f2.SLDASM">此示例模型</a>输出以下结果：</p><blockquote><p>X轴之间的角度: 110 deg</p></blockquote><blockquote><p>Y轴之间的角度: 66.74 deg</p></blockquote><blockquote><p>Z轴之间的角度: 75 deg</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="在配置中保留变换状态">在配置中保留变换状态<a href="#在配置中保留变换状态" class="hash-link" aria-label="在配置中保留变换状态的直接链接" title="在配置中保留变换状态的直接链接">​</a></h2><p>默认情况下，如果装配发生修改（例如添加新组件、约束更改等），则配置中浮动组件的变换状态将被另一个配置状态覆盖。这与手动行为不同，当另一个配置修改时，浮动组件的位置不会改变。</p><p>为了演示该问题，请考虑以下场景：</p><ul><li>下载<a target="_blank" href="/solidworks-GPT/zh-Hans/assets/files/preserve-transform-b05a53f6ac048c7f144a21af9462b42b.zip">示例装配</a>，其中只有一个组件</li><li>装配中有2个配置<ul><li>配置<strong>A</strong>通过约束完全定义了组件的位置</li><li>配置<strong>B</strong>中有一个浮动组件，没有任何约束，处于随机位置</li></ul></li><li>运行以下宏。宏将使组件的角与装配原点对齐在配置B中</li></ul><p><img loading="lazy" alt="组件的角与装配原点对齐" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXkAAACtCAIAAADauZjnAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAABp6SURBVHhe7Z0JkBXVucedQYjyNAlBTLTK8Cxj8qq0rBcf6MuzyucYnwsxLuCGC4LjKAq4oYAoSFAU1BBjFEVU3HcUUQO4JCrivkTcFRWjwahoXElC1Hq/6e/Msenu27fvnaZn5t7/r05R955eb5/v/Pqc8yGu9bUQQqx55BohRBHINUKIIpBrhBBFINcIIYpArhFCFIFcI4QoArlGCFEEco0QogjkGiFEEcg1QogikGuEEEUg1wghikCuEUIUgVwjhCgCuUYIUQRyjRCiCOQaIUQRyDVCiCKQa4QQRSDXCCGKQK4RQhSBXCOEKAK5RghRBHKNEKII5BohRBHINUKIIpBrhBBFINcIIYpArhFCFIFcI4QoArlGCFEEco0QogjkGiFEEcg1QogikGuEEEUg1wghikCuEUIUgVwjhCgCuUYIUQRyjRCiCOQaIUQRyDVCiCKQa4QQRSDXCCGKQK4RQhSBXCPKsGrVqi+//NJ9EaJa5BqRxrx58773vQ0aGhrWCtGnT5+WlpYZM2Y8/vjjS5cuXblypWQkyiLXiJLgEcxy7OhJN89dTJkxa87kKTOGDB25594H9eu/3WY/+g809G/rrd+tW7eIjJqamiQjEUGuEckgCKyBVkw0WQoyQkzIaIcdByCjjTf+YbqMGDQhoxUrVnAtd1VRu8g1IhmMgC8iNmlnSZTRt761DjIyBxnM0SSj2kOuEQnQ2xFBxBQFFOZoyIjBFDJijpYuI+ZoyIg5GjLSHK3zI9eIKAwomPhELNBJSlxG3Coyiq9eS0adDblGrAZzFgYRTHYinbxLlPjqdYqMtHpdMHKN+Abe//RDn3iqvZI9lSYZ5Y5cIxz0JfpYRYmn2it+9bqsjOKr15JROnKNcNB/ck881V7JmEoDpdIiyDWiFTpGhySeaq/Y6nXGvL6tXteJjOQa8TUR32kTT7VXSqXSUmRUG6k0uabe4aVKlHfRxFNNlux5fVu97ioykmvqGgKUqCWyI+Gu0mlLqVRa58/ryzX1ixJPNVk6bV5frqlfiDYlnuqwJKbSvIzwTr9+/VyI5IpcU6fMnj1biSeVSMFBvIF22nmvNTHAkWvqEZs9Ae8x5vm80/AOg21edAy8CTgG4VotrrdCizO02eo/t1ln3Z6Mblys5IdcU6cgml0GDKL033b7Lbfq17fvZj/YaJP11v82cdat29oNDY1lZRSJVJWuXmjljTb+4amTzkc3TU1NLlDyQ66pU/r06YNf9t7n0PSy/Q67psuINyEyYsKPjJj8S0ZdtNB866//HURDGTLsWFrWBUp+yDV1yrx587BGxCxVFJPR5j/ZAhn16tUbGXXv0SNdRkOGjkRGmqN1nkK7dO/ew0RjpbGxccWKFS5WckKuqVNsySYijjVRSsnITMQcDRkxekdGzNEko+IL41BagbFM2DVMpmbMmOFiJSfkmvqFro4FImoouOwyYBAyYo6GjJijISNGW+kyom8gI61e51JwOg95p533CouGQg31LlByQq6pX1paWujbkc7f2UopGcVXryWjKoolniKisSLXiNxYunQpw4dI3+5yJTGVligjpdIixSeeEguPMd/Mt1xT19AV6auR3ltjpWxe31av601G4cRTYsk98y3X1DV9+vRhbhLpnPVWwqvXGfP6XX31Op54ipfcM99yTV2TV+a7tkuWVFoXkhH3Fk88JZZ8M99yTV1TWOa7hkt49TpjXt9WrztERkwMuaV44imx9O69YY6Zb7mm3iHyOjzzXdslSyotUUZrIpXGhUolnuIl38y3XFPvtLS00AEi3UOlyJJFRvHV6ypkhMtSEk+JRa4RuVEbme/aLmVTaYkyiqTSqE9PPCUWLpRX5luuEXWR+a7tUlZGR404eet+20U8kqVs/uMt88p8yzVCme/aL1v/1/985zu9Ih7JUnLMfMs1QpnvuigoI0ueO14aGxtz+X9XyTXiayKJQIyEpkqNFSZW2TNQ4ZJX5luuEa3gGmW+a7swTa5ibZjys+1+nss0Sq4RrSjzXfNllwGDUEbEIxmLXCNyQ5nveig0cca/MRwp66zbkwhxsVItco1w8O5S5ru2C0PXSv8un5VcMt9yjXDgGmW+a7v033b7xsbGiEeylFwy33KNcMybN2+99b8diU6VGisoo6My33KNcCjzXQ9lnXV7Vp355m3kYqUq5BrxDbhGme/aLh2Y+ZZrxDc0NTUp813bpQMz33KN+IalS5d279EjEp0qNVY6KvMt14jV0JJNzZdevXp3SOZbrhGOlStXLl++fKONNtrmv7fbZ/9hkQBVqZnSf9vty/7D5oll70GtaSwXLpUj14ivP/roo9tvv3369OmTQowdO765ZeTAfYdGIlWlBgrKGHXcpIhKspSGhoaqM99yTb3z1ltvXXTRRU4wMcaOazVOJFJVunrpkMy3XFPvTJ061bRy/fXXP/3006+//voWW2zRfPjw8eNPtXo4/oSTNKuqpdK372btyXx/FeACKDNyTV2zePFis8miRYssgMBnvocddrQ3zkljxu1/YHM4XlW6btllwCBmQxGPZCnMvLxr0nERFkKuqWtmzpx55plnTp8+3QVIgGW+8YvFJYOaiRNP4+vYseN9sKp09dL6n/UPOjSikiyle/ceRIiLlUqQa+qa8847D4kwe3Lh8NVXX3755b/+9S/eXd41lGOOHc1X4IOvVOnSpT2Z75aWFuLEcHGTAbmmrrHFmmuuucaigdBBNKtWrYq4hnLiSWOpYUo1ZOjwcL1KFy1bbtWv6sx3c3MzQUKoeMw7cSyuDLmmrmFEg0H8HIqgIYb++c9/zpgxI+KaffYfNmHCRCqRTrhepeuWKjLf7N/Q0PD444///e9//8c//kGoADFjpEgH5Jq65sknn0Qf8PrrrxMo9hmGDx/e2Ng4bNgw933SpNZ/bmLgIPv8vzvson9VqwbKOuv2/Nl2P4/YJL0wFOI99Omnn3722Weff/75F198sXLlSu8dp5wS0pFr6hcGMsSK6WPmzJmECOFC0FD58ccfdw949913V6xYwXts3rx5CIg9J0yY0L9/f16JRkNDY/cePYha5v8/2GiTvn03Y3Def9vtJaPOXyrNfPfuvWFTU9N77733wQcffPjhhx999BFx8sknn5h0zDhh6USMI9fUKTZpgoULF5pu5s+fb6IhevDLwIEDUcmmm2766KOP3nvvvbfddtsVV1xhe6KbUaNGMWkngHitLV26FBnxumtpaenTp485yBOR0eY/2QIZbb/DrpJRh5eKMt+b/3hLWpPx77Jly/785z+/8847vIfef/99pPO3v/2NkQ7GsTGOuQbRyDXiG9EAQXDxxRebRBYtWkTQ8L7661//ytfvf//7hNc222xz5513XnfddX638ePHH3XUUUOHDh08ePCgQYP22GOPX/ziF7vuuuvOO+/8fwE77bTTzwM4eVkZdeu2NjJijiYZFV8yZr7tr/DRms8888ySJUteeuml11577c0333z77bcxDsMcYsYGODS3H9rINfWOc0wbBAGxgkGmTJnCn8yVeFkRQ4FVWv/iFmANBjW//e1vrXLcuHG4ZtiwYQcddNB+++2Hbvbaay+Ms/vuuyOdAQMG7LbbbqhnlwAEFHaQYSYCrs4YChlxXWTEED1dRgz7kRFzNGQU6TYqVZQsmW/7Ty5pJoa3999//8MPP/zEE088++yzL774Ig3HGGf58uWEEKObzz77zCZTcdcQaXJN3WGKMQgCAoKw4E1lHgHGL4899hg1Tz31VM+ePa3DY40zzjjDdhgzZswxxxxz5JFHHnbYYUOGDME4BxxwANLZd99999lnHyZfsPfeeyOgPffcEwf98pe/RENhE+UoI+ZoyIg5mmRURSmb+R513KTGxkaGpQxsb7nlljvuuOPuu+/GOMysGeMQJMyqeDO99957DG0YFCe6xoJNrqkvrNUNgsBEQ2QQHwQNnRmVnHnmmfx5zjnnXH755ajE9em11sIa1E+ePHnixIkMbUaPHo1xRowYMXz48COOOOLwww9HPUysOOSQQw45+OCDcdCBBx6Ihvbff39vIgZBZqJ0GWGijDJi0O5Xr5mjpctIq9fxwiNKyXzz3IgKhrQXXXQR8YBxbrvttgULFjzwwAM88+eee47JFEMbJt2lXOOiTa6pK1ybBwTvG+caJtj0WAbADIPnzp2LZVpHLwE4xXqsgUQIu7PPPpsJ169+9avTTjvt1FNPPfnkk8eOHXviiSdin+OPP/7YY4/FQSNHjjz66KOZajH8MRM1Nzcz7YrIaPDgwaVkhIkiMsJEucjI/Zg26lxG/PBSmW9LPPFqYUh77rnnXnDBBbNnz77xxhvvvPPOP/zhDwx+lyxZYq7x4xpbr4mLBuSaesE1eICJBuKuef/99998802CCaf85je/QTdbb72165QBaGXWrFm85Yg89pk+fTpRiH2mTp3KgOj000/HQRyFhiZMmHDKKadgIoTFtAsZnXDCCSkyYliEjA499FAvI4ZF6TIyE7VHRjwEfrutXqfIqIZTaaUy35Z4GjVqFA3HG4W3C/FA019//fXMpP74xz/yxJ5//nmGw3/5y18++OCDjz/++PPPP7dBTVw0INfUBa612wg8880EyruGcGEI8O677/KmIoaeffbZRx55hPeYdTmjZ8+e11xzDVN36hlR8/nKK6/kdXfZZZcRiDNnzkRDF1544e9+9zuz1a9//WsGStOmTTvrrLOIV5MRJuJt6WWEvyIyIsRNRkzQkBEKiMvI5miVyggTpcjIeWj1BSMvo1KptC4tI+4znvn2iScePs1BG9FwtOall15Ku//+979/8MEHn3rqqZdeeumtt97yEyg/qAniazXXEIRyTe3jWrsNiwMIu4bXES8lwoWhDe8odPP2228zwGGE/OKLL9L3rFPBBhtswIyd19p99913zz33LFy4kMi76667eNfdfvvtbJozZ87NN99MRPICvPbaa6+++uqMMmJYxFg9LCNep15GJ510ksnouOOOMxmNGDEiLiPmaCYjv2DkZWQmSpQRJkqUUcREpWRkq9cpMoqn0jqVjHBlOPPtE08InSEnD5xWoHVoMpqSJr733nuZQD333HORQU2p2ZPFoVxT+7gGDwgk4yAmwrrhpfTFF1+Ybj788EMmUxjnnXfe4cWFMqzPwOWXX06QMeR55plneLM9+eST9LFHH32UEdDixYsXLVrEG+/+++9nPk9E3n333QsWLEBGTMqYocydO/fWW2/NKKPzzz//vPPOi8zRkNHkyZPDMho/fryX0ejRo01GzNFMRszRbOkaBTQ3N3sZ+QUjL6PwsKisjDBRFTIqlUqDjs3rc1FmTCYan3jimfCssDmK52nzSqB1brrppvnz5z/00EO0/iuvvGIrNQSMnz2Za1y0BbgolGtqHtfgAaYYj3eN1w3hgm5sgMObioExnQTpEE/0W4YwdMtNNtkE+yxbtoxRD681uhBjn1dfffXll19mRP3CCy9goiVLlvzpT3+KyOjhhx82GT3wwAMMi1JkxASNmL7hhhuYo3kZ4TgG8JdccsnFF19Mj73gggtSZGQLRl5G48aN8zJijlZWRpFUGr+6ilRajjKKr17nKyMGWT7zzVV4FPxMfj4feFY8Q0advACYLzN65UVCm9LWxIDNnph9lxUNyDW1jGvwAPNLhLBuwBvHxjhIhzD65JNP8A7vLiCwvvvd7/KuY9hsDiLaGP4sX76csTSDIGZevOtMRm+88YaXEe9AZMR0LC6jJ554IlFGfo6WLiM6wFVXXXXFFVdUIaMJEyZ4GY0ZMyYio5EjR5qMmKOlpNKQUcqCUYqMWpeLssmI5kBGPCWeAP1/TaTSOAkjmt69N0Rz3Dx6RbvomDHjlClTbPbEw6dRmD09//zzNC6NzvjXlmm8aAgqF3ABLhAD5JqaxbV2GyaXUiRKx7xj6gHsA3Rv4pJRNEGGhiImIviAjlFWRgyLUmTEHA0ZPf300yYj4ttkxHXjMmJU7xeMKpVRqdXrUqm03PP6mCgsI0y0hmRkq9elZMTWvv++OXtyS372xE/Gy/iaR8fMl6fNTNkv03BFWp+QIE6ImXTRgFxTm7jWLo0pJo5Jx2PqAezjIRx/+tOfehOBlxFDIRsNYaL2yMjmaF5GzNGQEeN2ZMRLNSwjxvMmI7qByejBBx9MkVF49Touo4pSaWEZpaTSTEYooDPk9ZEsdxJfMFp77bXZgd24DW6Pe2aUh3AZFSJoHhejS0adPHZ2o5lsPdiLBriKi60AF4gh5JoaxLV2+wjME1UPEFU4olevXvQ9CzJwEmqjdUQU4FSUKiNC1mSEiTLKyC8YpcuIOVpERvQWk5FfvU6XUaWptPS8fjyVlmNeHxN5GWGiRBmZicJQySYamtahcbkEIxpEE14PtiQ3w0meJ8+ZNwHtQnvRjrQszU0AcKyLmwAXiKtTX67B3+5TObLvuSao7urxo1zL5w2hyUyEyzH3CfyzGmafCOYgj1NR0hytnTIKLxh5GUVWr5HRkiVLwjLihV9KRpHV6ypkVFEqLSKjSF4/PZWGKcxE6TLygyPgM5Xsw4Gch5NzRW6De+OeaWWGfvx2HggPigfIs+WB0xYZ14PD5NCjOrZbVkT2W83lR3GSOG5bKhl3i1DpUS40qoU4bmpqcl9CBOMhh9knjKknjjnI41RUQkYEerqMMFFERvEFIy8jhkUpMqour3/LLbekyKidqbR25vW9j4Aa6tmHQzgD5+RCXJ1bMtEw3OPH8hB4ODw0niRPmIdPc9BMNBxt6ho+wMVWEu3tURbf1fWN4sl+n+3/RaXO0FWeFbjwKQFdlN9Cz3HfM+M8FGACCmPqiWMO8jgVlZNR63LR6gtGXkbpC0ZeRn712mRUaSotS16/Pam0sIxSUmleRjZN8/CVeoZODKM4nLMxDeSiOJHbC49oeBomGp5qWDQ0omvXABc6SeTTo7pK/8l+n+38RemHd5XHVZZzzjmH30JXdIGWE6YhwwQUxtQTxxzkCZsI1oSMwgtG8VSayYiOmiWvbwtG7ZeRXzDyMorn9S2bBnzgK/XswM4cy6mYADIKY56IIplOIlM/ouGx8MR4gDxYHjhtQQO5NgtwYVGC9vYo3238hwi2j+GqAlxVgKtqw9W24WpD+ErbAeyr4aqyHWhYZRirTNxkVLfJE97Hf+aDffY1YWyr4WvsgxH+Gt7HYzX5suOOOw4cONB9ieFiMG9MQ4YJKIypJ46TUBulZNS6XJQqI7pcFhlFVq/DMoqk0irN6yOCjDKyBaPIyAinAOMj/pw2bRr17HDhhRdyIOeZM2cOwxlmiNwPuuS2bY2GH84D4RFVJxpoV/yFwzcxlCOV/mupeoifp1RN4lGJlZ74gUZKTXwTJFYaKZsiRC4RPjB+kkhN/BCInyFlByAQ0UQ7wTWcluh3J60QF6d5YxoyTEBhTD1xnIQCzETgVJQkI0xkMmpdLqpQRuEFo5RUWkpe3xaMyub1bcEoLCPmR4BZ+HP27NnUYyt25kBOguC4CsMZ7oR744b5CfyudooGVgu+SokHd4TESmhnPV/je5aqdJ8CEvcx4ntGPoQpdRJI2RQhfInIUelfjeCgkrvFtxrhylmzZjXnwe67704UupPmjYvlvAks5DABhTH1RHASasNMBE5F2WTUOkPLIKPI6nWijCpKpZmMGLDYTA0lAR/4umDBAvZBMRzFSbAbl+CK3IPNm7h/fg4/jV/Nc+D58NDccwxwTVWOhHDMSDyUs9QYZbtBnPDW7IdHKqu7RNUnScfvGT8kXJNywsim6o7q6rh4zxvTEJh9wph64piDPE5F5VavS8kIE5WSUTyVhhpSUmlhGQEzNQ9f2cQ+7IzCOAMn5Pxci6tzS9wkN8yv4BfxG/n5PBP3jNpwLVGO6sMuHrKJQVwqshMPT8ftV8mFIpWJ+3hKXaLqk6Tj94wfEq5JOWFkU3VH1TauN+SNacgwAYUx9cQxB3nMRJAuI0xUVkaJC0ZhGdmCkY2MwlDDJnZgZw7kDJyNk3vLcGPcITfP77Lf6x5BG+5BZ6DKsCNeS+H2CJGxPnGfRBL3zFKZfonw1lIHpp8Byu7gSTlnuCblhJFN1R1V57gekzfWLQ0TUBhTTxwnoTbCJoKyMsJEERn5YVF4ZBSGGjaxDztzFCfhhGHLcBvcGPdsv8X9vDbcQ8xGlWFXKl6rCHFfn70PJO6ZpTL9EuGtpQ5MPwOU3cGTcs5wTcoJI5uqO0qk43pV3ljXNUxAYUw9ccxBnlIywkRhGRnhwRHYZ6CereYXO4NXDHAz7i4D3N0HuAeUmWrCLj1Yq4hyq89+2sQ9s1S25xJWk34Go9J9Sl3LSDlbZFN1R4l24npe3rjOHWACCmMiiGMO8iTKKIJtsj3tKM5jV3GXb8PdWYD78ZVQTdilB2sVUe7ry+5gJO6WpZKvibtBfE/3qY3g0ORj46TvGdka37nsDkBlym6RTWFSNok1geudeeMEEGBqCGPqScRsYoQ/gzs4ZhlwVw1wP6xCqgm79GBNiXj/tVQ9RDZBlhrIUmlfs5wwy9nSKbVzdVeP1NjXxEojfgZPyibRIbgenDdOEgFOISGJuO9JWonjztiGu+8KqTjsskRqJOg9rirAVQW4qjZcbRuuNkTVlf4rH8JYZZh4ZeJu6QTnjuK2hYhXltrN42vsgxH+GtkUJmWT6IS4/r3GcDopjduvDXdblaOwy0on7KKyhgDngEJwl6wKBWsmOrBXl7q0RCMy4jzRbtzpqkXxmomO7djxq0s0IkecS1Jxu7YDhWx5OkPH5h7CuFohug6KWiFEEcg1QogikGuEEEUg1wghikCuEUIUgVwjhCgCuUYIUQRyjRCiCOQaIUQRyDVCiCKQa4QQRSDXCCGKQK4RQhSBXCOEKAK5RghRBHKNEKII5BohRBHINUKIIpBrhBBFINcIIYpArhFCFIFcI4QoArlGCFEEco0QogjkGiFEEcg1QogikGuEEEUg1wghikCuEUIUgVwjhCgCuUYIUQRyjRCiCOQaIUQRyDVCiDXP11//PxgZdpwCWrQ5AAAAAElFTkSuQmCC" width="377" height="173" class="img_ev3q"></p><ul><li>宏将在几个点停止。阅读指示状态的注释</li><li>在最后一步中，浮动组件的变换被配置A中的变换覆盖，由约束驱动。</li></ul><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#If VBA7 Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Private Declare PtrSafe Function SendMessage Lib &quot;User32&quot; Alias &quot;SendMessageA&quot; (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Private Declare Function SendMessage Lib &quot;User32&quot; Alias &quot;SendMessageA&quot; (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swModel As SldWorks.ModelDoc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swModel = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swModel.ShowConfiguration2 &quot;B&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swRootComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swRootComp = swModel.ConfigurationManager.ActiveConfiguration.GetRootComponent3(False)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swComp = swRootComp.GetChildren()(0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swTransform As SldWorks.MathTransform</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim dMatrix(15) As Double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dMatrix(0) = 1: dMatrix(1) = 0: dMatrix(2) = 0: dMatrix(3) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dMatrix(4) = 1: dMatrix(5) = 0: dMatrix(6) = 0: dMatrix(7) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dMatrix(8) = 1: dMatrix(9) = -0.03: dMatrix(10) = -0.05: dMatrix(11) = -0.01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dMatrix(12) = 1: dMatrix(13) = 0: dMatrix(14) = 0: dMatrix(15) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swMathUtils As SldWorks.MathUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swMathUtils = swApp.GetMathUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swTransform = swMathUtils.CreateTransform(dMatrix)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swComp.Transform = swTransform</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swModel.EditRebuild3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Stop &#x27;组件已对齐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;FixComponentInThisConfiguration swComp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swModel.ShowConfiguration2 &quot;A&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swAssy As SldWorks.AssemblyDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swAssy = swModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swAssy.AddComponent5 swComp.GetPathName(), 0, 0, False, &quot;&quot;, 0.2, 0.2, 0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swModel.EditRebuild3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Stop &#x27;在配置A中添加了新组件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swModel.ShowConfiguration2 &quot;B&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Stop &#x27;配置B中的组件丢失了其位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub FixComponentInThisConfiguration(comp As SldWorks.Component2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If False &lt;&gt; comp.Select4(False, Nothing, False) Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Const WM_COMMAND As Long = &amp;H111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Const CMD_FixCompInThisConf As Long = 51605</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SendMessage swApp.Frame().GetHWnd(), WM_COMMAND, CMD_FixCompInThisConf, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Err.Raise vbError, &quot;&quot;, &quot;无法选择组件&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>为了保留变换，需要在配置B中<a href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/assembly/components/fix-float/">固定</a>组件。</p><ul><li>取消以下行的注释</li><li>关闭装配时不保存并重新打开</li></ul><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;FixComponentInThisConfiguration swComp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>改为</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FixComponentInThisConfiguration swComp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>再次运行宏。现在变换已保留</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/geometry/transformation/assembly-component-transformation/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">使用变换在SOLIDWORKS API中操作</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/geometry/transformation/circular-pattern-data-rotational-transformation/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">通过SOLIDWORKS API创建圆形模式的旋转变换</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#平移变换" class="table-of-contents__link toc-highlight">平移变换</a></li><li><a href="#旋转变换" class="table-of-contents__link toc-highlight">旋转变换</a></li><li><a href="#在配置中保留变换状态" class="table-of-contents__link toc-highlight">在配置中保留变换状态</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/solidworks-GPT/zh-Hans/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/solidworks-GPT/zh-Hans/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/jiaqiwang969/solidowrks-GPT" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/solidworks-GPT/zh-Hans/assets/js/runtime~main.45a3328d.js"></script>
<script src="/solidworks-GPT/zh-Hans/assets/js/main.3d1c5466.js"></script>
</body>
</html>