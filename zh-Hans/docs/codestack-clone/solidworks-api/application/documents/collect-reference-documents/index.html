<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-codestack-clone/solidworks-api/application/documents/collect-reference-documents/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Macro to collect all reference documents of assembly into a folder | solidworks-GPT</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Macro to collect all reference documents of assembly into a folder | solidworks-GPT"><meta data-rh="true" name="description" content="VBA macro to collect all reference output files (e.g. DXF, PDF) from all folders into a single folder"><meta data-rh="true" property="og:description" content="VBA macro to collect all reference output files (e.g. DXF, PDF) from all folders into a single folder"><meta data-rh="true" property="og:image" content="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/collect-reference-documents.svg"><meta data-rh="true" name="twitter:image" content="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/collect-reference-documents.svg"><link data-rh="true" rel="icon" href="/solidworks-GPT/zh-Hans/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/" hreflang="en"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://jiaqiwang969.github.io/solidworks-GPT/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/solidworks-GPT/zh-Hans/blog/rss.xml" title="solidworks-GPT RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/solidworks-GPT/zh-Hans/blog/atom.xml" title="solidworks-GPT Atom Feed"><link rel="stylesheet" href="/solidworks-GPT/zh-Hans/assets/css/styles.ec1106c8.css">
<link rel="preload" href="/solidworks-GPT/zh-Hans/assets/js/runtime~main.e0ccc1ce.js" as="script">
<link rel="preload" href="/solidworks-GPT/zh-Hans/assets/js/main.3e106a9d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solidworks-GPT/zh-Hans/"><div class="navbar__logo"><img src="/solidworks-GPT/zh-Hans/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/solidworks-GPT/zh-Hans/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">My Site</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/solidworks-GPT/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/solidworks-GPT/zh-Hans/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/solidworks-GPT/zh-Hans/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jiaqiwang969/solidworks-GPT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solidworks-GPT/zh-Hans/docs/category/codestack">CodeStack</a><button aria-label="打开/收起侧边栏菜单「CodeStack」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-api">solidworks-api</a><button aria-label="打开/收起侧边栏菜单「solidworks-api」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/">SOLIDWORKS API Code Exampels for Macros and Add-ins</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/getting-started">getting-started</a><button aria-label="打开/收起侧边栏菜单「getting-started」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/document">document</a><button aria-label="打开/收起侧边栏菜单「document」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/application">application</a><button aria-label="打开/收起侧边栏菜单「application」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/">Automating SOLIDWORKS Application frame, menus and toolbars using API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/add-ins/">Developing C++, C#, VB.NET add-ins for SOLIDWORKS using API</a><button aria-label="打开/收起侧边栏菜单「Developing C++, C#, VB.NET add-ins for SOLIDWORKS using API」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/convert-to-fraction-inches/">Convert meters to fraction inches using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/">Managing SOLIDWORKS documents via API</a><button aria-label="打开/收起侧边栏菜单「Managing SOLIDWORKS documents via API」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/active-document-type/">Determine the type Of active document using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/bring-document-foreground/">Bring document foreground (activate document) using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/">Macro to collect all reference documents of assembly into a folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/handle-document-load/">Run VBA macro automatically on document load using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/handle-document-save/">Run VBA macro automatically on document save using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/handle-new-document/">Run macro on new document creation using SOLIDWORKS API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/save-all-silently/">Macro to save all opened documents silently using SOLIDWORKS API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/frame/">Application frame customization using SOLIDWORKS API</a><button aria-label="打开/收起侧边栏菜单「Application frame customization using SOLIDWORKS API」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/data-storage">data-storage</a><button aria-label="打开/收起侧边栏菜单「data-storage」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/geometry">geometry</a><button aria-label="打开/收起侧边栏菜单「geometry」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/adornment">adornment</a><button aria-label="打开/收起侧边栏菜单「adornment」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/import-export">import-export</a><button aria-label="打开/收起侧边栏菜单「import-export」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/options">options</a><button aria-label="打开/收起侧边栏菜单「options」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/deployment">deployment</a><button aria-label="打开/收起侧边栏菜单「deployment」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/motion-study">motion-study</a><button aria-label="打开/收起侧边栏菜单「motion-study」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/troubleshooting">troubleshooting</a><button aria-label="打开/收起侧边栏菜单「troubleshooting」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-pdm-api">solidworks-pdm-api</a><button aria-label="打开/收起侧边栏菜单「solidworks-pdm-api」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-document-manager-api">solidworks-document-manager-api</a><button aria-label="打开/收起侧边栏菜单「solidworks-document-manager-api」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/edrawings-api">edrawings-api</a><button aria-label="打开/收起侧边栏菜单「edrawings-api」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-tools">solidworks-tools</a><button aria-label="打开/收起侧边栏菜单「solidworks-tools」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/visual-basic">visual-basic</a><button aria-label="打开/收起侧边栏菜单「visual-basic」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/hosting">hosting</a><button aria-label="打开/收起侧边栏菜单「hosting」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/angular">angular</a><button aria-label="打开/收起侧边栏菜单「angular」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/category/hosting-1">hosting</a><button aria-label="打开/收起侧边栏菜单「hosting」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/CONTRIBUTING">CONTRIBUTING</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/LICENSE">LICENSE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/">README</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solidworks-GPT/zh-Hans/docs/intro">教程介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/solidworks-GPT/zh-Hans/docs/tutorial-basics/create-a-page">Tutorial - Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/solidworks-GPT/zh-Hans/docs/tutorial-extras/manage-docs-versions">Tutorial - Extras</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/solidworks-GPT/zh-Hans/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/category/codestack"><span itemprop="name">CodeStack</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/category/solidworks-api"><span itemprop="name">solidworks-api</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/category/application"><span itemprop="name">application</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/"><span itemprop="name">Managing SOLIDWORKS documents via API</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Macro to collect all reference documents of assembly into a folder</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Macro to collect all reference documents of assembly into a folder</h1></header><p>This VBA macro allows to collect all output files such as DXF, DWG, PDF etc. from all referenced parts and sub-assembly documents on all levels and copy to a specified folder.</p><p>Referenced parts and sub-assemblies can be located in any directory. It is not required those to be in the same folder or drive of a main assembly.</p><p>For example the main assembly <strong>TopAssm1.sldasm</strong> is saved in <strong>C:\Assms</strong> folder and it refers 2 part files located in <strong>D:\Parts\A\Part1.sldprt</strong> and <strong>D:\Parts\B\Part2.sldprt</strong>. DXF and PDF files were created for Part1 and Part2 and saved in the same folder, i.e. <strong>D:\Parts\A\Part1.dxf</strong>, <strong>D:\Parts\A\Part1.pdf</strong>, <strong>D:\Parts\B\Part2.dxf</strong>, <strong>D:\Parts\B\Part2.pdf</strong>. As the result of running this macro all those 4 files will be copied to the specified output folder.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="notes">Notes<a href="#notes" class="hash-link" aria-label="Notes的直接链接" title="Notes的直接链接">​</a></h2><ul><li>Reference documents must have the same name as the file they derived from, i.e. <strong>Part1.pdf</strong> is derived from <strong>Part1.sldprt</strong></li><li>Reference documents of the main assembly will also be included</li><li>Macro will open the folder browse dialog to select the output folder</li><li>All file paths which are copied are output to the <em>Immediate</em> window of VBA editor</li><li>Suppressed components will not be included into the collection</li><li>Assembly opened in Large Design Review mode is not supported</li></ul><p><img loading="lazy" alt="Output log" src="data:image/png;base64,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" width="550" height="193" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Configuration的直接链接" title="Configuration的直接链接">​</a></h2><p>Macro can be configured by changing the constants at the beginning of the macro</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Const SEARCH_SUB_FOLDERS As Boolean = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Const EXTENSIONS As String = &quot;dxf,pdf&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Const ALLOW_OVERWRITE As Boolean = False</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>SEARCH_SUB_FOLDERS</strong> indicates if macro should recursively search referenced documents. If this option is set to <strong>False</strong> only files next to the source files will be collected (e.g. Part1.dxf must be in the same folder as Part1.sldprt). In some cases output files can be placed into sub-folders (e.g. DXFs\Part1.dxf of Part1.sldprt) to collect such files set the <strong>SEARCH_SUB_FOLDERS</strong> to <strong>True</strong>. Note, if any child folder contains another file with the same name it will also be collected (e.g. A\B\C\Part1.pdf).</p><p><strong>EXTENSIONS</strong> is a comma-separated list of file extension to collect.</p><p><strong>ALLOW_OVERWRITE</strong> option indicates if the files in the destination directory need to be overwritten if exist. It is recommended to set this option to <strong>False</strong> and manually clean the target directory. This would reduce the risk of overwriting the files and catching the potential errors.</p><div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Const SEARCH_SUB_FOLDERS As Boolean = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Const EXTENSIONS As String = &quot;dxf,pdf&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Const ALLOW_OVERWRITE As Boolean = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dim swApp As SldWorks.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swApp = Application.SldWorks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try_:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    On Error GoTo catch_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim swAssy As SldWorks.AssemblyDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set swAssy = swApp.ActiveDoc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If False &lt;&gt; swAssy.IsOpenedViewOnly() Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Err.Raise vbError, &quot;&quot;, &quot;Assembly opened in Large Design Review mode is not supported&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim exts As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exts = Split(EXTENSIONS, &quot;,&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For i = 0 To UBound(exts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exts(i) = Trim(CStr(exts(i)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim destDir As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    destDir = BrowseForFolder(&quot;Select folder to copy documents to&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If destDir = &quot;&quot; Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exit Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim vRefDocs As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vRefDocs = CollectRefDocuments(swAssy, exts, SEARCH_SUB_FOLDERS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If Not IsEmpty(vRefDocs) Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CopyRefDocs vRefDocs, destDir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Err.Raise vbError, &quot;&quot;, &quot;There are no referenced documents&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GoTo finally_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">catch_:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swApp.SendMsgToUser2 Err.Description, swMessageBoxIcon_e.swMbStop, swMessageBoxBtn_e.swMbOk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">finally_:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub CopyRefDocs(refDocs As Variant, destFolder As String)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim fso As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If Right(destFolder, 1) &lt;&gt; &quot;\&quot; Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        destFolder = destFolder &amp; &quot;\&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For i = 0 To UBound(refDocs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim srcFilePath As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        srcFilePath = CStr(refDocs(i))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Debug.Print &quot;Copying &quot; &amp; srcFilePath &amp; &quot; to &quot; &amp; destFolder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fso.CopyFile srcFilePath, destFolder, ALLOW_OVERWRITE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function CollectRefDocuments(assy As SldWorks.AssemblyDoc, exts As Variant, includeSubFolder As Boolean) As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim isInit As Boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isInit = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim vComps As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vComps = assy.GetComponents(False)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim refDocsPath() As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For i = -1 To UBound(vComps)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim swComp As SldWorks.Component2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        If i = -1 Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Set swComp = assy.ConfigurationManager.ActiveConfiguration.GetRootComponent()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Set swComp = vComps(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        If False = swComp.IsSuppressed() Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Dim path As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            path = swComp.GetPathName()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Dim dir As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dir = Left(path, InStrRev(path, &quot;\&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Dim vRefFiles As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            vRefFiles = GetFiles(dir, includeSubFolder, exts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Dim j As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Dim srcFileName As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            srcFileName = GetFileNameWithoutExtension(path)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            For j = 0 To UBound(vRefFiles)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Dim refFilePath As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                refFilePath = CStr(vRefFiles(j))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Dim refFileName As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                refFileName = GetFileNameWithoutExtension(refFilePath)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                If LCase(srcFileName) = LCase(refFileName) Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Dim add As Boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    add = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    If Not isInit Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        isInit = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ReDim refDocsPath(0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        add = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        If Not Contains(refDocsPath, refFilePath) Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            ReDim Preserve refDocsPath(UBound(refDocsPath) + 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            add = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    If add Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        refDocsPath(UBound(refDocsPath)) = refFilePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If isInit Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CollectRefDocuments = refDocsPath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CollectRefDocuments = Empty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function GetFileNameWithoutExtension(filePath As String) As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GetFileNameWithoutExtension = Mid(filePath, InStrRev(filePath, &quot;\&quot;) + 1, InStrRev(filePath, &quot;.&quot;) - InStrRev(filePath, &quot;\&quot;) - 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function GetFiles(path As String, includeSubFolders As Boolean, exts As Variant) As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim paths() As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim isInit As Boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isInit = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim fso As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim folder As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set folder = fso.GetFolder(path)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CollectFilesFromFolder folder, includeSubFolders, exts, paths, isInit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If isInit Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GetFiles = paths</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GetFiles = Empty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub CollectFilesFromFolder(folder As Object, includeSubFolders As Boolean, exts As Variant, ByRef paths() As String, ByRef isInit As Boolean)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For Each file In folder.files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim fileExt As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fileExt = Right(file.path, Len(file.path) - InStrRev(file.path, &quot;.&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        If Contains(exts, fileExt) Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            If Not isInit Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ReDim paths(0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                isInit = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ReDim Preserve paths(UBound(paths) + 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            paths(UBound(paths)) = file.path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If includeSubFolders Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Dim subFolder As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        For Each subFolder In folder.SubFolders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CollectFilesFromFolder subFolder, includeSubFolders, exts, paths, isInit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function BrowseForFolder(Optional title As String = &quot;Select Folder&quot;) As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim shellApp As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set shellApp = CreateObject(&quot;Shell.Application&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim folder As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set folder = shellApp.BrowseForFolder(0, title, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If Not folder Is Nothing Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BrowseForFolder = folder.Self.path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function Contains(arr As Variant, item As String) As Boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim i As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For i = 0 To UBound(arr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        If LCase(arr(i)) = LCase(item) Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Contains = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Exit Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Contains = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack-clone/solidworks-api/application/documents/collect-reference-documents/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/bring-document-foreground/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Bring document foreground (activate document) using SOLIDWORKS API</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/application/documents/handle-document-load/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Run VBA macro automatically on document load using SOLIDWORKS API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#notes" class="table-of-contents__link toc-highlight">Notes</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/solidworks-GPT/zh-Hans/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/solidworks-GPT/zh-Hans/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/jiaqiwang969/solidowrks-GPT" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/solidworks-GPT/zh-Hans/assets/js/runtime~main.e0ccc1ce.js"></script>
<script src="/solidworks-GPT/zh-Hans/assets/js/main.3e106a9d.js"></script>
</body>
</html>