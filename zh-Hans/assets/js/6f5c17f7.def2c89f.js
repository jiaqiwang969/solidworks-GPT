"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[11474],{3905:(e,o,r)=>{r.d(o,{Zo:()=>d,kt:()=>m});var t=r(67294);function n(e,o,r){return o in e?Object.defineProperty(e,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[o]=r,e}function s(e,o){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),r.push.apply(r,t)}return r}function a(e){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?s(Object(r),!0).forEach((function(o){n(e,o,r[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}))}return e}function i(e,o){if(null==e)return{};var r,t,n=function(e,o){if(null==e)return{};var r,t,n={},s=Object.keys(e);for(t=0;t<s.length;t++)r=s[t],o.indexOf(r)>=0||(n[r]=e[r]);return n}(e,o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)r=s[t],o.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=t.createContext({}),l=function(e){var o=t.useContext(c),r=o;return e&&(r="function"==typeof e?e(o):a(a({},o),e)),r},d=function(e){var o=l(e.components);return t.createElement(c.Provider,{value:o},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var o=e.children;return t.createElement(t.Fragment,{},o)}},f=t.forwardRef((function(e,o){var r=e.components,n=e.mdxType,s=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=l(r),f=n,m=u["".concat(c,".").concat(f)]||u[f]||p[f]||s;return r?t.createElement(m,a(a({ref:o},d),{},{components:r})):t.createElement(m,a({ref:o},d))}));function m(e,o){var r=arguments,n=o&&o.mdxType;if("string"==typeof e||n){var s=r.length,a=new Array(s);a[0]=f;var i={};for(var c in o)hasOwnProperty.call(o,c)&&(i[c]=o[c]);i.originalType=e,i[u]="string"==typeof e?e:n,a[1]=i;for(var l=2;l<s;l++)a[l]=r[l];return t.createElement.apply(null,a)}return t.createElement.apply(null,r)}f.displayName="MDXCreateElement"},749:(e,o,r)=>{r.r(o),r.d(o,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var t=r(87462),n=(r(67294),r(3905));const s={title:"Creating a Temporary Sheet Body from a Toroidal Surface Using the SOLIDWORKS API",image:"toroidal-surface.png",labels:["Topology","Geometry","Body","Model","Cylinder"]},a=void 0,i={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-toroidal-surface/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-toroidal-surface/index",title:"Creating a Temporary Sheet Body from a Toroidal Surface Using the SOLIDWORKS API",description:"Toroidal Surface",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-toroidal-surface/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-toroidal-surface",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-toroidal-surface/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-toroidal-surface/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-toroidal-surface/index.md",tags:[],version:"current",frontMatter:{title:"Creating a Temporary Sheet Body from a Toroidal Surface Using the SOLIDWORKS API",image:"toroidal-surface.png",labels:["Topology","Geometry","Body","Model","Cylinder"]},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS\u6a21\u578bAPI\u521b\u5efa\u4e34\u65f6\u7403\u9762\u7247\u4f53",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-spherical-surface/"},next:{title:"Create And Run VSTA Macro (C# and VB.NET) in SOLIDWORKS",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/create-vsta/"}},c={},l=[],d={toc:l},u="wrapper";function p(e){let{components:o,...s}=e;return(0,n.kt)(u,(0,t.Z)({},d,s,{components:o,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Toroidal Surface",src:r(79056).Z,width:"260",height:"282"})),(0,n.kt)("p",null,"This example demonstrates how to create a sheet body from a toroidal surface using the SOLIDWORKS API."),(0,n.kt)("p",null,"The geometry is created using the ",(0,n.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2018/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imodeler~createtoroidalsurface.html"},"IModeler::CreateToroidalSurface")," method of the SOLIDWORKS API."),(0,n.kt)("p",null,"After running the macro, a temporary sheet body will be displayed. You can rotate and select the body, but it will not appear in the FeatureManager design tree. Continue running the macro to destroy the body."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Dim swApp As SldWorks.SldWorks\nDim swModel As SldWorks.ModelDoc2\nDim swModeler As SldWorks.Modeler\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n    \n        Set swModeler = swApp.GetModeler\n    \n        Dim dCenter(2) As Double\n        Dim dAxis(2) As Double\n        Dim dRef(2) As Double\n        \n        Const MAJOR_RADIUS As Double = 0.1\n        Const MINOR_RADIUS As Double = 0.05\n        \n        dCenter(0) = 0: dCenter(1) = 0: dCenter(2) = 0\n        dAxis(0) = 0: dAxis(1) = 0: dAxis(2) = 1\n        dRef(0) = 1: dRef(1) = 0: dRef(2) = 0\n        \n        Dim swSurf As SldWorks.Surface\n        Set swSurf = swModeler.CreateToroidalSurface(dCenter, dAxis, dRef, MAJOR_RADIUS, MINOR_RADIUS)\n        \n        Dim swBody As SldWorks.Body2\n        Dim swCurve(0) As SldWorks.Curve\n        Set swBody = swSurf.CreateTrimmedSheet(swCurve)\n        \n        swBody.Display3 swModel, RGB(255, 255, 0), swTempBodySelectOptions_e.swTempBodySelectable\n    \n        Stop \'Continue to hide the body\n        \n        Set swBody = Nothing\n        \n    Else\n        MsgBox "Please open a part document"\n    End If\n    \nEnd Sub\n')))}p.isMDXComponent=!0},79056:(e,o,r)=>{r.d(o,{Z:()=>t});const t=r.p+"assets/images/toroidal-surface-c6a88ca5af61da126e6605690970e978.png"}}]);