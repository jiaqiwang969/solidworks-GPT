"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[99657],{3905:(e,t,o)=>{o.d(t,{Zo:()=>d,kt:()=>h});var r=o(67294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function s(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?s(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)o=s[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var c=r.createContext({}),l=function(e){var t=r.useContext(c),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},d=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,s=e.originalType,c=e.parentName,d=a(e,["components","mdxType","originalType","parentName"]),u=l(o),m=n,h=u["".concat(c,".").concat(m)]||u[m]||p[m]||s;return o?r.createElement(h,i(i({ref:t},d),{},{components:o})):r.createElement(h,i({ref:t},d))}));function h(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=o.length,i=new Array(s);i[0]=m;var a={};for(var c in t)hasOwnProperty.call(t,c)&&(a[c]=t[c]);a.originalType=e,a[u]="string"==typeof e?e:n,i[1]=a;for(var l=2;l<s;l++)i[l]=o[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,o)}m.displayName="MDXCreateElement"},12265:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var r=o(87462),n=(o(67294),o(3905));const s={layout:"sw-macro-fix",title:"Fix errors when creating sketch segments using SOLIDWORKS API",caption:"Failed to Create Sketch Segments",description:"Fixing the inconsistency of sketch segments (line, arcs, etc) or sketch points creation in the macro",labels:["macro","troubleshooting"],"redirect-from":["/2018/04/macro-troubleshooting-failed-create-sketch-segments.html"]},i=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error/index",title:"Fix errors when creating sketch segments using SOLIDWORKS API",description:"Fixing the inconsistency of sketch segments (line, arcs, etc) or sketch points creation in the macro",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error/index.md",tags:[],version:"current",frontMatter:{layout:"sw-macro-fix",title:"Fix errors when creating sketch segments using SOLIDWORKS API",caption:"Failed to Create Sketch Segments",description:"Fixing the inconsistency of sketch segments (line, arcs, etc) or sketch points creation in the macro",labels:["macro","troubleshooting"],"redirect-from":["/2018/04/macro-troubleshooting-failed-create-sketch-segments.html"]},sidebar:"tutorialSidebar",previous:{title:"Fix issues with failed to connect to database or Excel in SOLIDWORKS macro",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error/"},next:{title:"Fix SOLIDWORKS macro which is using future version APIs",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/future-version-apis/"}},c={},l=[{value:"Symptoms",id:"symptoms",level:2},{value:"Cause",id:"cause",level:2},{value:"Resolution",id:"resolution",level:2}],d={toc:l},u="wrapper";function p(e){let{components:t,...o}=e;return(0,n.kt)(u,(0,r.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"symptoms"},"Symptoms"),(0,n.kt)("p",null,"SOLIDWORKS macro creates sketch segments (line, arcs, etc) or sketch points using SOLIDWORKS API. And in some cases the elements are not created while it works correct in other cases."),(0,n.kt)("h2",{id:"cause"},"Cause"),(0,n.kt)("p",null,"By default all entities inserted using the ",(0,n.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2016/English/api/sldworksapi/SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.ISketchManager.html"},"ISketchManager")," interface are created via user interface. That means that the entity cannot be created if the target area (i.e. boundaries of the segments) is not visible in the user interface (e.g. the view is moved or scaled).  "),(0,n.kt)("h2",{id:"resolution"},"Resolution"),(0,n.kt)("p",null,"Set ",(0,n.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2016/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isketchmanager~addtodb.html"},"ISketchManager::AddToDB")," property to ",(0,n.kt)("em",{parentName:"p"},"True")," before the entities creation and restore the original value once the job is finished.\nSetting this option to true will bypass the creation of entities via User Interface rather add the data directly to the model storage. This may also improve performance while creating the entities."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},"Dim swApp As SldWorks.SldWorks\nDim swModel As SldWorks.ModelDoc2\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Set swModel = swApp.ActiveDoc\n    \n    Dim addToDbOrig As Boolean\n    \n    addToDbOrig = swModel.SketchManager.AddToDB 'get the original value\n    swModel.SketchManager.AddToDB = True\n    \n    swModel.SketchManager.CreateLine 0, 0, 0, 0.01, 0.02, 0\n\n    swModel.SketchManager.AddToDB = addToDbOrig 'restore the original value\n    \nEnd Sub\n")))}p.isMDXComponent=!0}}]);