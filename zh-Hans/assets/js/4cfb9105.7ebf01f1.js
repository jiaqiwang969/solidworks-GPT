"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[5138],{3905:(t,e,n)=>{n.d(e,{Zo:()=>c,kt:()=>m});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},i=Object.keys(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var l=a.createContext({}),d=function(t){var e=a.useContext(l),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},c=function(t){var e=d(t.components);return a.createElement(l.Provider,{value:e},t.children)},p="mdxType",u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},g=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,i=t.originalType,l=t.parentName,c=s(t,["components","mdxType","originalType","parentName"]),p=d(n),g=r,m=p["".concat(l,".").concat(g)]||p[g]||u[g]||i;return n?a.createElement(m,o(o({ref:e},c),{},{components:n})):a.createElement(m,o({ref:e},c))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=n.length,o=new Array(i);o[0]=g;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s[p]="string"==typeof t?t:r,o[1]=s;for(var d=2;d<i;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},19913:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var a=n(87462),r=(n(67294),n(3905));const i={title:"How to Create Stand-Alone (exe) Applications with SOLIDWORKS API",image:"reg-edit-clsid_prog_id.png",labels:["article","clsid","instance","out-of-process","progid","rot","sdk","solidworks api","stand-alone"],"redirect-from":["/2018/03/connect-to-solidworks-from-stand-alone.html"],sidebar_position:4},o=void 0,s={unversionedId:"codestack/solidworks-api/getting-started/stand-alone/index",id:"codestack/solidworks-api/getting-started/stand-alone/index",title:"How to Create Stand-Alone (exe) Applications with SOLIDWORKS API",description:"In this article, I will discuss two common methods to connect to a SOLIDWORKS instance using COM-compatible programming languages such as C#, VB.NET, C++, and Visual Basic 6, to leverage the SOLIDWORKS API.",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/getting-started/stand-alone/index.md",sourceDirName:"codestack/solidworks-api/getting-started/stand-alone",slug:"/codestack/solidworks-api/getting-started/stand-alone/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/getting-started/stand-alone/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/getting-started/stand-alone/index.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"How to Create Stand-Alone (exe) Applications with SOLIDWORKS API",image:"reg-edit-clsid_prog_id.png",labels:["article","clsid","instance","out-of-process","progid","rot","sdk","solidworks api","stand-alone"],"redirect-from":["/2018/03/connect-to-solidworks-from-stand-alone.html"],sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528API\u521b\u5efaSOLIDWORKS\u7684VB.NET\u63d2\u4ef6",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/getting-started/add-ins/vbnet/"},next:{title:"\u521b\u5efaC++\u72ec\u7acb\u5e94\u7528\u7a0b\u5e8f\uff08exe\uff09\u7528\u4e8eSOLIDWORKS",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/getting-started/stand-alone/connect-cpp/"}},l={},d=[{value:"Method A - Activator and ProgId",id:"method-a---activator-and-progid",level:2},{value:"Connect by creating an instance identified by <strong>Prog</strong>ram <strong>Id</strong>entified (progid) or globally unique COM <strong>Cl</strong>a<strong>s</strong>s <strong>Id</strong>entifier (CLSID)",id:"connect-by-creating-an-instance-identified-by-program-identified-progid-or-globally-unique-com-class-identifier-clsid",level:3},{value:"Method B - Running Object Table (ROT)",id:"method-b---running-object-table-rot",level:2},{value:"Connect by querying COM instances from the <strong>R</strong>unning <strong>O</strong>bject <strong>T</strong>able (ROT)",id:"connect-by-querying-com-instances-from-the-running-object-table-rot",level:3}],c={toc:d},p="wrapper";function u(t){let{components:e,...i}=t;return(0,r.kt)(p,(0,a.Z)({},c,i,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"In this article, I will discuss two common methods to connect to a SOLIDWORKS instance using COM-compatible programming languages such as C#, VB.NET, C++, and Visual Basic 6, to leverage the SOLIDWORKS API."),(0,r.kt)("p",null,"Here are optional detailed explanations about these methods.\nPlease follow the links below to see articles demonstrating how to create sample projects and connect to a SOLIDWORKS instance:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/codestack/solidworks-api/getting-started/stand-alone/connect-csharp"},"Using C#")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/codestack/solidworks-api/getting-started/stand-alone/connect-vbnet"},"Using VB.NET")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/codestack/solidworks-api/getting-started/stand-alone/connect-cpp"},"Using C++"))),(0,r.kt)("h2",{id:"method-a---activator-and-progid"},"Method A - Activator and ProgId"),(0,r.kt)("h3",{id:"connect-by-creating-an-instance-identified-by-program-identified-progid-or-globally-unique-com-class-identifier-clsid"},"Connect by creating an instance identified by ",(0,r.kt)("strong",{parentName:"h3"},"Prog"),"ram ",(0,r.kt)("strong",{parentName:"h3"},"Id"),"entified (progid) or globally unique COM ",(0,r.kt)("strong",{parentName:"h3"},"Cl"),"a",(0,r.kt)("strong",{parentName:"h3"},"s"),"s ",(0,r.kt)("strong",{parentName:"h3"},"Id"),"entifier (CLSID)"),(0,r.kt)("p",null,"SOLIDWORKS has two types of program identifiers: version-independent and version-specific."),(0,r.kt)("p",null,"Program identifiers are registered in the Windows registry:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Class identifiers in Windows registry",src:n(35778).Z,width:"640",height:"247"}),"{ width=640 }"),(0,r.kt)("p",null,"In the example above, the program identifier for ",(0,r.kt)("strong",{parentName:"p"},"SldWorks.Application.23")," corresponds to the COM class identifier ",(0,r.kt)("strong",{parentName:"p"},"{D66FBAAE-4150-402F-8581-75D1652D696A}"),"."),(0,r.kt)("p",null,"More information about this object, such as the type library class identifier and the COM server location (i.e., the path to ",(0,r.kt)("strong",{parentName:"p"},"sldworks.exe"),"), can be found in the registry branch associated with the class identifier, i.e., ",(0,r.kt)("strong",{parentName:"p"},"HKEY_CLASSES_ROOT\\CLSID","{","D66FBAAE-4150-402F-8581-75D1652D696A}"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Prog Ids in Windows registry",src:n(96814).Z,width:"640",height:"247"}),"{ width=640 }"),(0,r.kt)("p",null,"The version-independent program identifier is the same for all versions of SOLIDWORKS and is equal to ",(0,r.kt)("strong",{parentName:"p"},'"SldWorks.Application"'),"."),(0,r.kt)("p",null,"If using a version-specific program identifier, the revision number needs to be specified after the program identifier, i.e., ",(0,r.kt)("strong",{parentName:"p"},'"SldWorks.Application.RevisionNumber"'),".\nRefer to the table below for a list of SOLIDWORKS versions and their revision numbers:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Version"),(0,r.kt)("th",{parentName:"tr",align:null},"Revision Number"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2005"),(0,r.kt)("td",{parentName:"tr",align:null},"13")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2006"),(0,r.kt)("td",{parentName:"tr",align:null},"14")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2007"),(0,r.kt)("td",{parentName:"tr",align:null},"15")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2008"),(0,r.kt)("td",{parentName:"tr",align:null},"16")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2009"),(0,r.kt)("td",{parentName:"tr",align:null},"17")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2010"),(0,r.kt)("td",{parentName:"tr",align:null},"18")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2011"),(0,r.kt)("td",{parentName:"tr",align:null},"19")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2012"),(0,r.kt)("td",{parentName:"tr",align:null},"20")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2013"),(0,r.kt)("td",{parentName:"tr",align:null},"21")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2014"),(0,r.kt)("td",{parentName:"tr",align:null},"22")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2015"),(0,r.kt)("td",{parentName:"tr",align:null},"23")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2016"),(0,r.kt)("td",{parentName:"tr",align:null},"24")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2017"),(0,r.kt)("td",{parentName:"tr",align:null},"25")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2018"),(0,r.kt)("td",{parentName:"tr",align:null},"26")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2019"),(0,r.kt)("td",{parentName:"tr",align:null},"27")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2020"),(0,r.kt)("td",{parentName:"tr",align:null},"28")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2021"),(0,r.kt)("td",{parentName:"tr",align:null},"29")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SOLIDWORKS 2022"),(0,r.kt)("td",{parentName:"tr",align:null},"30")))),(0,r.kt)("p",null,"The revision number of the SOLIDWORKS session can be obtained using the ",(0,r.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.isldworks~revisionnumber.html"},"ISldWorks::RevisionNumber")," method.\nThe returned value is a string in the format ",(0,r.kt)("strong",{parentName:"p"},"25.1.0"),", where the first number is the revision number."),(0,r.kt)("p",null,"There are some limitations when using this method:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"It is not possible to predict whether this method will connect to a running SOLIDWORKS instance or create a new instance."),(0,r.kt)("li",{parentName:"ul"},"It is not possible to specify which running SOLIDWORKS session to connect to (e.g., when multiple SOLIDWORKS sessions are open)."),(0,r.kt)("li",{parentName:"ul"},"If a new session is created by running this method, the session is by default invisible and started with the ",(0,r.kt)("em",{parentName:"li"},"/embed")," flag.\nThis means the session starts in a lightweight manner and does not load any add-ins.\nThis is designed to allow embedding the OLE object in third-party applications such as Microsoft Office.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"SOLIDWORKS part document OLE object in Excel",src:n(75173).Z,width:"400",height:"178"}),"{ width=400 }"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"It is not possible to create multiple active SOLIDWORKS sessions.")),(0,r.kt)("h2",{id:"method-b---running-object-table-rot"},"Method B - Running Object Table (ROT)"),(0,r.kt)("h3",{id:"connect-by-querying-com-instances-from-the-running-object-table-rot"},"Connect by querying COM instances from the ",(0,r.kt)("strong",{parentName:"h3"},"R"),"unning ",(0,r.kt)("strong",{parentName:"h3"},"O"),"bject ",(0,r.kt)("strong",{parentName:"h3"},"T"),"able (ROT)"),(0,r.kt)("p",null,"When a COM server creates an object instance, it creates an identifier for that instance and registers it in the Running Object Table (ROT).\nThe ROT enables inter-process communication with third-party applications by allowing objects to be looked up from running processes using the Windows API ",(0,r.kt)("a",{parentName:"p",href:"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684004(v=vs.85).aspx"},"GetRunningObjectTable"),"."),(0,r.kt)("p",null,"Here is an example of a running object table with multiple registered COM objects:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"!{00024505-0014-0000-C000-000000000046}")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"!Microsoft Visual Studio Telemetry:11004")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"!{31F45B04-7198-45ED-A13F-F224A4A1686A}")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"SolidWorks_PID_15212")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"!VisualStudio.DTE.14.0:16144")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Using this method, it is possible to connect to any SOLIDWORKS session from its process ID."),(0,r.kt)("li",{parentName:"ul"},"The desired number of sessions can be created by starting new SOLIDWORKS instances (e.g., by using the shell or start process API).")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If the SOLIDWORKS application and the stand-alone application run with different levels of privileges (e.g., one running as an administrator and the other not), it may not be possible to successfully retrieve objects from the ROT. Run them with the same user identity to enable communication.")),(0,r.kt)("p",null,"Please follow the links at the beginning of the article for detailed guides and code examples on how to connect to a SOLIDWORKS instance."))}u.isMDXComponent=!0},75173:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/excel-ole-object-13db6fcb520faeb8be81d999502198ad.png"},35778:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/reg-edit-clsid-4ed3fae7131826abd68460b995853f80.png"},96814:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/reg-edit-clsid_prog_id-702c04614dc036d847d91c3f9aa34c8e.png"}}]);