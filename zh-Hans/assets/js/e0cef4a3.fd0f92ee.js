"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[3040],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>g});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),u=c(t),f=o,g=u["".concat(l,".").concat(f)]||u[f]||d[f]||i;return t?r.createElement(g,s(s({ref:n},p),{},{components:t})):r.createElement(g,s({ref:n},p))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,s=new Array(i);s[0]=f;var a={};for(var l in n)hasOwnProperty.call(n,l)&&(a[l]=n[l]);a.originalType=e,a[u]="string"==typeof e?e:o,s[1]=a;for(var c=2;c<i;c++)s[c]=t[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},97786:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var r=t(87462),o=(t(67294),t(3905));const i={layout:"sw-macro-fix",title:"\u4fee\u590d\u5728SOLIDWORKS\u5b8f\u4e2d\u9519\u8bef\u4f7f\u752832\u4f4d\u7248\u672c\u7684Windows API\u51fd\u6570",image:"declare-function-win-api.png",labels:["\u5b8f","\u6545\u969c\u6392\u9664"],"redirect-from":["/2018/04/macro-troubleshooting-incorrect-use-of-32-bit-versions-of-win-api.html"]},s=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/index",title:"\u4fee\u590d\u5728SOLIDWORKS\u5b8f\u4e2d\u9519\u8bef\u4f7f\u752832\u4f4d\u7248\u672c\u7684Windows API\u51fd\u6570",description:"\u75c7\u72b6",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/index.md",tags:[],version:"current",frontMatter:{layout:"sw-macro-fix",title:"\u4fee\u590d\u5728SOLIDWORKS\u5b8f\u4e2d\u9519\u8bef\u4f7f\u752832\u4f4d\u7248\u672c\u7684Windows API\u51fd\u6570",image:"declare-function-win-api.png",labels:["\u5b8f","\u6545\u969c\u6392\u9664"],"redirect-from":["/2018/04/macro-troubleshooting-incorrect-use-of-32-bit-versions-of-win-api.html"]},sidebar:"tutorialSidebar",previous:{title:"\u901a\u8fc7SOLIDWORKS API\u9012\u589e\u6ce8\u91ca\u4e2d\u7684\u6570\u5b57\u503c\u7684\u5b8f\u7279\u5f81",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/increment-revision/"},next:{title:"index",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/insert-bodies-to-part/"}},l={},c=[{value:"\u75c7\u72b6",id:"\u75c7\u72b6",level:2},{value:"\u539f\u56e0",id:"\u539f\u56e0",level:2},{value:"\u89e3\u51b3\u65b9\u6cd5",id:"\u89e3\u51b3\u65b9\u6cd5",level:2}],p={toc:c},u="wrapper";function d(e){let{components:n,...i}=e;return(0,o.kt)(u,(0,r.Z)({},p,i,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"\u75c7\u72b6"},"\u75c7\u72b6"),(0,o.kt)("p",null,"\u7cfb\u7edf\u4ece\u65e9\u4e8e2012\u5e74\u7684SOLIDWORKS\u66f4\u65b0\u5230\u66f4\u65b0\u7684\u7248\u672c\u3002\n\u6216\u8005\u8fd0\u884c\u67d0\u4e9b\u65e7\u7248\u5b8f\u3002\n\u5b8f\u4f7f\u7528Windows API\u51fd\u6570\uff08\u4f8b\u5982\uff0c\u5177\u6709\u6d4f\u89c8\u6587\u4ef6/\u6587\u4ef6\u5939\u5bf9\u8bdd\u6846\uff0c\u8fde\u63a5\u5230\u6ce8\u518c\u8868\uff0c\u4f7f\u7528\u7a97\u53e3\u53e5\u67c4\uff09\u901a\u8fc7",(0,o.kt)("em",{parentName:"p"},"Declare Function"),"\u8bed\u53e5\u3002\n\u542f\u52a8\u65f6\u663e\u793a",(0,o.kt)("em",{parentName:"p"},"\u7f16\u8bd1\u9519\u8bef\uff1a\u5fc5\u987b\u66f4\u65b0\u6b64\u9879\u76ee\u7684\u4ee3\u7801\u4ee5\u572864\u4f4d\u7cfb\u7edf\u4e0a\u4f7f\u7528"),"\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Windows API Declare\u51fd\u6570\u4e0d\u517c\u5bb9\u9519\u8bef",src:t(36610).Z,width:"640",height:"187"}),"{ width=640 height=185 }"),(0,o.kt)("h2",{id:"\u539f\u56e0"},"\u539f\u56e0"),(0,o.kt)("p",null,"SOLIDWORKS\u57282013\u7248\u672c\u4e2d\u5c06Visual Basic for Application\u73af\u5883\u4eceVB6\u66f4\u65b0\u4e3aVB7\u3002\nVB6\u662f32\u4f4d\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c",(0,o.kt)("a",{parentName:"p",href:"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/64-bit-visual-basic-for-applications-overview"},"VB7"),"\u662f64\u4f4d\u5e94\u7528\u7a0b\u5e8f\u3002\n\u7531\u4e8e32/64\u4f4d\u53d8\u91cf\u5927\u5c0f\u7684\u5dee\u5f02\uff0c\u9700\u8981\u4f7f\u7528PtrSafe\u5173\u952e\u5b57\u6765\u786e\u4fdd\u5728x64\u7cfb\u7edf\u4e2d\u8fd0\u884c\u5b8f\u662f\u5b89\u5168\u7684\uff0c\u5e76\u4f7f\u7528LongPtr\u6216LongLong\u6765\u6b63\u786e\u89e3\u679032\u4f4d\u548c64\u4f4d\u73af\u5883\u4e2d\u7684Long\u7c7b\u578b\u53d8\u91cf\u3002"),(0,o.kt)("h2",{id:"\u89e3\u51b3\u65b9\u6cd5"},"\u89e3\u51b3\u65b9\u6cd5"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u4fee\u6539\u6240\u6709\u58f0\u660e\u5e76\u5305\u542bPtrSafe\u5173\u952e\u5b57\u548cLongPtr\u4f5c\u4e3aLong\u7c7b\u578b\u7684\u53d8\u91cf\u58f0\u660e"),(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u9700\u8981\u652f\u6301\u65e7\u7248\u672c\u7684SOLIDWORKS\uff082012\u5e74\u4e4b\u524d\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u9884\u7f16\u8bd1\u6761\u4ef6\u8bed\u53e5#IF-#Else")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'#If VBA7 Then\n    Private Type BROWSEINFO\n      hOwner As LongPtr\n      pidlRoot As Long\n      pszDisplayName As String\n      lpszTitle As String\n      ulFlags As Long\n      lpfnCallback As LongPtr\n      lParam As LongPtr\n      iImage As Long\n    End Type\n\n    Private Declare PtrSafe Function SHBrowseForFolder Lib "Shell32" (lpbi As BROWSEINFO) As Long\n    Private Declare PtrSafe Function SHGetPathFromIDList Lib "Shell32" (ByVal pidList As LongPtr, ByVal lpBuffer As String) As Long\n    Private Declare PtrSafe Sub CoTaskMemFree Lib "ole32" (ByVal hMem As LongPtr)\n#Else\n    Private Type BROWSEINFO\n        hOwner As Long\n        pidlRoot As Long\n        pszDisplayName As Long\n        lpszTitle As String\n        ulFlags As Long\n        lpfnCallback As Long\n        lParam As Long\n        iImage As Long\n    End Type\n    \n    Private Declare Function SHBrowseForFolder Lib "Shell32" (lpbi As BROWSEINFO) As Long\n    Private Declare Function SHGetPathFromIDList Lib "Shell32" (ByVal pidList As Long, ByVal lpBuffer As String) As Long\n    Private Declare Sub CoTaskMemFree Lib "ole32" (ByVal hMem As Long)\n#End If\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n        \n    swApp.SendMsgToUser "Selected folder " & BrowseForFolder\n    \nEnd Sub\n\nPublic Function BrowseForFolder() As String\n  \n    Dim bi As BROWSEINFO\n    Dim pidl As Long\n    Dim path As String\n  \n    bi.lpszTitle = ""\n    bi.ulFlags = 0\n    \n    pidl = SHBrowseForFolder(bi)\n    If pidl <> 0 Then\n    \n        path = Space$(265)\n        SHGetPathFromIDList pidl, path\n        path = Left$(path, InStr(path, Chr$(0)) - 1)\n    \n        CoTaskMemFree lngPIDL\n    End If\n    \n    BrowseForFolder = path\n    \nEnd Function\n\n')))}d.isMDXComponent=!0},36610:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/declare-function-win-api-3a639327dceb5ec2730f4b32ff4988b4.png"}}]);