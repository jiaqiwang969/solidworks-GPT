"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[73834],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>g});var d=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);n&&(d=d.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,d)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,d,a=function(e,n){if(null==e)return{};var t,d,a={},o=Object.keys(e);for(d=0;d<o.length;d++)t=o[d],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(d=0;d<o.length;d++)t=o[d],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=d.createContext({}),s=function(e){var n=d.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},c=function(e){var n=s(e.components);return d.createElement(l.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return d.createElement(d.Fragment,{},n)}},p=d.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=s(t),p=a,g=m["".concat(l,".").concat(p)]||m[p]||u[p]||o;return t?d.createElement(g,r(r({ref:n},c),{},{components:t})):d.createElement(g,r({ref:n},c))}));function g(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,r=new Array(o);r[0]=p;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[m]="string"==typeof e?e:a,r[1]=i;for(var s=2;s<o;s++)r[s]=t[s];return d.createElement.apply(null,r)}return d.createElement.apply(null,t)}p.displayName="MDXCreateElement"},52671:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>s});var d=t(87462),a=(t(67294),t(3905));const o={title:"\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u5904\u7406SOLIDWORKS\u6587\u4ef6\u7684\u5e38\u89c1\u4e8b\u4ef6",caption:"\u5e38\u89c1\u4e8b\u4ef6"},r=void 0,i={unversionedId:"codestack/labs/solidworks/swex/add-in/documents-management/events/index",id:"codestack/labs/solidworks/swex/add-in/documents-management/events/index",title:"\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u5904\u7406SOLIDWORKS\u6587\u4ef6\u7684\u5e38\u89c1\u4e8b\u4ef6",description:"\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u4e2d\u7684\u6587\u6863\u7ba1\u7406\u529f\u80fd\u5904\u7406\u5e38\u89c1\u4e8b\u4ef6\uff08\u91cd\u5efa\u3001\u9009\u62e9\u3001\u914d\u7f6e\u66f4\u6539\u3001\u9879\u76ee\u4fee\u6539\u3001\u81ea\u5b9a\u4e49\u5c5e\u6027\u4fee\u6539\u7b49\uff09",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/labs/solidworks/swex/add-in/documents-management/events/index.md",sourceDirName:"codestack/labs/solidworks/swex/add-in/documents-management/events",slug:"/codestack/labs/solidworks/swex/add-in/documents-management/events/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/documents-management/events/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/labs/solidworks/swex/add-in/documents-management/events/index.md",tags:[],version:"current",frontMatter:{title:"\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u5904\u7406SOLIDWORKS\u6587\u4ef6\u7684\u5e38\u89c1\u4e8b\u4ef6",caption:"\u5e38\u89c1\u4e8b\u4ef6"},sidebar:"tutorialSidebar",previous:{title:"\u901a\u8fc7SwEx.AddIn\u6846\u67b6\u7ba1\u7406SOLIDWORKS\u6587\u6863\u751f\u547d\u5468\u671f",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/documents-management/"},next:{title:"SwEx.Addin\u6846\u67b6\u7684\u793a\u4f8b\u548c\u6e90\u4ee3\u7801",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/examples"}},l={},s=[{value:"labels: \u4e8b\u4ef6,\u91cd\u5efa,\u9009\u62e9",id:"labels-\u4e8b\u4ef6\u91cd\u5efa\u9009\u62e9",level:2}],c={toc:s},m="wrapper";function u(e){let{components:n,...t}=e;return(0,a.kt)(m,(0,d.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u4e2d\u7684\u6587\u6863\u7ba1\u7406\u529f\u80fd\u5904\u7406\u5e38\u89c1\u4e8b\u4ef6\uff08\u91cd\u5efa\u3001\u9009\u62e9\u3001\u914d\u7f6e\u66f4\u6539\u3001\u9879\u76ee\u4fee\u6539\u3001\u81ea\u5b9a\u4e49\u5c5e\u6027\u4fee\u6539\u7b49\uff09\ntoc-group-name: labs-solidworks-swex"),(0,a.kt)("h2",{id:"labels-\u4e8b\u4ef6\u91cd\u5efa\u9009\u62e9"},"labels: ","[\u4e8b\u4ef6,\u91cd\u5efa,\u9009\u62e9]"),(0,a.kt)("p",null,"SwEx.AddIn\u6846\u67b6\u901a\u8fc7\u901a\u7528\u7684",(0,a.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/T_CodeStack_SwEx_AddIn_Core_DocumentHandler.htm"},"DocumentHandler"),"\u66b4\u9732\u5e38\u89c1\u4e8b\u4ef6\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4fdd\u5b58"),(0,a.kt)("li",{parentName:"ul"},"\u9009\u62e9"),(0,a.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\u7b2c\u4e09\u65b9\u6570\u636e"),(0,a.kt)("li",{parentName:"ul"},"\u81ea\u5b9a\u4e49\u5c5e\u6027\u4fee\u6539"),(0,a.kt)("li",{parentName:"ul"},"\u9879\u76ee\u4fee\u6539"),(0,a.kt)("li",{parentName:"ul"},"\u914d\u7f6e\u66f4\u6539"),(0,a.kt)("li",{parentName:"ul"},"\u91cd\u5efa"),(0,a.kt)("li",{parentName:"ul"},"\u5c3a\u5bf8\u66f4\u6539")),(0,a.kt)("p",null,"\u8c03\u7528",(0,a.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/M_CodeStack_SwEx_AddIn_Base_ISwAddInEx_CreateDocumentsHandler.htm"},"ISwAddInEx.CreateDocumentsHandler"),"\u521b\u5efa\u901a\u7528\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u3002"),(0,a.kt)("p",null,"\u5efa\u8bae\u4f7f\u7528",(0,a.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/E_CodeStack_SwEx_AddIn_Base_IDocumentsHandler_1_HandlerCreated.htm"},"HandleCreated"),"\u901a\u77e5\u6765\u8ba2\u9605\u6587\u6863\u4e8b\u4ef6\uff0c\u8be5\u901a\u77e5\u5c06\u901a\u77e5\u65b0\u6587\u6863\u5df2\u52a0\u8f7d\u3002"),(0,a.kt)("p",null,"\u4ece",(0,a.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/E_CodeStack_SwEx_AddIn_Core_DocumentHandler_Destroyed.htm"},"Destroyed"),"\u901a\u77e5\u4e2d\u53d6\u6d88\u8ba2\u9605\u4e8b\u4ef6\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Imports CodeStack.SwEx.AddIn\nImports CodeStack.SwEx.AddIn.Attributes\nImports CodeStack.SwEx.AddIn.Base\nImports CodeStack.SwEx.AddIn.Core\nImports CodeStack.SwEx.AddIn.Delegates\nImports CodeStack.SwEx.AddIn.Enums\nImports SolidWorks.Interop.sldworks\nImports SolidWorks.Interop.swconst\nImports System\nImports System.Runtime.InteropServices\n\nNamespace CodeStack.SwEx\n    <AutoRegister>\n    <ComVisible(True), Guid("E6BE0C5A-8B24-46B4-98F9-BEC4100BC709")>\n    Public Class EventsAddIn\n        Inherits SwAddInEx\n\n        Private m_DocHandlerGeneric As IDocumentsHandler(Of DocumentHandler)\n\n        Public Overrides Function OnConnect() As Boolean\n            m_DocHandlerGeneric = CreateDocumentsHandler()\n            AddHandler m_DocHandlerGeneric.HandlerCreated, AddressOf OnHandlerCreated\n            Return True\n        End Function\n\n        Private Sub OnHandlerCreated(ByVal doc As DocumentHandler)\n            AddHandler doc.Initialized, AddressOf OnInitialized\n            AddHandler doc.Activated, AddressOf OnActivated\n            AddHandler doc.ConfigurationChange, AddressOf OnConfigurationOrSheetChanged\n            AddHandler doc.CustomPropertyModify, AddressOf OnCustomPropertyModified\n            AddHandler doc.Access3rdPartyData, AddressOf OnAccess3rdPartyData\n            AddHandler doc.ItemModify, AddressOf OnItemModified\n            AddHandler doc.Save, AddressOf OnSave\n            AddHandler doc.Selection, AddressOf OnSelection\n            AddHandler doc.Rebuild, AddressOf OnRebuild\n            AddHandler doc.DimensionChange, AddressOf OnDimensionChange\n            AddHandler doc.Destroyed, AddressOf OnDestroyed\n        End Sub\n\n        Private Sub OnDestroyed(ByVal handler As DocumentHandler)\n            RemoveHandler handler.Initialized, AddressOf OnInitialized\n            RemoveHandler handler.Activated, AddressOf OnActivated\n            RemoveHandler handler.ConfigurationChange, AddressOf OnConfigurationOrSheetChanged\n            RemoveHandler handler.CustomPropertyModify, AddressOf OnCustomPropertyModified\n            RemoveHandler handler.ItemModify, AddressOf OnItemModified\n            RemoveHandler handler.Save, AddressOf OnSave\n            RemoveHandler handler.Selection, AddressOf OnSelection\n            RemoveHandler handler.Rebuild, AddressOf OnRebuild\n            RemoveHandler handler.DimensionChange, AddressOf OnDimensionChange\n            RemoveHandler handler.Destroyed, AddressOf OnDestroyed\n            Logger.Log($"\'{handler.Model.GetTitle()}\' \u5df2\u9500\u6bc1")\n        End Sub\n\n        Public Overrides Function OnDisconnect() As Boolean\n            RemoveHandler m_DocHandlerGeneric.HandlerCreated, AddressOf OnHandlerCreated\n            Return True\n        End Function\n\n    End Class\nEnd Namespace\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},'using CodeStack.SwEx.AddIn;\nusing CodeStack.SwEx.AddIn.Attributes;\nusing CodeStack.SwEx.AddIn.Base;\nusing CodeStack.SwEx.AddIn.Core;\nusing CodeStack.SwEx.AddIn.Delegates;\nusing CodeStack.SwEx.AddIn.Enums;\nusing SolidWorks.Interop.sldworks;\nusing SolidWorks.Interop.swconst;\nusing System;\nusing System.Runtime.InteropServices;\n\nnamespace CodeStack.SwEx\n{\n    [AutoRegister]\n    [ComVisible(true), Guid("76045173-E27C-4DF9-AE5F-147B893CE3DC")]\n    public class EventsAddIn : SwAddInEx\n    {\n        private IDocumentsHandler<DocumentHandler> m_DocHandlerGeneric;\n\n        public override bool OnConnect()\n        {\n            m_DocHandlerGeneric = CreateDocumentsHandler();\n            m_DocHandlerGeneric.HandlerCreated += OnHandlerCreated;\n            return true;\n        }\n\n        private void OnHandlerCreated(DocumentHandler doc)\n        {\n            doc.Initialized += OnInitialized;\n            doc.Activated += OnActivated;\n            doc.ConfigurationChange += OnConfigurationOrSheetChanged;\n            doc.CustomPropertyModify += OnCustomPropertyModified;\n            doc.Access3rdPartyData += OnAccess3rdPartyData;\n            doc.ItemModify += OnItemModified;\n            doc.Save += OnSave;\n            doc.Selection += OnSelection;\n            doc.Rebuild += OnRebuild;\n            doc.DimensionChange += OnDimensionChange;\n            doc.Destroyed += OnDestroyed;\n        }\n\n        private void OnDestroyed(DocumentHandler handler)\n        {\n            handler.Initialized -= OnInitialized;\n            handler.Activated -= OnActivated;\n            handler.ConfigurationChange -= OnConfigurationOrSheetChanged;\n            handler.CustomPropertyModify -= OnCustomPropertyModified;\n            handler.ItemModify -= OnItemModified;\n            handler.Save -= OnSave;\n            handler.Selection -= OnSelection;\n            handler.Rebuild -= OnRebuild;\n            handler.DimensionChange -= OnDimensionChange;\n            handler.Destroyed -= OnDestroyed;\n\n            Logger.Log($"\'{handler.Model.GetTitle()}\' \u5df2\u9500\u6bc1");\n        }\n\n        public override bool OnDisconnect()\n        {\n            m_DocHandlerGeneric.HandlerCreated -= OnHandlerCreated;\n            return true;\n        }\n\n    }\n}\n')),(0,a.kt)("p",null,"\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u63d0\u4f9b\u6709\u5173\u4e8b\u4ef6\u7684\u5176\u4ed6\u4fe1\u606f\uff0c\u4f8b\u5982\u5b83\u662f\u9884\u901a\u77e5\u8fd8\u662f\u540e\u901a\u77e5\u4ee5\u53ca\u4efb\u4f55\u9644\u52a0\u53c2\u6570\u3002\u8bf7\u67e5\u9605API\u53c2\u8003\u4ee5\u83b7\u53d6\u6709\u5173\u4f20\u9012\u53c2\u6570\u7684\u66f4\u591a\u4fe1\u606f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},"Private Function OnRebuild(ByVal docHandler As DocumentHandler, ByVal type As RebuildState_e) As Boolean\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u5df2\u91cd\u5efa ({type})\")\n\n    If type = RebuildState_e.PreRebuild Then\n        '\u8fd4\u56defalse\u4ee5\u53d6\u6d88\u91cd\u5efa\n    End If\n\n    Return True\nEnd Function\n\nPrivate Sub OnInitialized(ByVal docHandler As DocumentHandler)\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u5df2\u521d\u59cb\u5316\")\nEnd Sub\n\nPrivate Function OnSelection(ByVal docHandler As DocumentHandler, ByVal selType As swSelectType_e, ByVal type As SelectionState_e) As Boolean\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u9009\u62e9 ({type}) {selType}\")\n\n    If type <> SelectionState_e.UserPreSelect Then '\u52a8\u6001\u9009\u62e9\n        '\u8fd4\u56defalse\u4ee5\u53d6\u6d88\u9009\u62e9\n    End If\n\n    Return True\nEnd Function\n\nPrivate Function OnSave(ByVal docHandler As DocumentHandler, ByVal fileName As String, ByVal type As SaveState_e) As Boolean\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u6b63\u5728\u4fdd\u5b58 ({type})\")\n\n    If type = SaveState_e.PreSave Then\n        '\u8fd4\u56defalse\u4ee5\u53d6\u6d88\u4fdd\u5b58\n    End If\n\n    Return True\nEnd Function\n\nPrivate Sub OnItemModified(ByVal docHandler As DocumentHandler, ByVal type As ItemModificationAction_e, ByVal entType As swNotifyEntityType_e, ByVal name As String, ByVal Optional oldName As String = \"\")\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u9879\u76ee\u5df2\u4fee\u6539 ({type}) {entType}\u3002\u540d\u79f0\uff1a{name}\uff08\u6765\u81ea{oldName}\uff09\")\nEnd Sub\n\nPrivate Sub OnCustomPropertyModified(ByVal docHandler As DocumentHandler, ByVal modifications As CustomPropertyModifyData())\n    For Each [mod] In modifications\n        Logger.Log($\"'{docHandler.Model.GetTitle()}' \u81ea\u5b9a\u4e49\u5c5e\u6027'{[mod].Name}'\u5df2\u66f4\u6539\uff08{[mod].Action}\uff09\u5728'{[mod].Configuration}'\u4e2d\u7684\u503c\u4e3a'{[mod].Value}'\")\n    Next\nEnd Sub\n\nPrivate Sub OnAccess3rdPartyData(ByVal docHandler As DocumentHandler, ByVal state As Access3rdPartyDataState_e)\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u6b63\u5728\u8bbf\u95ee\u7b2c\u4e09\u65b9\u6570\u636e\uff08{state}\uff09\")\nEnd Sub\n\nPrivate Sub OnConfigurationOrSheetChanged(ByVal docHandler As DocumentHandler, ByVal type As ConfigurationChangeState_e, ByVal confName As String)\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u914d\u7f6e{confName}\u5df2\u66f4\u6539\uff08{type}\uff09\")\nEnd Sub\n\nPrivate Sub OnDimensionChange(ByVal docHandler As DocumentHandler, ByVal dispDim As IDisplayDimension)\n    Dim [dim] = dispDim.GetDimension2(0)\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u5c3a\u5bf8\u5df2\u66f4\u6539\uff1a{[dim].FullName} = {[dim].Value}\")\n    Marshal.ReleaseComObject([dim])\n    [dim] = Nothing\nEnd Sub\n\nPrivate Sub OnActivated(ByVal docHandler As DocumentHandler)\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' \u5df2\u6fc0\u6d3b\")\nEnd Sub\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"private bool OnRebuild(DocumentHandler docHandler, RebuildState_e type)\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' rebuilt ({type})\");\n\n    if(type == RebuildState_e.PreRebuild)\n    {\n        //\u8fd4\u56defalse\u4ee5\u53d6\u6d88\u91cd\u5efa\n    }\n\n    return true;\n}\n\nprivate void OnInitialized(DocumentHandler docHandler)\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' initialized\");\n}\n\nprivate bool OnSelection(DocumentHandler docHandler, swSelectType_e selType, SelectionState_e type)\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' selection ({type}) of {selType}\");\n\n    if (type != SelectionState_e.UserPreSelect) //\u52a8\u6001\u9009\u62e9\n    {\n        //\u8fd4\u56defalse\u4ee5\u53d6\u6d88\u9009\u62e9\n    }\n\n    return true;\n}\n\nprivate bool OnSave(DocumentHandler docHandler, string fileName, SaveState_e type)\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' saving ({type})\");\n\n    if (type == SaveState_e.PreSave)\n    {\n        //\u8fd4\u56defalse\u4ee5\u53d6\u6d88\u4fdd\u5b58\n    }\n\n    return true;\n}\n\nprivate void OnItemModified(DocumentHandler docHandler, ItemModificationAction_e type, swNotifyEntityType_e entType, string name, string oldName = \"\")\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' item modified ({type}) of {entType}. Name: {name} (from {oldName})\");\n}\n\nprivate void OnCustomPropertyModified(DocumentHandler docHandler, CustomPropertyModifyData[] modifications)\n{\n    foreach (var mod in modifications)\n    {\n        Logger.Log($\"'{docHandler.Model.GetTitle()}' custom property '{mod.Name}' changed ({mod.Action}) in '{mod.Configuration}' to '{mod.Value}'\");\n    }\n}\n\nprivate void OnAccess3rdPartyData(DocumentHandler docHandler, Access3rdPartyDataState_e state)\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' accessing 3rd party data ({state})\");\n}\n\nprivate void OnConfigurationOrSheetChanged(DocumentHandler docHandler, ConfigurationChangeState_e type, string confName)\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' configuration {confName} changed ({type})\");\n}\n\nprivate void OnDimensionChange(DocumentHandler docHandler, IDisplayDimension dispDim)\n{\n    var dim = dispDim.GetDimension2(0);\n\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' dimension change: {dim.FullName} = {dim.Value}\");\n\n    Marshal.ReleaseComObject(dim);\n    dim = null;\n}\n\nprivate void OnActivated(DocumentHandler docHandler)\n{\n    Logger.Log($\"'{docHandler.Model.GetTitle()}' activated\");\n}\n")))}u.isMDXComponent=!0}}]);