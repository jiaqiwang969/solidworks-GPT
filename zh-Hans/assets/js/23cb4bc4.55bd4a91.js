"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[13567],{3905:(n,e,t)=>{t.d(e,{Zo:()=>d,kt:()=>m});var o=t(67294);function a(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function i(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?r(Object(t),!0).forEach((function(e){a(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function s(n,e){if(null==n)return{};var t,o,a=function(n,e){if(null==n)return{};var t,o,a={},r=Object.keys(n);for(o=0;o<r.length;o++)t=r[o],e.indexOf(t)>=0||(a[t]=n[t]);return a}(n,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(o=0;o<r.length;o++)t=r[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}var c=o.createContext({}),l=function(n){var e=o.useContext(c),t=e;return n&&(t="function"==typeof n?n(e):i(i({},e),n)),t},d=function(n){var e=l(n.components);return o.createElement(c.Provider,{value:e},n.children)},p="mdxType",u={inlineCode:"code",wrapper:function(n){var e=n.children;return o.createElement(o.Fragment,{},e)}},w=o.forwardRef((function(n,e){var t=n.components,a=n.mdxType,r=n.originalType,c=n.parentName,d=s(n,["components","mdxType","originalType","parentName"]),p=l(t),w=a,m=p["".concat(c,".").concat(w)]||p[w]||u[w]||r;return t?o.createElement(m,i(i({ref:e},d),{},{components:t})):o.createElement(m,i({ref:e},d))}));function m(n,e){var t=arguments,a=e&&e.mdxType;if("string"==typeof n||a){var r=t.length,i=new Array(r);i[0]=w;var s={};for(var c in e)hasOwnProperty.call(e,c)&&(s[c]=e[c]);s.originalType=n,s[p]="string"==typeof n?n:a,i[1]=s;for(var l=2;l<r;l++)i[l]=t[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}w.displayName="MDXCreateElement"},39347:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var o=t(87462),a=(t(67294),t(3905));const r={title:"Starting SOLIDWORKS application in background (hidden)",caption:"Start In Background",description:"Instructions of how to start SOLIDWORKS application to be used by stand-alone automation tool in background (hidden)",image:"invisible-app.png",labels:["background","invisible"]},i=void 0,s={unversionedId:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/start-background/index",id:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/start-background/index",title:"Starting SOLIDWORKS application in background (hidden)",description:"Instructions of how to start SOLIDWORKS application to be used by stand-alone automation tool in background (hidden)",source:"@site/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/start-background/index.md",sourceDirName:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/start-background",slug:"/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/start-background/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/start-background/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/start-background/index.md",tags:[],version:"current",frontMatter:{title:"Starting SOLIDWORKS application in background (hidden)",caption:"Start In Background",description:"Instructions of how to start SOLIDWORKS application to be used by stand-alone automation tool in background (hidden)",image:"invisible-app.png",labels:["background","invisible"]},sidebar:"tutorialSidebar",previous:{title:"Create C++ Stand-Alone (exe) application for SOLIDWORKS",permalink:"/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/stand-alone/connect-cpp/"},next:{title:"Working with geometry (IModeler) using SOLIDWORKS API",permalink:"/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/geometry/"}},c={},l=[],d={toc:l},p="wrapper";function u(n){let{components:e,...r}=n;return(0,a.kt)(p,(0,o.Z)({},d,r,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Hidden SOLIDWORKS application",src:t(33952).Z,width:"1010",height:"741"}),"{ width=350 }"),(0,a.kt)("p",null,"In some cases when using the stand-alone application it might be beneficial to start application in background (invisible). This approach provides better user experience and better performance."),(0,a.kt)("p",null,"Any windows process can be started with its main Window to be hidden by using the following ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo"},"ProcessStartInfo")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"var prcInfo = new ProcessStartInfo()\n{\n    FileName = appPath,\n    CreateNoWindow = true,\n    WindowStyle = ProcessWindowStyle.Hidden\n};\n")),(0,a.kt)("p",null,"However for SOLIDWORKS application this code might not always work. Alternative way to hide the window would be using the ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-showwindow"},"ShowWindow")," Windows32 API. It is required to wait until the handle is created and SOLIDWORKS fully loaded before applying this method."),(0,a.kt)("p",null,"In addition to above, it is beneficial to use the ",(0,a.kt)("em",{parentName:"p"},"/r")," argument when starting SOLIDWORKS instance. This argument would allow to hide the splash screen and speed-up the startup. For SOLIDWORKS Professional and Premium it is also possible to use the ",(0,a.kt)("em",{parentName:"p"},"/b")," argument to start SOLIDWORKS in background (still visible)."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("em",{parentName:"p"},"/b")," flag is handled by SOLIDWORKS Task Scheduler and won't work for SOLIDWORKS Standard as Task Scheduler is not included into this package.")),(0,a.kt)("p",null,"Function below considers all points above and starts new session of SOLIDWORKS hidden. Use this function in conjunction with the code from the ",(0,a.kt)("a",{parentName:"p",href:"/docs/codestack/solidworks-api/getting-started/stand-alone/connect-csharp/"},"Create C# Stand-Alone Application"),"."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Some of the API method might not execute or behave incorrectly with SOLIDWORKS application being invisible.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},'private static ISldWorks StartSwAppBackground(string appPath, int timeoutSec = 20)\n{\n    var timeout = TimeSpan.FromSeconds(timeoutSec);\n\n    var startTime = DateTime.Now;\n\n    var prcInfo = new ProcessStartInfo()\n    {\n        FileName = appPath,\n        Arguments = "/r", //no splash screen\n        CreateNoWindow = true,\n        WindowStyle = ProcessWindowStyle.Hidden\n    };\n\n    var prc = Process.Start(prcInfo);\n    \n    ISldWorks app = null;\n\n    var isLoaded = false;\n\n    var onIdleFunc = new DSldWorksEvents_OnIdleNotifyEventHandler(() =>\n    {\n        isLoaded = true;\n        return 0;\n    });\n\n    try\n    {\n\n        while (!isLoaded)\n        {\n            if (DateTime.Now - startTime > timeout)\n            {\n                throw new TimeoutException();\n            }\n\n            if (app == null)\n            {\n                app = GetSwAppFromProcess(prc.Id);\n\n                if (app != null)\n                {\n                    (app as SldWorks).OnIdleNotify += onIdleFunc;\n                }\n            }\n\n            System.Threading.Thread.Sleep(100);\n        }\n\n        if (app != null)\n        {\n            const int HIDE = 0;\n            ShowWindow(new IntPtr(app.IFrameObject().GetHWnd()), HIDE);\n        }\n    }\n    catch\n    {\n        throw;\n    }\n    finally\n    {\n        if (app != null)\n        {\n            (app as SldWorks).OnIdleNotify -= onIdleFunc;\n        }\n    }\n\n    return app;\n}\n')))}u.isMDXComponent=!0},33952:(n,e,t)=>{t.d(e,{Z:()=>o});const o=t.p+"assets/images/invisible-app-ab9a244203f5ddb137b96c090ffbeff8.png"}}]);