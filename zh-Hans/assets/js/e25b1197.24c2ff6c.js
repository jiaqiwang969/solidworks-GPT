"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[75338],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>u});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),d=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=d(e.components);return r.createElement(i.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},S=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,i=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=d(a),S=n,u=c["".concat(i,".").concat(S)]||c[S]||p[S]||s;return a?r.createElement(u,l(l({ref:t},m),{},{components:a})):r.createElement(u,l({ref:t},m))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,l=new Array(s);l[0]=S;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o[c]="string"==typeof e?e:n,l[1]=o;for(var d=2;d<s;d++)l[d]=a[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}S.displayName="MDXCreateElement"},34401:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var r=a(87462),n=(a(67294),a(3905));const s={title:"\u901a\u8fc7SwEx.AddIn\u6846\u67b6\u5c06\u6570\u636e\u5b58\u50a8\u5728\u7b2c\u4e09\u65b9\u5b58\u50a8\uff08\u6d41\uff09\u4e2d",caption:"\u6d41"},l=void 0,o={unversionedId:"codestack/labs/solidworks/swex/add-in/third-party-data-storage/stream/index",id:"codestack/labs/solidworks/swex/add-in/third-party-data-storage/stream/index",title:"\u901a\u8fc7SwEx.AddIn\u6846\u67b6\u5c06\u6570\u636e\u5b58\u50a8\u5728\u7b2c\u4e09\u65b9\u5b58\u50a8\uff08\u6d41\uff09\u4e2d",description:"\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u5c06\u81ea\u5b9a\u4e49\u7ed3\u6784\u5e8f\u5217\u5316\u5230\u7b2c\u4e09\u65b9\u5b58\u50a8\uff08\u6d41\uff09\u4e2d",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/labs/solidworks/swex/add-in/third-party-data-storage/stream/index.md",sourceDirName:"codestack/labs/solidworks/swex/add-in/third-party-data-storage/stream",slug:"/codestack/labs/solidworks/swex/add-in/third-party-data-storage/stream/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/third-party-data-storage/stream/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/labs/solidworks/swex/add-in/third-party-data-storage/stream/index.md",tags:[],version:"current",frontMatter:{title:"\u901a\u8fc7SwEx.AddIn\u6846\u67b6\u5c06\u6570\u636e\u5b58\u50a8\u5728\u7b2c\u4e09\u65b9\u5b58\u50a8\uff08\u6d41\uff09\u4e2d",caption:"\u6d41"},sidebar:"tutorialSidebar",previous:{title:"\u901a\u8fc7SwEx.AddIn\u6846\u67b6\u5c06\u6570\u636e\u5b58\u50a8\u5728\u7b2c\u4e09\u65b9\u5b58\u50a8\u4e2d",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/third-party-data-storage/storage/"},next:{title:"SwEx.AddIn Framework\u7684\u5b89\u88c5\u548c\u66f4\u65b0",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/installation/"}},i={},d=[{value:"sidebar_position: 0",id:"sidebar_position-0",level:2},{value:"\u6d41\u8bbf\u95ee\u5904\u7406\u7a0b\u5e8f",id:"\u6d41\u8bbf\u95ee\u5904\u7406\u7a0b\u5e8f",level:2},{value:"\u8bfb\u53d6\u6570\u636e",id:"\u8bfb\u53d6\u6570\u636e",level:2},{value:"\u5199\u5165\u6570\u636e",id:"\u5199\u5165\u6570\u636e",level:2}],m={toc:d},c="wrapper";function p(e){let{components:t,...a}=e;return(0,n.kt)(c,(0,r.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u5c06\u81ea\u5b9a\u4e49\u7ed3\u6784\u5e8f\u5217\u5316\u5230\u7b2c\u4e09\u65b9\u5b58\u50a8\uff08\u6d41\uff09\u4e2d\ntoc-group-name: labs-solidworks-swex"),(0,n.kt)("h2",{id:"sidebar_position-0"},"sidebar_position: 0"),(0,n.kt)("p",null,"\u8c03\u7528",(0,n.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/M_SolidWorks_Interop_sldworks_ModelDocExtension_Access3rdPartyStream.htm"},"IModelDoc2::Access3rdPartyStream"),"\u6269\u5c55\u65b9\u6cd5\u6765\u8bbf\u95ee\u7b2c\u4e09\u65b9\u6d41\u3002\u4f20\u9012\u5e03\u5c14\u53c2\u6570\u4ee5\u8bfb\u53d6\u6216\u5199\u5165\u6d41\u3002"),(0,n.kt)("p",null,"\u5728\u9700\u8981\u5728\u6a21\u578b\u4e2d\u5b58\u50a8\u5355\u4e2a\u7ed3\u6784\u65f6\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002"),(0,n.kt)("h2",{id:"\u6d41\u8bbf\u95ee\u5904\u7406\u7a0b\u5e8f"},"\u6d41\u8bbf\u95ee\u5904\u7406\u7a0b\u5e8f"),(0,n.kt)("p",null,"\u4e3a\u4e86\u7b80\u5316\u6d41\u751f\u547d\u5468\u671f\u7684\u5904\u7406\uff0c\u4f7f\u7528SwEx.AddIn\u6846\u67b6\u7684Documents Manager API\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Private Const STREAM_NAME As String = "CodeStackStream"\n\nPublic Class StreamData\n    Public Property Prp1 As String\n    Public Property Prp2 As Double\nEnd Class\n\nPrivate m_StreamData As StreamData\n\nPrivate Sub LoadFromStream(ByVal model As IModelDoc2)\n    Using streamHandler = model.Access3rdPartyStream(STREAM_NAME, False)\n\n        If streamHandler.Stream IsNot Nothing Then\n\n            Using str = streamHandler.Stream\n                Dim xmlSer = New XmlSerializer(GetType(StreamData))\n                m_StreamData = TryCast(xmlSer.Deserialize(str), StreamData)\n            End Using\n        End If\n    End Using\nEnd Sub\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-cs"},'private const string STREAM_NAME = "CodeStackStream";\n\npublic class StreamData\n{\n    public string Prp1 { get; set; }\n    public double Prp2 { get; set; }\n}\n\nprivate StreamData m_StreamData;\n\nprivate void LoadFromStream(IModelDoc2 model)\n{\n    using (var streamHandler = model.Access3rdPartyStream(STREAM_NAME, false))\n    {\n        if (streamHandler.Stream != null)\n        {\n            using (var str = streamHandler.Stream)\n            {\n                var xmlSer = new XmlSerializer(typeof(StreamData));\n                m_StreamData = xmlSer.Deserialize(str) as StreamData;\n            }\n        }\n    }\n}\n')),(0,n.kt)("h2",{id:"\u8bfb\u53d6\u6570\u636e"},"\u8bfb\u53d6\u6570\u636e"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/P_CodeStack_SwEx_AddIn_Base_IThirdPartyStreamHandler_Stream.htm"},"IThirdPartyStreamHandler::Stream"),"\u5c5e\u6027\u5728\u8bfb\u53d6\u4e0d\u5b58\u5728\u7684\u6d41\u65f6\u8fd4\u56denull\u3002"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Private Const STREAM_NAME As String = "CodeStackStream"\n\nPublic Class StreamData\n    Public Property Prp1 As String\n    Public Property Prp2 As Double\nEnd Class\n\nPrivate m_StreamData As StreamData\n\nPrivate Sub LoadFromStream(ByVal model As IModelDoc2)\n    Using streamHandler = model.Access3rdPartyStream(STREAM_NAME, False)\n\n        If streamHandler.Stream IsNot Nothing Then\n\n            Using str = streamHandler.Stream\n                Dim xmlSer = New XmlSerializer(GetType(StreamData))\n                m_StreamData = TryCast(xmlSer.Deserialize(str), StreamData)\n            End Using\n        End If\n    End Using\nEnd Sub\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-cs"},'private const string STREAM_NAME = "CodeStackStream";\n\npublic class StreamData\n{\n    public string Prp1 { get; set; }\n    public double Prp2 { get; set; }\n}\n\nprivate StreamData m_StreamData;\n\nprivate void LoadFromStream(IModelDoc2 model)\n{\n    using (var streamHandler = model.Access3rdPartyStream(STREAM_NAME, false))\n    {\n        if (streamHandler.Stream != null)\n        {\n            using (var str = streamHandler.Stream)\n            {\n                var xmlSer = new XmlSerializer(typeof(StreamData));\n                m_StreamData = xmlSer.Deserialize(str) as StreamData;\n            }\n        }\n    }\n}\n')),(0,n.kt)("h2",{id:"\u5199\u5165\u6570\u636e"},"\u5199\u5165\u6570\u636e"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/P_CodeStack_SwEx_AddIn_Base_IThirdPartyStreamHandler_Stream.htm"},"IThirdPartyStreamHandler::Stream"),"\u5c5e\u6027\u5c06\u59cb\u7ec8\u8fd4\u56de\u6307\u5411\u6d41\u7684\u6307\u9488\uff08\u5982\u679c\u6d41\u4e0d\u5b58\u5728\uff0c\u5219\u81ea\u52a8\u521b\u5efa\u6d41\uff09\u3002"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Private Const STREAM_NAME As String = "CodeStackStream"\n\nPublic Class StreamData\n    Public Property Prp1 As String\n    Public Property Prp2 As Double\nEnd Class\n\nPrivate m_StreamData As StreamData\n\nPrivate Sub SaveToStream(ByVal model As IModelDoc2)\n    Using streamHandler = model.Access3rdPartyStream(STREAM_NAME, True)\n\n        Using str = streamHandler.Stream\n            Dim xmlSer = New XmlSerializer(GetType(StreamData))\n            xmlSer.Serialize(str, m_StreamData)\n        End Using\n    End Using\nEnd Sub\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-cs"},'private const string STREAM_NAME = "CodeStackStream";\n\npublic class StreamData\n{\n    public string Prp1 { get; set; }\n    public double Prp2 { get; set; }\n}\n\nprivate StreamData m_StreamData;\n\nprivate void SaveToStream(IModelDoc2 model)\n{\n    using (var streamHandler = model.Access3rdPartyStream(STREAM_NAME, true))\n    {\n        using (var str = streamHandler.Stream)\n        {\n            var xmlSer = new XmlSerializer(typeof(StreamData));\n\n            xmlSer.Serialize(str, m_StreamData);\n        }\n    }\n}\n')))}p.isMDXComponent=!0}}]);