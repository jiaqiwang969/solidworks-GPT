"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[92161],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>w});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),m=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},d=function(e){var n=m(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=m(t),p=o,w=u["".concat(l,".").concat(p)]||u[p]||c[p]||s;return t?r.createElement(w,a(a({ref:n},d),{},{components:t})):r.createElement(w,a({ref:n},d))}));function w(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var s=t.length,a=new Array(s);a[0]=p;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[u]="string"==typeof e?e:o,a[1]=i;for(var m=2;m<s;m++)a[m]=t[m];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},49584:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>m});var r=t(87462),o=(t(67294),t(3905));const s={layout:"sw-tool",title:"\u81ea\u52a8\u4e3aSOLIDWORKS\u6587\u4ef6\u5206\u914d\u65b0\u6587\u4ef6\u540d",image:"save-as-dialog.png",labels:["\u65b0\u6587\u4ef6\u540d","\u81ea\u52a8\u547d\u540d"],group:"Model"},a=void 0,i={unversionedId:"codestack/solidworks-api/document/set-new-file-name/index",id:"codestack/solidworks-api/document/set-new-file-name/index",title:"\u81ea\u52a8\u4e3aSOLIDWORKS\u6587\u4ef6\u5206\u914d\u65b0\u6587\u4ef6\u540d",description:"\u8fd9\u4e2aVBA\u5b8f\u5141\u8bb8\u6839\u636e\u81ea\u5b9a\u4e49\u5c5e\u6027\u503c\u6216\u5f15\u7528\u7684\u7ed8\u56fe\u89c6\u56fe\u6765\u81ea\u52a8\u8bbe\u7f6e\u65b0\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u4f7f\u7528SOLIDWORKS API\u3002",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/document/set-new-file-name/index.md",sourceDirName:"codestack/solidworks-api/document/set-new-file-name",slug:"/codestack/solidworks-api/document/set-new-file-name/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/set-new-file-name/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/document/set-new-file-name/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",title:"\u81ea\u52a8\u4e3aSOLIDWORKS\u6587\u4ef6\u5206\u914d\u65b0\u6587\u4ef6\u540d",image:"save-as-dialog.png",labels:["\u65b0\u6587\u4ef6\u540d","\u81ea\u52a8\u547d\u540d"],group:"Model"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS API\u8bbe\u7f6eBOM\u6570\u91cf\uff08\u5355\u4f4d\uff09\u5c5e\u6027",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/set-bom-quantity-unit-of-measure-property/"},next:{title:"\u4f7f\u7528SOLIDWORKS API\u81ea\u52a8\u5316\u94a3\u91d1\u96f6\u4ef6",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/sheet-metal/"}},l={},m=[{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2},{value:"\u8bbe\u7f6e\u540d\u79f0\u6765\u6e90",id:"\u8bbe\u7f6e\u540d\u79f0\u6765\u6e90",level:3},{value:"\u8bbe\u7f6e\u6807\u9898\u6a21\u5f0f",id:"\u8bbe\u7f6e\u6807\u9898\u6a21\u5f0f",level:3}],d={toc:m},u="wrapper";function c(e){let{components:n,...s}=e;return(0,o.kt)(u,(0,r.Z)({},d,s,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"\u8fd9\u4e2aVBA\u5b8f\u5141\u8bb8\u6839\u636e\u81ea\u5b9a\u4e49\u5c5e\u6027\u503c\u6216\u5f15\u7528\u7684\u7ed8\u56fe\u89c6\u56fe\u6765\u81ea\u52a8\u8bbe\u7f6e\u65b0\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u4f7f\u7528SOLIDWORKS API\u3002"),(0,o.kt)("p",null,"\u6b64\u5b8f\u4ec5\u9002\u7528\u4e8e\u4ece\u672a\u4fdd\u5b58\u8fc7\u7684\u6587\u4ef6\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"\u6587\u4ef6\u53e6\u5b58\u4e3a\u5bf9\u8bdd\u6846",src:t(33192).Z,width:"781",height:"595"}),"{ width=350 }"),(0,o.kt)("h2",{id:"\u914d\u7f6e"},"\u914d\u7f6e"),(0,o.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539\u5b8f\u5f00\u5934\u7684\u5e38\u91cf\u7684\u503c\u6765\u914d\u7f6e\u5b8f\u3002"),(0,o.kt)("h3",{id:"\u8bbe\u7f6e\u540d\u79f0\u6765\u6e90"},"\u8bbe\u7f6e\u540d\u79f0\u6765\u6e90"),(0,o.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539",(0,o.kt)("em",{parentName:"p"},"NAME_SOURCE"),"\u5e38\u91cf\u6765\u8bbe\u7f6e\u540d\u79f0\u7684\u6765\u6e90\uff0c\u5b83\u53ef\u4ee5\u53d6\u4ee5\u4e0b\u503c\u4e4b\u4e00\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"DefaultDrawingViewFileName - \u4ece\u7ed8\u56fe\u4e2d\u89c6\u56fe\u7684\u5f15\u7528\u6587\u6863\u7684\u6807\u9898\u4e2d\u63d0\u53d6\u540d\u79f0"),(0,o.kt)("li",{parentName:"ul"},"DefaultDrawingViewCustomProperty - \u4ece\u7ed8\u56fe\u4e2d\u9ed8\u8ba4\u89c6\u56fe\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u4e2d\u63d0\u53d6\u503c"),(0,o.kt)("li",{parentName:"ul"},"CustomProperty - \u4ece\u81ea\u5b9a\u4e49\u5c5e\u6027\u4e2d\u63d0\u53d6\u503c")),(0,o.kt)("p",null,"\u5982\u679c\u4f7f\u7528",(0,o.kt)("em",{parentName:"p"},"DefaultDrawingViewCustomProperty"),"\u6216",(0,o.kt)("em",{parentName:"p"},"CustomProperty"),"\u9009\u9879\uff0c\u5219\u9700\u8981\u5728",(0,o.kt)("em",{parentName:"p"},"PRP_NAME"),"\u5e38\u91cf\u4e2d\u6307\u5b9a\u8981\u4ece\u4e2d\u8bfb\u53d6\u503c\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684\u540d\u79f0\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Const NAME_SOURCE As Integer = NameSource_e.CustomProperty\nConst PRP_NAME As String = "PartNo"\n')),(0,o.kt)("h3",{id:"\u8bbe\u7f6e\u6807\u9898\u6a21\u5f0f"},"\u8bbe\u7f6e\u6807\u9898\u6a21\u5f0f"),(0,o.kt)("p",null,"\u5b8f\u6709\u4e24\u79cd\u6a21\u5f0f\u53ef\u4ee5\u901a\u8fc7",(0,o.kt)("em",{parentName:"p"},"AUTO_SAVE"),"\u5e38\u91cf\u8bbe\u7f6e\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"True - \u6587\u4ef6\u5c06\u81ea\u52a8\u4fdd\u5b58\u5230\u4e0e\u539f\u59cb\u6a21\u578b\u76f8\u540c\u7684\u6587\u4ef6\u5939\u4e2d"),(0,o.kt)("li",{parentName:"ul"},"False - \u6807\u9898\u5c06\u5728\u624b\u52a8\u4fdd\u5b58\u65f6\u5206\u914d\u5e76\u9884\u586b\u5145\u5728",(0,o.kt)("em",{parentName:"li"},"\u53e6\u5b58\u4e3a"),"\u5bf9\u8bdd\u6846\u4e2d")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},"Const AUTO_SAVE As Boolean = True\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Public Enum NameSource_e\n    DefaultDrawingViewFileName\n    DefaultDrawingViewCustomProperty\n    CustomProperty\nEnd Enum\n\nConst NAME_SOURCE As Integer = NameSource_e.CustomProperty\nConst PRP_NAME As String = "PartNo"\n\nConst AUTO_SAVE As Boolean = True\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    \n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n        \n        If swModel.GetPathName() = "" Then\n            \n            Dim newFileName As String\n            newFileName = CreateSaveFileName(swModel, Not AUTO_SAVE, NAME_SOURCE, PRP_NAME)\n            If newFileName <> "" Then\n                \n                If AUTO_SAVE Then\n                    \n                    Dim errs As Long\n                    Dim warns As Long\n                \n                    If False = swModel.Extension.SaveAs(newFileName, swSaveAsVersion_e.swSaveAsCurrentVersion, swSaveAsOptions_e.swSaveAsOptions_Silent, Nothing, errs, warns) Then\n                        Err.Raise vbError, "", "\u4fdd\u5b58\u6a21\u578b\u5931\u8d25: " & errs\n                    End If\n                Else\n                    If False = swModel.SetTitle2(newFileName) Then\n                        Err.Raise vbError, "", "\u8bbe\u7f6e\u6a21\u578b\u6807\u9898\u5931\u8d25"\n                    End If\n                End If\n            Else\n                Err.Raise vbError, "", "\u751f\u6210\u6587\u4ef6\u540d\u5931\u8d25"\n            End If\n            \n        End If\n        \n    Else\n        Err.Raise vbError, "", "\u6a21\u578b\u4e3a\u7a7a"\n    End If\n    \nEnd Sub\n\nFunction CreateSaveFileName(model As SldWorks.ModelDoc2, nameOnly As Boolean, src As NameSource_e, Optional prpName As String = "")\n    \n    Dim swCurModel As SldWorks.ModelDoc2\n    Dim fileName As String\n    \n    If src = NameSource_e.CustomProperty Then\n        \n        Dim swConf As SldWorks.Configuration\n        Set swConf = model.ConfigurationManager.ActiveConfiguration\n        \n        Dim confName As String\n        \n        If Not swConf Is Nothing Then\n            confName = swConf.Name\n        Else\n            confName = ""\n        End If\n        \n        Set swCurModel = model\n        \n        fileName = GetCustomPropertyValue(model, prpName, confName)\n        \n    ElseIf src = NameSource_e.DefaultDrawingViewFileName Or src = NameSource_e.DefaultDrawingViewCustomProperty Then\n            \n        If model.GetType() = swDocumentTypes_e.swDocDRAWING Then\n            \n            Dim swView As SldWorks.view\n            Dim swDraw As SldWorks.DrawingDoc\n            Set swDraw = model\n            Set swView = GetDefaultView(swDraw.GetCurrentSheet())\n            \n            If Not swView Is Nothing Then\n                \n                Dim swViewModel As SldWorks.ModelDoc2\n                Set swViewModel = swView.ReferencedDocument\n                \n                Set swCurModel = swViewModel\n                \n                If Not swViewModel Is Nothing Then\n                    If src = NameSource_e.DefaultDrawingViewFileName Then\n                        fileName = GetFileName(swViewModel)\n                    ElseIf src = NameSource_e.DefaultDrawingViewCustomProperty Then\n                        fileName = GetCustomPropertyValue(swViewModel, prpName, swView.ReferencedConfiguration)\n                    Else\n                        Err.Raise vbError, "", "\u4e0d\u652f\u6301\u7684\u7ed8\u56fe\u6765\u6e90"\n                    End If\n                Else\n                    Err.Raise vbError, "", "\u65e0\u6cd5\u4ece\u89c6\u56fe\u83b7\u53d6\u6a21\u578b"\n                End If\n                \n            Else\n                Err.Raise vbError, "", "\u627e\u4e0d\u5230\u9ed8\u8ba4\u89c6\u56fe"\n            End If\n        Else\n            Err.Raise vbError, "", "\u6b64\u6765\u6e90\u4ec5\u9002\u7528\u4e8e\u7ed8\u56fe"\n        End If\n    Else\n        Err.Raise vbError, "", "\u4e0d\u652f\u6301\u7684\u6765\u6e90"\n    End If\n    \n    If nameOnly Then\n        CreateSaveFileName = fileName\n    Else\n        CreateSaveFileName = GetFilePath(model, swCurModel, fileName)\n    End If\n    \nEnd Function\n\nFunction GetFileName(model As SldWorks.ModelDoc2) As String\n    \n    Dim path As String\n    path = model.GetPathName\n    \n    Dim fileName As String\n    \n    fileName = Right(path, Len(path) - InStrRev(path, "\\"))\n    \n    fileName = Left(fileName, InStrRev(fileName, ".") - 1)\n    \n    GetFileName = fileName\n    \nEnd Function\n\nFunction GetFilePath(targModel As SldWorks.ModelDoc2, srcModel As SldWorks.ModelDoc2, fileName As String)\n    \n    Dim ext As String\n    \n    Select Case targModel.GetType()\n        Case swDocumentTypes_e.swDocPART\n            ext = ".sldprt"\n        Case swDocumentTypes_e.swDocASSEMBLY\n            ext = ".sldasm"\n        Case swDocumentTypes_e.swDocDRAWING\n            ext = ".slddrw"\n    End Select\n    \n    Dim dirPath As String\n    \n    dirPath = srcModel.GetPathName\n    \n    If dirPath = "" Then\n        Err.Raise vbError, "", "\u6a21\u578b\u672a\u4fdd\u5b58"\n    End If\n    \n    dirPath = Left(dirPath, InStrRev(dirPath, "\\"))\n    \n    GetFilePath = dirPath & fileName & ext\n    \nEnd Function\n\nFunction GetCustomPropertyValue(model As SldWorks.ModelDoc2, prpName As String, confName As String)\n    \n    Dim swCustPrpMgr As SldWorks.CustomPropertyManager\n    Set swCustPrpMgr = model.Extension.CustomPropertyManager(confName)\n    \n    Dim val As String\n    Dim resVal As String\n    swCustPrpMgr.Get4 prpName, False, val, resVal\n    \n    If resVal = "" Then\n        Set swCustPrpMgr = model.Extension.CustomPropertyManager("")\n        swCustPrpMgr.Get4 prpName, False, val, resVal\n    End If\n    \n    GetCustomPropertyValue = resVal\n    \nEnd Function\n\nFunction GetDefaultView(swSheet As SldWorks.Sheet) As SldWorks.view\n    \n    Dim vViews As Variant\n    \n    vViews = swSheet.GetViews\n    \n    If Not IsEmpty(vViews) Then\n        \n        Dim i As Integer\n        \n        For i = 0 To UBound(vViews)\n            \n            Dim swView As SldWorks.view\n            Set swView = vViews(i)\n            \n            If UCase(swView.Name) = UCase(swSheet.CustomPropertyView) Then\n                Set GetDefaultView = swView\n                Exit Function\n            End If\n            \n        Next\n        \n        Set GetDefaultView = vViews(0) \'\u4f7f\u7528\u7b2c\u4e00\u4e2a\n        \n    End If\n    \nEnd Function\n')))}c.isMDXComponent=!0},33192:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/save-as-dialog-ce02b79d295e01388433dd8313b834b0.png"}}]);