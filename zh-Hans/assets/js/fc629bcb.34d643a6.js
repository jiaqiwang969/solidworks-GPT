"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[69553],{3905:(t,e,n)=>{n.d(e,{Zo:()=>m,kt:()=>A});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var d=a.createContext({}),p=function(t){var e=a.useContext(d),n=e;return t&&(n="function"==typeof t?t(e):s(s({},e),t)),n},m=function(t){var e=p(t.components);return a.createElement(d.Provider,{value:e},t.children)},c="mdxType",l={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,d=t.parentName,m=i(t,["components","mdxType","originalType","parentName"]),c=p(n),u=r,A=c["".concat(d,".").concat(u)]||c[u]||l[u]||o;return n?a.createElement(A,s(s({ref:e},m),{},{components:n})):a.createElement(A,s({ref:e},m))}));function A(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,s=new Array(o);s[0]=u;var i={};for(var d in e)hasOwnProperty.call(e,d)&&(i[d]=e[d]);i.originalType=t,i[c]="string"==typeof t?t:r,s[1]=i;for(var p=2;p<o;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},13001:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>s,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const o={layout:"sw-tool",caption:"\u81ea\u52a8\u65e5\u671f\u81ea\u5b9a\u4e49\u5c5e\u6027",title:"\u5728SOLIDWORKS\u6587\u4ef6\u4e2d\u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u81ea\u52a8\u66f4\u65b0\u7684\u65e5\u671f\u81ea\u5b9a\u4e49\u5c5e\u6027"},s=void 0,i={unversionedId:"codestack/solidworks-api/data-storage/custom-properties/auto-date/index",id:"codestack/solidworks-api/data-storage/custom-properties/auto-date/index",title:"\u5728SOLIDWORKS\u6587\u4ef6\u4e2d\u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u81ea\u52a8\u66f4\u65b0\u7684\u65e5\u671f\u81ea\u5b9a\u4e49\u5c5e\u6027",description:"\u8fd9\u4e2aVBA\u5b8f\u5141\u8bb8\u5c06\u81ea\u5b9a\u4e49\u5c5e\u6027\u65e5\u671f\u63d2\u5165\u5230\u6587\u4ef6\u7279\u5b9a\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u4e2d\u3002\u7528\u6237\u53ef\u4ee5\u9009\u62e9\u65e5\u671f\u7684\u683c\u5f0f\u3002\u8bf7\u53c2\u8003\u65e5\u671f\u548c\u65f6\u95f4\u683c\u5f0f\u5b57\u7b26\u4e32\u4ee5\u83b7\u53d6\u66f4\u591a\u5173\u4e8e\u652f\u6301\u7684\u683c\u5f0f\u7684\u4fe1\u606f\u3002",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/data-storage/custom-properties/auto-date/index.md",sourceDirName:"codestack/solidworks-api/data-storage/custom-properties/auto-date",slug:"/codestack/solidworks-api/data-storage/custom-properties/auto-date/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/data-storage/custom-properties/auto-date/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/data-storage/custom-properties/auto-date/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",caption:"\u81ea\u52a8\u65e5\u671f\u81ea\u5b9a\u4e49\u5c5e\u6027",title:"\u5728SOLIDWORKS\u6587\u4ef6\u4e2d\u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u81ea\u52a8\u66f4\u65b0\u7684\u65e5\u671f\u81ea\u5b9a\u4e49\u5c5e\u6027"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS API\u7ba1\u7406\u81ea\u5b9a\u4e49\u5c5e\u6027",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/data-storage/custom-properties/"},next:{title:"\u5c06SOLIDWORKS\u6587\u4ef6\u7279\u5b9a\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u590d\u5236\u5230\u914d\u7f6e",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/data-storage/custom-properties/copy-file-specific-to-configuration/"}},d={},p=[{value:"CAD+",id:"cad",level:2}],m={toc:p},c="wrapper";function l(t){let{components:e,...n}=t;return(0,r.kt)(c,(0,a.Z)({},m,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u8fd9\u4e2aVBA\u5b8f\u5141\u8bb8\u5c06\u81ea\u5b9a\u4e49\u5c5e\u6027",(0,r.kt)("strong",{parentName:"p"},"\u65e5\u671f"),"\u63d2\u5165\u5230\u6587\u4ef6\u7279\u5b9a\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u4e2d\u3002\u7528\u6237\u53ef\u4ee5\u9009\u62e9\u65e5\u671f\u7684\u683c\u5f0f\u3002\u8bf7\u53c2\u8003",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings"},"\u65e5\u671f\u548c\u65f6\u95f4\u683c\u5f0f\u5b57\u7b26\u4e32"),"\u4ee5\u83b7\u53d6\u66f4\u591a\u5173\u4e8e\u652f\u6301\u7684\u683c\u5f0f\u7684\u4fe1\u606f\u3002"),(0,r.kt)("h2",{id:"cad"},"CAD+"),(0,r.kt)("p",null,"\u8fd9\u4e2a\u5b8f\u4e0e",(0,r.kt)("a",{parentName:"p",href:"https://cadplus.xarial.com/toolbar/"},"Toolbar+"),"\u548c",(0,r.kt)("a",{parentName:"p",href:"https://cadplus.xarial.com/batch/"},"Batch+"),"\u5de5\u5177\u517c\u5bb9\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u6309\u94ae\u6dfb\u52a0\u5230\u5de5\u5177\u680f\u5e76\u5206\u914d\u5feb\u6377\u952e\u4ee5\u4fbf\u66f4\u65b9\u4fbf\u5730\u8bbf\u95ee\u6216\u6279\u91cf\u8fd0\u884c\u3002"),(0,r.kt)("p",null,"\u8981\u542f\u7528",(0,r.kt)("a",{parentName:"p",href:"https://cadplus.xarial.com/toolbar/configuration/arguments/"},"\u5b8f\u53c2\u6570"),"\uff0c\u5c06",(0,r.kt)("strong",{parentName:"p"},"ARGS"),"\u5e38\u91cf\u8bbe\u7f6e\u4e3atrue\uff0c\u5e76\u5c06\u683c\u5f0f\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},"#Const ARGS = True\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'#Const ARGS = False \'True to use arguments from Toolbar+ or Batch+ instead of the constant\n\nConst DATE_PRP_NAME As String = "Date"\n\nSub main()\n\n    Dim swApp As SldWorks.SldWorks\n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    Set swModel = swApp.ActiveDoc\n        \ntry_:\n    On Error GoTo catch_\n    \n    If Not swModel Is Nothing Then\n        \n        Dim dateFormat As String\n        \n        #If ARGS Then\n                \n            Dim macroRunner As Object\n            Set macroRunner = CreateObject("CadPlus.MacroRunner.Sw")\n            \n            Dim param As Object\n            Set param = macroRunner.PopParameter(swApp)\n            \n            Dim vArgs As Variant\n            vArgs = param.Get("Args")\n            \n            dateFormat = CStr(vArgs(0))\n        \n        #Else\n            dateFormat = GetDateFormat()\n        #End If\n    \n        If dateFormat <> "" Then\n            SetDateCustomProperty swModel, dateFormat\n        End If\n    Else\n        Err.Raise vbError, "", "Please open model"\n    End If\n    \n    GoTo finally_\ncatch_:\n    MsgBox Err.Description, vbCritical\nfinally_:\n\nEnd Sub\n\nFunction GetDateFormat(Optional defaultDateFormat As String = "dd/mm/yyyy") As String\n    GetDateFormat = InputBox("Specify the format for the Date custom property", "Date Custom Property", defaultDateFormat)\nEnd Function\n\nSub SetDateCustomProperty(model As SldWorks.ModelDoc2, dateFormat As String)\n    \n    Dim dateVal As String\n    dateVal = Format(Now, dateFormat)\n    \n    Dim swCustPrpMgr As SldWorks.CustomPropertyManager\n    \n    Set swCustPrpMgr = model.Extension.CustomPropertyManager(confName)\n    \n    If swCustPrpMgr.Add3(DATE_PRP_NAME, swCustomInfoType_e.swCustomInfoText, dateVal, swCustomPropertyAddOption_e.swCustomPropertyReplaceValue) <> swCustomInfoAddResult_e.swCustomInfoAddResult_AddedOrChanged Then\n        Err.Raise vbError, "", "Failed to add date property"\n    End If\n    \nEnd Sub\n')),(0,r.kt)("p",null,"\u8fd9\u4e2a\u5b8f\u4e5f\u53ef\u4ee5\u5d4c\u5165\u5230\u6a21\u578b\u4e2d\uff0c\u4ee5\u4fbf\u5728\u6bcf\u6b21\u91cd\u5efa\u65f6\u81ea\u52a8\u66f4\u65b0\u65e5\u671f\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Const BASE_NAME As String = "AutoDateCustomProperty"\nConst EMBED As Boolean = False\n\nConst DATE_PRP_NAME As String = "Date"\n\nConst PARAM_DATE_FORMAT As String = "DateFormat"\n\nSub main()\n\n    Dim swApp As SldWorks.SldWorks\n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    \n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n                \n        Dim dateFormat As String\n        dateFormat = GetDateFormat()\n        \n        If dateFormat <> "" Then\n                \n            Dim curMacroPath As String\n            curMacroPath = swApp.GetCurrentMacroPathName\n            Dim vMethods(8) As String\n            Dim moduleName As String\n            \n            GetMacroEntryPoint swApp, curMacroPath, moduleName, ""\n            \n            vMethods(0) = curMacroPath: vMethods(1) = moduleName: vMethods(2) = "swmRebuild"\n            vMethods(3) = curMacroPath: vMethods(4) = moduleName: vMethods(5) = "swmEditDefinition"\n            vMethods(6) = curMacroPath: vMethods(7) = moduleName: vMethods(8) = "swmSecurity"\n            \n            Dim vParamNames(0) As String\n            vParamNames(0) = PARAM_DATE_FORMAT\n    \n            Dim vParamTypes(0) As Long\n            vParamTypes(0) = swMacroFeatureParamType_e.swMacroFeatureParamTypeString\n    \n            Dim vParamValues(0) As String\n    \n            vParamValues(0) = dateFormat\n            \n            Dim opts As swMacroFeatureOptions_e\n            opts = swMacroFeatureOptions_e.swMacroFeatureAlwaysAtEnd\n            \n            If EMBED Then\n                opts = opts + swMacroFeatureOptions_e.swMacroFeatureEmbedMacroFile\n            End If\n            \n            Dim swFeat As SldWorks.Feature\n            Set swFeat = swModel.FeatureManager.InsertMacroFeature3(BASE_NAME, "", vMethods, _\n                vParamNames, vParamTypes, vParamValues, Empty, Empty, Empty, _\n                Empty, opts)\n            \n            If swFeat Is Nothing Then\n                MsgBox "Failed to create auto date feature"\n            End If\n            \n        End If\n        \n    Else\n        MsgBox "Please open model"\n    End If\n    \nEnd Sub\n\nSub GetMacroEntryPoint(app As SldWorks.SldWorks, macroPath As String, ByRef moduleName As String, ByRef procName As String)\n        \n    Dim vMethods As Variant\n    vMethods = app.GetMacroMethods(macroPath, swMacroMethods_e.swMethodsWithoutArguments)\n    \n    Dim i As Integer\n    \n    If Not IsEmpty(vMethods) Then\n    \n        For i = 0 To UBound(vMethods)\n            Dim vData As Variant\n            vData = Split(vMethods(i), ".")\n            \n            If i = 0 Or LCase(vData(1)) = "main" Then\n                moduleName = vData(0)\n                procName = vData(1)\n            End If\n        Next\n        \n    End If\n    \nEnd Sub\n\nFunction GetDateFormat(Optional defaultDateFormat As String = "dd/mm/yyyy") As String\n    GetDateFormat = InputBox("Specify the format for the Date custom property", "Date Custom Property", defaultDateFormat)\nEnd Function\n\nFunction swmRebuild(varApp As Variant, varDoc As Variant, varFeat As Variant) As Variant\n\n    Dim swApp As SldWorks.SldWorks\n    Dim swModel As SldWorks.ModelDoc2\n    Dim swFeat As SldWorks.Feature\n    \n    Set swApp = varApp\n    Set swModel = varDoc\n    Set swFeat = varFeat\n    \n    Dim swMacroFeat As SldWorks.MacroFeatureData\n    Set swMacroFeat = swFeat.GetDefinition()\n    \n    Dim dateFormat As String\n    \n    swMacroFeat.GetStringByName PARAM_DATE_FORMAT, dateFormat\n        \ntry_:\n    On Error GoTo catch_\n    \n    SetDateCustomProperty swModel, dateFormat\n    \n    GoTo finally_\ncatch_:\n    swmRebuild = Err.Description\nfinally_:\n        \nEnd Function\n\nSub SetDateCustomProperty(model As SldWorks.ModelDoc2, dateFormat As String)\n    \n    Dim dateVal As String\n    dateVal = Format(Now, dateFormat)\n    \n    Dim swCustPrpMgr As SldWorks.CustomPropertyManager\n    \n    Set swCustPrpMgr = model.Extension.CustomPropertyManager(confName)\n    \n    If swCustPrpMgr.Add3(DATE_PRP_NAME, swCustomInfoType_e.swCustomInfoText, dateVal, swCustomPropertyAddOption_e.swCustomPropertyReplaceValue) <> swCustomInfoAddResult_e.swCustomInfoAddResult_AddedOrChanged Then\n        Err.Raise vbError, "", "Failed to add date property"\n    End If\n    \nEnd Sub\n\nFunction swmEditDefinition(varApp As Variant, varDoc As Variant, varFeat As Variant) As Variant\n\n    Dim swApp As SldWorks.SldWorks\n    Set swApp = varApp\n\n    Dim swModel As SldWorks.ModelDoc2\n    Dim swFeat As SldWorks.Feature\n    \n    Set swModel = varDoc\n    Set swFeat = varFeat\n    \n    Dim swMacroFeat As SldWorks.MacroFeatureData\n    Set swMacroFeat = swFeat.GetDefinition()\n        \n    Dim dateFormat As String\n    swMacroFeat.GetStringByName PARAM_DATE_FORMAT, dateFormat\n\n    dateFormat = GetDateFormat(dateFormat)\n        \n    If dateFormat <> "" Then\n        \n        swMacroFeat.AccessSelections swModel, Nothing\n        swMacroFeat.SetStringByName PARAM_DATE_FORMAT, dateFormat\n        \n        swFeat.ModifyDefinition swMacroFeat, swModel, Nothing\n        \n    End If\n    \n    swmEditDefinition = True\n    \nEnd Function\n\nFunction swmSecurity(varApp As Variant, varDoc As Variant, varFeat As Variant) As Variant\n    swmSecurity = SwConst.swMacroFeatureSecurityOptions_e.swMacroFeatureSecurityByDefault\nEnd Function\n')))}l.isMDXComponent=!0}}]);