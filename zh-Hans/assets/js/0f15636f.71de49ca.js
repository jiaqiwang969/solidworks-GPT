"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[39290],{3905:(e,n,t)=>{t.d(n,{Zo:()=>g,kt:()=>P});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),l=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},g=function(e){var n=l(e.components);return r.createElement(p.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,g=o(e,["components","mdxType","originalType","parentName"]),c=l(t),u=a,P=c["".concat(p,".").concat(u)]||c[u]||d[u]||i;return t?r.createElement(P,s(s({ref:n},g),{},{components:t})):r.createElement(P,s({ref:n},g))}));function P(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=u;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o[c]="string"==typeof e?e:a,s[1]=o;for(var l=2;l<i;l++)s[l]=t[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},16041:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var r=t(87462),a=(t(67294),t(3905));const i={layout:"sw-tool",image:"printer.svg",group:"Model"},s=void 0,o={unversionedId:"codestack/solidworks-api/document/print/index",id:"codestack/solidworks-api/document/print/index",title:"index",description:"\u6253\u5370\u673a\u548c\u9875\u9762\u8bbe\u7f6e{ width=500 }",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/document/print/index.md",sourceDirName:"codestack/solidworks-api/document/print",slug:"/codestack/solidworks-api/document/print/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/print/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/document/print/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",image:"printer.svg",group:"Model"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS API\u5411\u9009\u5b9a\u7684\u6ce8\u91ca\u6dfb\u52a0\u6807\u7b7e",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/notes/tag-selected-note/"},next:{title:"\u5f3a\u5236\u91cd\u5efaSOLIDWORKS\u6587\u6863\u7684\u5b8f",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/document/rebuild/"}},p={},l=[{value:"\u8bbe\u7f6e",id:"\u8bbe\u7f6e",level:2}],g={toc:l},c="wrapper";function d(e){let{components:n,...i}=e;return(0,a.kt)(c,(0,r.Z)({},g,i,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"\u6253\u5370\u673a\u548c\u9875\u9762\u8bbe\u7f6e",src:t(21080).Z,width:"871",height:"481"}),"{ width=500 }"),(0,a.kt)("p",null,"\u8fd9\u4e2aVBA\u5b8f\u5141\u8bb8\u6253\u5370\u6d3b\u52a8\u7684SOLIDWORKS\u6587\u6863\u3002\u53ef\u4ee5\u6307\u5b9a\u6253\u5370\u7684\u8bbe\u7f6e\uff1a\u6253\u5370\u673a\u540d\u79f0\u3001\u6253\u5370\u8303\u56f4\u3001\u65b9\u5411\u3001\u7eb8\u5f20\u5927\u5c0f\u548c\u6bd4\u4f8b\u3002"),(0,a.kt)("h2",{id:"\u8bbe\u7f6e"},"\u8bbe\u7f6e"),(0,a.kt)("p",null,"\u8981\u914d\u7f6e\u8bbe\u7f6e\uff0c\u8bf7\u6839\u636e\u4e0b\u9762\u7684\u63cf\u8ff0\u66f4\u6539\u5b8f\u9876\u90e8\u7684\u5e38\u91cf\u7684\u503c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Const PRINTER_NAME As String = "Microsoft Print To PDF" \'\u6253\u5370\u673a\u7684\u5b8c\u6574\u540d\u79f0\nConst PRINT_RANGE As String = "1-3,5" \'\u8981\u6253\u5370\u7684\u8303\u56f4\u3002\u6307\u5b9a*\u4ee5\u6253\u5370\u6240\u6709\u9875\u9762\u6216\u8303\u56f4\nConst PRINT_ORIENTATION As Integer = swPageSetupOrientation_e.swPageSetupOrient_Landscape \'\u65b9\u5411\uff1a\u6a2a\u5411\u6216\u7eb5\u5411\nConst PRINTER_PAPER_SIZE As String = "A3" \'\u8981\u6253\u5370\u7684\u7eb8\u5f20\u5927\u5c0f\nConst PRINT_SCALE As String = "*" \'\u6253\u5370\u6bd4\u4f8b\u3002\u4f7f\u7528*\u4ee5\u9002\u5e94\u6bd4\u4f8b\u6216\u6bd4\u4f8b%\u7684\u503c\uff08\u4ece1\u52301000\uff09\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Private Declare PtrSafe Function DeviceCapabilities Lib "winspool.drv" Alias "DeviceCapabilitiesA" (ByVal lpDeviceName As String, ByVal lpPort As String, ByVal iIndex As Long, ByRef lpOutput As Any, ByRef lpDevMode As Any) As Long\n\nDim swApp As SldWorks.SldWorks\n\nConst PRINTER_NAME As String = "Microsoft Print To PDF"\nConst PRINT_RANGE As String = "1-3,5"\nConst PRINT_ORIENTATION As Integer = swPageSetupOrientation_e.swPageSetupOrient_Landscape\nConst PRINTER_PAPER_SIZE As String = "A3"\nConst PRINT_SCALE As String = "*"\n\nSub main()\n    \n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    \n    Set swModel = swApp.ActiveDoc\n    \n    If swModel Is Nothing Then\n        Err.Raise vbError, "", "\u8bf7\u6253\u5f00\u6587\u6863"\n    End If\n    \n    Dim swPageSetup As SldWorks.PageSetup\n    \n    Set swPageSetup = swModel.PageSetup\n    \n    Dim origPrinter As String\n    Dim origPrinterPaperSize As Integer\n    Dim origScaleToFit As Boolean\n    Dim origScale As Double\n    Dim origOrientation As Integer\n    Dim origUsePageSetup As Integer\n    \n    origPrinter = swModel.Printer\n    origPrinterPaperSize = swPageSetup.PrinterPaperSize\n    origScaleToFit = swPageSetup.ScaleToFit\n    origScale = swPageSetup.Scale2\n    origOrientation = swPageSetup.Orientation\n    origUsePageSetup = swModel.Extension.UsePageSetup\n    \n    swModel.Printer = PRINTER_NAME\n    swPageSetup.PrinterPaperSize = GetPaper(PRINTER_NAME, PRINTER_PAPER_SIZE)\n    \n    If PRINT_SCALE = "*" Then\n        swPageSetup.ScaleToFit = True\n    Else\n        swPageSetup.ScaleToFit = False\n        swPageSetup.Scale2 = CDbl(PRINT_SCALE)\n    End If\n    \n    swPageSetup.Orientation = PRINT_ORIENTATION\n    \n    swModel.Extension.UsePageSetup = swPageSetupInUse_e.swPageSetupInUse_Document\n    \n    Dim swPrintSpec As SldWorks.PrintSpecification\n    Set swPrintSpec = swModel.Extension.GetPrintSpecification\n    \n    swPrintSpec.printRange = GetPrintRange(PRINT_RANGE)\n        \n    swModel.Extension.PrintOut4 PRINTER_NAME, "", swPrintSpec\n    \n    swModel.Printer = origPrinter\n    swPageSetup.PrinterPaperSize = origPrinterPaperSize\n    swPageSetup.ScaleToFit = origScaleToFit\n    swPageSetup.Scale2 = origScale\n    swPageSetup.Orientation = origOrientation\n    swModel.Extension.UsePageSetup = origUsePageSetup\n    \nEnd Sub\n\nFunction GetPrintRange(range As String) As Variant\n    \n    Dim printRange() As Long\n    \n    If range = "*" Then\n        ReDim printRange(1)\n        printRange(0) = -1\n        printRange(1) = -1\n    Else\n        \n        Dim vPageRanges As Variant\n        vPageRanges = Split(range, ",")\n        \n        ReDim printRange((UBound(vPageRanges) + 1) * 2 - 1)\n        \n        Dim i As Integer\n        \n        For i = 0 To UBound(vPageRanges)\n            \n            Dim vStartEndPages As Variant\n            vStartEndPages = Split(Trim(CStr(vPageRanges(i))), "-")\n            \n            Dim startPage As Long\n            Dim endPage As Long\n            startPage = CLng(vStartEndPages(0))\n            \n            If UBound(vStartEndPages) = 0 Then\n                endPage = startPage\n            ElseIf UBound(vStartEndPages) = 1 Then\n                endPage = CLng(vStartEndPages(1))\n            Else\n                Err.Raise vbError, "", "\u65e0\u6548\u7684\u9875\u9762\u8303\u56f4\uff1a" & CStr(vPageRanges(i))\n            End If\n            \n            printRange(i * 2) = startPage\n            printRange(i * 2 + 1) = endPage\n            \n        Next\n        \n    End If\n        \n    GetPrintRange = printRange\n    \nEnd Function\n\nFunction GetPaper(printerName As String, paperName As String) As Integer\n    \n    Const DC_PAPERNAMES As Integer = &H10\n    Const DC_PAPERS As Integer = &H2\n    \n    Dim papersCount As Integer\n    papersCount = DeviceCapabilities(printerName, "", DC_PAPERS, ByVal vbNullString, 0)\n    \n    If papersCount > 0 Then\n    \n        Dim papersCodes() As Integer\n        ReDim papersCodes(papersCount - 1)\n        \n        DeviceCapabilities printerName, "", DC_PAPERS, papersCodes(0), 0\n        \n        Dim papersNames As String\n        papersNames = String$(64 * papersCount, 0)\n        DeviceCapabilities printerName, "", DC_PAPERNAMES, ByVal papersNames, 0\n      \n        Dim i As Integer\n        \n        For i = 0 To papersCount\n            If LCase(ParsePaperName(papersNames, 64 * i + 1)) = LCase(paperName) Then\n                GetPaper = papersCodes(i)\n            End If\n        Next\n    Else\n        Err.Raise vbError, "", "\u6307\u5b9a\u7684\u6253\u5370\u673a\u6ca1\u6709\u53ef\u7528\u7684\u7eb8\u5f20\u5927\u5c0f"\n    End If\n    \nEnd Function\n\nFunction ParsePaperName(papersNames As String, offset As Integer) As String\n\n    Dim paperName As String\n    \n    paperName = Mid(papersNames, offset, 64)\n    \n    Dim nullCharIndex As Integer\n    nullCharIndex = InStr(paperName, vbNullChar)\n    \n    If nullCharIndex <> 0 Then\n        paperName = Left$(paperName, nullCharIndex - 1)\n    End If\n     \n    ParsePaperName = paperName\n    \nEnd Function\n')))}d.isMDXComponent=!0},21080:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/page-setup-ce87176b7d3d2af95bb792a6010f0cb8.png"}}]);