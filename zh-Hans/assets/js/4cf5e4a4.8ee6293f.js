"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[69807],{3905:(e,n,a)=>{a.d(n,{Zo:()=>g,kt:()=>u});var t=a(67294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function o(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?o(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=t.createContext({}),p=function(e){var n=t.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},g=function(e){var n=p(e.components);return t.createElement(i.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},P=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),d=p(a),P=r,u=d["".concat(i,".").concat(P)]||d[P]||c[P]||o;return a?t.createElement(u,s(s({ref:n},g),{},{components:a})):t.createElement(u,s({ref:n},g))}));function u(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=P;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[d]="string"==typeof e?e:r,s[1]=l;for(var p=2;p<o;p++)s[p]=a[p];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}P.displayName="MDXCreateElement"},17111:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var t=a(87462),r=(a(67294),a(3905));const o={title:"SOLIDWORKS Property Manager Page closing events handling",caption:"Closing",description:"Overview of events associated with closing of SOLIDWORKS property manager page handled in SwEx.PMPage framework","toc-group-name":"labs-solidworks-swex",sidebar_position:0},s=void 0,l={unversionedId:"codestack/labs/solidworks/swex/pmpage/events/closing/index",id:"codestack/labs/solidworks/swex/pmpage/events/closing/index",title:"SOLIDWORKS Property Manager Page closing events handling",description:"Overview of events associated with closing of SOLIDWORKS property manager page handled in SwEx.PMPage framework",source:"@site/docs/codestack/labs/solidworks/swex/pmpage/events/closing/index.md",sourceDirName:"codestack/labs/solidworks/swex/pmpage/events/closing",slug:"/codestack/labs/solidworks/swex/pmpage/events/closing/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/pmpage/events/closing/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/labs/solidworks/swex/pmpage/events/closing/index.md",tags:[],version:"current",sidebarPosition:0,frontMatter:{title:"SOLIDWORKS Property Manager Page closing events handling",caption:"Closing",description:"Overview of events associated with closing of SOLIDWORKS property manager page handled in SwEx.PMPage framework","toc-group-name":"labs-solidworks-swex",sidebar_position:0},sidebar:"tutorialSidebar",previous:{title:"Handling events of SOLIDWORKS property manager page",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/pmpage/events/"},next:{title:"SOLIDWORKS Property Manager Page data changed events handling",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/pmpage/events/data-changed/"}},i={},p=[{value:"Pre Closing event",id:"pre-closing-event",level:2},{value:"Post closing event",id:"post-closing-event",level:2}],g={toc:p},d="wrapper";function c(e){let{components:n,...a}=e;return(0,r.kt)(d,(0,t.Z)({},g,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"pre-closing-event"},"Pre Closing event"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/pmpage/html/E_CodeStack_SwEx_PMPage_PropertyManagerPageHandlerEx_Closing.htm"},"PropertyManagerPageHandlerEx::Closing")," event is raised when property manager page is about to be closed."),(0,r.kt)("p",null,"Framework passes the reason of close and ",(0,r.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/pmpage/html/T_CodeStack_SwEx_PMPage_Base_ClosingArg.htm"},"closing argument")," which allows to cancel property manager page closing and display error to the user as a tooltip."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Public Class DataModel\n    Public Property Text As String\nEnd Class\n\nPrivate m_Data As DataModel\nPrivate m_Page As PropertyManagerPageEx(Of MyPMPageHandler, DataModel)\n\nPublic Overrides Function OnConnect() As Boolean\n    m_Data = New DataModel\n    m_Page = New PropertyManagerPageEx(Of MyPMPageHandler, DataModel)(App)\n\n    AddHandler m_Page.Handler.Closing, AddressOf OnClosing\n    Return True\nEnd Function\n\nPrivate Sub OnClosing(ByVal reason As swPropertyManagerPageCloseReasons_e, ByVal arg As ClosingArg)\n    If reason = swPropertyManagerPageCloseReasons_e.swPropertyManagerPageClose_Okay Then\n\n        If String.IsNullOrEmpty(m_Data.Text) Then\n            arg.Cancel = True\n            arg.ErrorTitle = "Insert Note Error"\n            arg.ErrorMessage = "Please specify the note text"\n        End If\n    End If\nEnd Sub\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'public class DataModel\n{\n    public string Text { get; set; }\n}\n\nprivate DataModel m_Data;\n\nprivate PropertyManagerPageEx<MyPMPageHandler, DataModel> m_Page;\n\npublic override bool OnConnect()\n{\n    m_Data = new DataModel();\n    m_Page = new PropertyManagerPageEx<MyPMPageHandler, DataModel>(App);\n\n    m_Page.Handler.Closing += OnClosing;\n\n    return true;\n}\n\nprivate void OnClosing(swPropertyManagerPageCloseReasons_e reason, ClosingArg arg)\n{\n    if (reason == swPropertyManagerPageCloseReasons_e.swPropertyManagerPageClose_Okay)\n    {\n        if (string.IsNullOrEmpty(m_Data.Text))\n        {\n            arg.Cancel = true;\n            arg.ErrorTitle = "Insert Note Error";\n            arg.ErrorMessage = "Please specify the note text";\n        }\n    }\n}\n')),(0,r.kt)("p",null,"This event is raised when Property Manager Page dialog is still visible. There should be no rebuild operations performed within this handler, it includes the direct rebuilds but also any new features or geometry creation or modification (with an exception of temp bodies). Note that some operations such as saving may also be unsupported. In general if certain operation cannot be performed from the user interface while property page is opened it shouldn't be called from the closing event via API as well. Otherwise this could cause instability including crashes. Use ",(0,r.kt)("a",{parentName:"p",href:"#post-closing-event"},"Post closing event")," event to perform any rebuild operations."),(0,r.kt)("p",null,"In some cases it is required to perform this operation while property manager page stays open. Usually this happens when page supports pining (swPropertyManagerOptions_PushpinButton flag of ",(0,r.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2016/english/api/swconst/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swPropertyManagerPageOptions_e.html"},"swPropertyManagerPageOptions_e")," enumeration in ",(0,r.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/pmpage/html/T_CodeStack_SwEx_PMPage_Attributes_PageOptionsAttribute.htm"},"PageOptionsAttribute"),"). In this case it is required to set the swPropertyManagerOptions_LockedPage flag of ",(0,r.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2016/english/api/swconst/SOLIDWORKS.Interop.swconst~SOLIDWORKS.Interop.swconst.swPropertyManagerPageOptions_e.html"},"swPropertyManagerPageOptions_e")," enumeration in ",(0,r.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/pmpage/html/T_CodeStack_SwEx_PMPage_Attributes_PageOptionsAttribute.htm"},"PageOptionsAttribute"),". This would enable the support of rebuild operations and feature creation from within the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/pmpage/html/E_CodeStack_SwEx_PMPage_PropertyManagerPageHandlerEx_Closing.htm"},"PropertyManagerPageHandlerEx::Closing")," event."),(0,r.kt)("h2",{id:"post-closing-event"},"Post closing event"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/pmpage/html/E_CodeStack_SwEx_PMPage_PropertyManagerPageHandlerEx_Closed.htm"},"PropertyManagerPageHandlerEx::Closed")," event is raised when property manager page is closed."),(0,r.kt)("p",null,"Use this handler to perform the required operations."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},"Public Class DataModel\n    Public Property Text As String\nEnd Class\n\nPrivate m_Data As DataModel\nPrivate m_Page As PropertyManagerPageEx(Of MyPMPageHandler, DataModel)\n\nPublic Overrides Function OnConnect() As Boolean\n    m_Data = New DataModel\n    m_Page = New PropertyManagerPageEx(Of MyPMPageHandler, DataModel)(App)\n\n    AddHandler m_Page.Handler.Closed, AddressOf OnClosed\n    Return True\nEnd Function\n\nPrivate Sub OnClosed(ByVal reason As swPropertyManagerPageCloseReasons_e)\n    If reason = swPropertyManagerPageCloseReasons_e.swPropertyManagerPageClose_Okay Then\n        'TODO: do work\n    Else\n        'TODO: release resources\n    End If\nEnd Sub\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"public class DataModel\n{\n    public string Text { get; set; }\n}\n\nprivate DataModel m_Data;\n\nprivate PropertyManagerPageEx<MyPMPageHandler, DataModel> m_Page;\n\npublic override bool OnConnect()\n{\n    m_Data = new DataModel();\n    m_Page = new PropertyManagerPageEx<MyPMPageHandler, DataModel>(App);\n\n    m_Page.Handler.Closed += OnClosed;\n\n    return true;\n}\n\nprivate void OnClosed(swPropertyManagerPageCloseReasons_e reason)\n{\n    if (reason == swPropertyManagerPageCloseReasons_e.swPropertyManagerPageClose_Okay)\n    {\n        //TODO: do work\n    }\n    else\n    {\n        //TODO: release resources\n    }\n}\n")))}c.isMDXComponent=!0}}]);