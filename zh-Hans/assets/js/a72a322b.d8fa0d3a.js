"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[64391],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var o=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=o.createContext({}),c=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=c(e.components);return o.createElement(l.Provider,{value:n},e.children)},d="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},p=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(t),p=a,m=d["".concat(l,".").concat(p)]||d[p]||g[p]||r;return t?o.createElement(m,i(i({ref:n},u),{},{components:t})):o.createElement(m,i({ref:n},u))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=p;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[d]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=t[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}p.displayName="MDXCreateElement"},75733:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var o=t(87462),a=(t(67294),t(3905));const r={title:"Change value of global variable in model using SOLIDWORKS API",image:"equation-manager-global-variable.png",labels:["equation","variable"]},i=void 0,s={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-global-variable-value/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-global-variable-value/index",title:"Change value of global variable in model using SOLIDWORKS API",description:"Equation Manager with Global Variable",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-global-variable-value/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-global-variable-value",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-global-variable-value/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-global-variable-value/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-global-variable-value/index.md",tags:[],version:"current",frontMatter:{title:"Change value of global variable in model using SOLIDWORKS API",image:"equation-manager-global-variable.png",labels:["equation","variable"]},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS API\u66f4\u6539\u6750\u6599\u4e2d\u7684\u5e94\u7528\u5916\u89c2\u9009\u9879",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-apply-appearance/"},next:{title:"\u4f7f\u7528SOLIDWORKS API\u5728\u7ed8\u56fe\u4e2d\u66f4\u6539\u6240\u9009\u5bf9\u8c61\u7684\u56fe\u5c42\u7684SOLIDWORKS\u5b8f",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/change-layer-selected-drawing-objects/"}},l={},c=[],u={toc:c},d="wrapper";function g(e){let{components:n,...r}=e;return(0,a.kt)(d,(0,o.Z)({},u,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Equation Manager with Global Variable",src:t(59522).Z,width:"1019",height:"288"})),(0,a.kt)("p",null,"This example demonstrates how to modify the value of the named global variable in the equation manager using SOLIDWORKS API."),(0,a.kt)("p",null,"Change the name of the variable and the value constants in the head of the macro."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Const VAR_NAME As String = "Factor"\nConst NEW_VALUE As Double = 0.75\n\nDim swApp As SldWorks.SldWorks\nDim swModel As SldWorks.ModelDoc2\n\nSub main()\n\n    Set swApp = Application.SldWorks\n\n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n    \n        Dim swEqMgr As SldWorks.EquationMgr\n        \n        Set swEqMgr = swModel.GetEquationMgr\n        \n        If SetEquationValue(swEqMgr, VAR_NAME, NEW_VALUE) Then\n            swModel.ForceRebuild3 True\n        Else\n            MsgBox "Failed to find the equation " & name\n        End If\n    \n    Else\n        MsgBox "Please open the model"\n    End If\n    \nEnd Sub\n\nFunction SetEquationValue(eqMgr As SldWorks.EquationMgr, name As String, value As Double) As Boolean\n    \n    Dim index As Integer\n    index = GetEquationIndexByName(eqMgr, name)\n    \n    If index <> -1 Then\n        eqMgr.Equation(index) = """" & name & """=" & NEW_VALUE\n        SetEquationValue = True\n    Else\n        SetEquationValue = False\n    End If\n        \nEnd Function\n\nFunction GetEquationIndexByName(eqMgr As SldWorks.EquationMgr, name As String) As Integer\n    \n    Dim i As Integer\n        \n    GetEquationIndexByName = -1\n        \n    For i = 0 To eqMgr.GetCount - 1\n        \n        Dim eqName As String\n        eqName = Trim(Split(eqMgr.Equation(i), "=")(0))\n        eqName = Mid(eqName, 2, Len(eqName) - 2) \'removing the "" symbols from the name\n        \n        If UCase(eqName) = UCase(VAR_NAME) Then\n            GetEquationIndexByName = i\n            Exit Function\n        End If\n    Next\n    \nEnd Function\n')))}g.isMDXComponent=!0},59522:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/equation-manager-global-variable-72908f7f723612888a633dabf72dc14e.png"}}]);