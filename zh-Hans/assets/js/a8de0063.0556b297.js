"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[95974],{3905:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>f});var o=t(67294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,o,s=function(e,n){if(null==e)return{};var t,o,s={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var m=o.createContext({}),c=function(e){var n=o.useContext(m),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},l=function(e){var n=c(e.components);return o.createElement(m.Provider,{value:n},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,s=e.mdxType,r=e.originalType,m=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),p=c(t),d=s,f=p["".concat(m,".").concat(d)]||p[d]||u[d]||r;return t?o.createElement(f,a(a({ref:n},l),{},{components:t})):o.createElement(f,a({ref:n},l))}));function f(e,n){var t=arguments,s=n&&n.mdxType;if("string"==typeof e||s){var r=t.length,a=new Array(r);a[0]=d;var i={};for(var m in n)hasOwnProperty.call(n,m)&&(i[m]=n[m]);i.originalType=e,i[p]="string"==typeof e?e:s,a[1]=i;for(var c=2;c<r;c++)a[c]=t[c];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},59794:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>m,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=t(87462),s=(t(67294),t(3905));const r={title:"Renaming permanent and virtual components using SOLIDWORKS API",image:"component-name.png",labels:["assembly","component","name"]},a=void 0,i={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/rename/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/rename/index",title:"Renaming permanent and virtual components using SOLIDWORKS API",description:"IComponent2::Name2 SOLIDWORKS API property provides get and set accessors for reading and changing the component name respectively.",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/rename/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/rename",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/rename/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/rename/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/rename/index.md",tags:[],version:"current",frontMatter:{title:"Renaming permanent and virtual components using SOLIDWORKS API",image:"component-name.png",labels:["assembly","component","name"]},sidebar:"tutorialSidebar",previous:{title:"Purge components configurations (remove all unused configurations) from SOLIDWORKS assembly",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/purge-configurations/"},next:{title:"Replace components preserving selection using SOLIDWORKS API",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/replace/"}},m={},c=[],l={toc:c},p="wrapper";function u(e){let{components:n,...r}=e;return(0,s.kt)(p,(0,o.Z)({},l,r,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.icomponent2~name2.html"},"IComponent2::Name2")," SOLIDWORKS API property provides get and set accessors for reading and changing the component name respectively."),(0,s.kt)("p",null,"This function returns different names structures when setting or getting. That means if it is required to rename component using its original name (i.e. add suffix or prefix) value returned from get-accessor needs to be altered."),(0,s.kt)("p",null,"When ",(0,s.kt)("strong",{parentName:"p"},"get")," accessor is called full name of the component is returned, while ",(0,s.kt)("strong",{parentName:"p"},"set")," accessor only requires short name."),(0,s.kt)("p",null,"Full name of the component consists of"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Component Name"),(0,s.kt)("li",{parentName:"ul"},"Component Index (specified after ",(0,s.kt)("strong",{parentName:"li"},"-")," symbol in full name)"),(0,s.kt)("li",{parentName:"ul"},"Context name for virtual component (specified after ",(0,s.kt)("strong",{parentName:"li"},"^")," symbol in the full name)"),(0,s.kt)("li",{parentName:"ul"},"Parent assembly full name (specified before ",(0,s.kt)("strong",{parentName:"li"},"/")," symbol in the full name)")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Components in the feature tree",src:t(60036).Z,width:"337",height:"555"})),(0,s.kt)("p",null,"The names of the components in the structure above will be returned as the following (the colors in the picture match the parts in names)"),(0,s.kt)("p",null,"Assem2-1 ",(0,s.kt)("em",{parentName:"p"},"Root component")),(0,s.kt)("p",null,"Assem2-1/Part1-1 ",(0,s.kt)("em",{parentName:"p"},"Component in sub-assembly")),(0,s.kt)("p",null,"Assem2-1/Part2^Assem2-1  ",(0,s.kt)("em",{parentName:"p"},"virtual component in sub-assembly")),(0,s.kt)("p",null,"Example below renames any selected component (root level, component in sub-assembly and virtual) using SOLIDWORKS API by adding the suffix to its name."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-vb"},'Const SUFFIX As String = "_Renamed"\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n    \n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    Dim swSelMgr As SldWorks.SelectionMgr\n\n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n    \n        Set swSelMgr = swModel.SelectionManager\n        \n        Dim swComp As SldWorks.Component2\n        \n        Set swComp = swSelMgr.GetSelectedObject6(1, -1)\n        \n        If Not swComp Is Nothing Then\n        \n            Dim compName As String\n            \n            compName = swComp.Name2\n            \n            If Not swComp.GetParent() Is Nothing Then\n                \'if not root remove the sub-assemblies name\n                compName = Right(compName, Len(compName) - InStrRev(compName, "/"))\n            End If\n            \n            If swComp.IsVirtual() Then\n                \'if virtual remove the context assembly name\n                compName = Left(compName, InStr(compName, "^") - 1)\n            Else\n                \'remove the index name\n                compName = Left(compName, InStrRev(compName, "-") - 1)\n            End If\n            \n            Dim newCompName As String\n            newCompName = compName & SUFFIX\n            \n            swComp.Name2 = newCompName\n            \n        Else\n            MsgBox "Please select component to rename"\n        End If\n    \n    Else\n        MsgBox "Please open assembly document"\n    End If\n    \nEnd Sub\n')))}u.isMDXComponent=!0},60036:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/component-name-324a91644b1489234785acea9e1e8e38.png"}}]);