"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[95427],{3905:(e,n,r)=>{r.d(n,{Zo:()=>p,kt:()=>g});var t=r(67294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=t.createContext({}),m=function(e){var n=t.useContext(c),r=n;return e&&(r="function"==typeof e?e(n):s(s({},n),e)),r},p=function(e){var n=m(e.components);return t.createElement(c.Provider,{value:n},e.children)},l="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),l=m(r),d=a,g=l["".concat(c,".").concat(d)]||l[d]||u[d]||o;return r?t.createElement(g,s(s({ref:n},p),{},{components:r})):t.createElement(g,s({ref:n},p))}));function g(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=d;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i[l]="string"==typeof e?e:a,s[1]=i;for(var m=2;m<o;m++)s[m]=r[m];return t.createElement.apply(null,s)}return t.createElement.apply(null,r)}d.displayName="MDXCreateElement"},77458:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>m});var t=r(87462),a=(r(67294),r(3905));const o={image:"mass-properties-table.png"},s=void 0,i={unversionedId:"codestack/solidworks-document-manager-api/document/get-mass-properties/index",id:"codestack/solidworks-document-manager-api/document/get-mass-properties/index",title:"index",description:"\u8fd9\u4e2aC#\u4ee3\u7801\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528SOLIDWORKS\u6587\u6863\u7ba1\u7406\u5668API\u4ece\u8f93\u5165\u76ee\u5f55\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u914d\u7f6e\u4e2d\u63d0\u53d6\u8d28\u91cf\u5c5e\u6027\u3002",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-document-manager-api/document/get-mass-properties/index.md",sourceDirName:"codestack/solidworks-document-manager-api/document/get-mass-properties",slug:"/codestack/solidworks-document-manager-api/document/get-mass-properties/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-document-manager-api/document/get-mass-properties/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-document-manager-api/document/get-mass-properties/index.md",tags:[],version:"current",frontMatter:{image:"mass-properties-table.png"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS\u6587\u6863\u7ba1\u7406\u5668API\u83b7\u53d6\u6587\u6863\u7684\u6240\u6709\u5916\u90e8\u5f15\u7528",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-document-manager-api/document/get-external-references/"},next:{title:"\u4f7f\u7528 SOLIDWORKS Document Manager API \u4ece\u6d3b\u52a8\u914d\u7f6e\u4e2d\u63d0\u53d6 PNG \u9884\u89c8\u56fe\u50cf",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-document-manager-api/document/get-preview/"}},c={},m=[],p={toc:m},l="wrapper";function u(e){let{components:n,...o}=e;return(0,a.kt)(l,(0,t.Z)({},p,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u8fd9\u4e2aC#\u4ee3\u7801\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528SOLIDWORKS\u6587\u6863\u7ba1\u7406\u5668API\u4ece\u8f93\u5165\u76ee\u5f55\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u914d\u7f6e\u4e2d\u63d0\u53d6\u8d28\u91cf\u5c5e\u6027\u3002"),(0,a.kt)("p",null,"\u7ed3\u679c\u5c06\u8f93\u51fa\u5230\u6307\u5b9a\u7684CSV\u6587\u4ef6\u4e2d\uff0c\u5305\u542b\u4ee5\u4e0b\u5217\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6587\u4ef6\u8def\u5f84"),(0,a.kt)("li",{parentName:"ul"},"\u914d\u7f6e\u540d\u79f0"),(0,a.kt)("li",{parentName:"ul"},"\u8d28\u5fc3\u7684X\u5750\u6807\uff08\u7c73\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u8d28\u5fc3\u7684Y\u5750\u6807\uff08\u7c73\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u8d28\u5fc3\u7684Z\u5750\u6807\uff08\u7c73\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u4f53\u79ef\uff08\u7acb\u65b9\u7c73\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u8868\u9762\u79ef\uff08\u5e73\u65b9\u7c73\uff09"),(0,a.kt)("li",{parentName:"ul"},"\u8d28\u91cf\uff08\u5343\u514b\uff09"),(0,a.kt)("li",{parentName:"ul"},"XX\u8f6c\u52a8\u60ef\u91cf\uff08\u5343\u514b\xb7\u7c73^2\uff09"),(0,a.kt)("li",{parentName:"ul"},"YY\u8f6c\u52a8\u60ef\u91cf\uff08\u5343\u514b\xb7\u7c73^2\uff09"),(0,a.kt)("li",{parentName:"ul"},"ZZ\u8f6c\u52a8\u60ef\u91cf\uff08\u5343\u514b\xb7\u7c73^2\uff09"),(0,a.kt)("li",{parentName:"ul"},"XY\u8f6c\u52a8\u60ef\u91cf\uff08\u5343\u514b\xb7\u7c73^2\uff09"),(0,a.kt)("li",{parentName:"ul"},"ZX\u8f6c\u52a8\u60ef\u91cf\uff08\u5343\u514b\xb7\u7c73^2\uff09"),(0,a.kt)("li",{parentName:"ul"},"YZ\u8f6c\u52a8\u60ef\u91cf\uff08\u5343\u514b\xb7\u7c73^2\uff09")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5982\u679c\u63d0\u53d6\u5c5e\u6027\u65f6\u51fa\u73b0\u4efb\u4f55\u9519\u8bef\uff0c\u5c06\u8f93\u51fa\u5230CSV\u6587\u4ef6\u4e2d")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"CSV\u6587\u4ef6\u4e2d\u7684\u8d28\u91cf\u5c5e\u6027",src:r(26696).Z,width:"1166",height:"458"})),(0,a.kt)("p",null,"\u9700\u8981\u6307\u5b9a3\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\uff1a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u8f93\u5165\u76ee\u5f55\u7684\u5b8c\u6574\u8def\u5f84"),(0,a.kt)("li",{parentName:"ol"},"\u6587\u4ef6\u8fc7\u6ee4\u5668"),(0,a.kt)("li",{parentName:"ol"},"\u8f93\u51faCSV\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'> export-mass-props.exe "D:\\Input Folder" *.sldprt D:\\mass-prps.csv\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},'using SolidWorks.Interop.swdocumentmgr;\nusing System;\nusing System.IO;\nusing System.Linq;\n\nnamespace ExtractMassProperties\n{\n    class Program\n    {\n        private const string LICENSE_KEY = "{YOUR DOCUMENT MANAGER LICENSE KEY}";\n\n        static void Main(string[] args)\n        {\n            var dirPath = args[0];\n            var filter = args[1];\n            var outCsvFilePath = args[2];\n\n            var classFact = new SwDMClassFactory();\n\n            var app = classFact.GetApplication(LICENSE_KEY);\n\n            using (var csvFileWriter = File.CreateText(outCsvFilePath))\n            {\n                csvFileWriter.WriteLine("\u6587\u4ef6\u8def\u5f84, \u914d\u7f6e\u540d\u79f0, X, Y, Z, \u4f53\u79ef, \u8868\u9762\u79ef, \u8d28\u91cf, XX, YY, ZZ, XY, ZX, YZ");\n\n                foreach (var filePath in Directory.GetFiles(dirPath, filter, SearchOption.AllDirectories))\n                {\n                    try\n                    {\n                        ProcessFile(app, filePath, csvFileWriter);\n                    }\n                    catch (Exception ex)\n                    {\n                        csvFileWriter.WriteLine($"\\"{filePath}\\",,{ex.Message}");\n                    }\n                }\n            }\n        }\n\n        private static void ProcessFile(SwDMApplication app, string filePath, StreamWriter csvFileWriter)\n        {\n            var docType = SwDmDocumentType.swDmDocumentUnknown;\n\n            switch (Path.GetExtension(filePath).ToLower())\n            {\n                case ".sldprt":\n                    docType = SwDmDocumentType.swDmDocumentPart;\n                    break;\n\n                case ".sldasm":\n                    docType = SwDmDocumentType.swDmDocumentAssembly;\n                    break;\n\n                case ".slddrw":\n                    docType = SwDmDocumentType.swDmDocumentDrawing;\n                    break;\n            }\n\n            SwDmDocumentOpenError err;\n            var doc = app.GetDocument(filePath, docType, true, out err);\n\n            if (doc != null)\n            {\n                var confNames = (string[])doc.ConfigurationManager.GetConfigurationNames();\n\n                if (confNames?.Any() == true)\n                {\n                    foreach (var confName in confNames)\n                    {\n                        try\n                        {\n                            ProcessConfiguration(doc, confName, csvFileWriter);\n                        }\n                        catch (Exception ex)\n                        {\n                            csvFileWriter.WriteLine($"\\"{filePath}\\",\\"{confName}\\",{ex.Message}");\n                        }\n                    }\n                }\n                else\n                {\n                    throw new Exception("\u672a\u627e\u5230\u914d\u7f6e");\n                }\n            }\n            else\n            {\n                throw new Exception($"\u65e0\u6cd5\u6253\u5f00\u6587\u6863\uff1a{err}");\n            }\n        }\n\n        private static void ProcessConfiguration(SwDMDocument doc, string confName, StreamWriter csvFileWriter)\n        {\n            var conf = doc.ConfigurationManager.GetConfigurationByName(confName);\n\n            var massPrps = (double[])conf.GetMassProperties(out SwDmMassPropError massPrpsErr);\n\n            if (massPrpsErr != SwDmMassPropError.swDmMassPropErrorNone)\n            {\n                throw new Exception($"\u63d0\u53d6\u8d28\u91cf\u5c5e\u6027\u5931\u8d25\uff1a{massPrpsErr}");\n            }\n\n            var cogX = massPrps[0];\n            var cogY = massPrps[1];\n            var cogZ = massPrps[2];\n            var volume = massPrps[3];\n            var surfArea = massPrps[4];\n            var mass = massPrps[5];\n            var momXX = massPrps[6];\n            var momYY = massPrps[7];\n            var momZZ = massPrps[8];\n            var momXY = massPrps[9];\n            var momZX = massPrps[10];\n            var momYZ = massPrps[11];\n\n            csvFileWriter.WriteLine($"\\"{doc.FullName}\\",\\"{confName}\\",{cogX},{cogY},{cogZ},{volume},{surfArea},{mass},{momXX},{momYY},{momZZ},{momXY},{momZX},{momYZ}");\n        }\n    }\n}\n\n')))}u.isMDXComponent=!0},26696:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/mass-properties-table-44223706900e8d4e314ab1c4d7efe837.png"}}]);