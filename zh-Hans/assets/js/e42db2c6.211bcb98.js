"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[93050],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var a=r.createContext({}),c=function(e){var t=r.useContext(a),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(a.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,i=e.originalType,a=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),f=s,m=d["".concat(a,".").concat(f)]||d[f]||p[f]||i;return n?r.createElement(m,o(o({ref:t},u),{},{components:n})):r.createElement(m,o({ref:t},u))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var i=n.length,o=new Array(i);o[0]=f;var l={};for(var a in t)hasOwnProperty.call(t,a)&&(l[a]=t[a]);l.originalType=e,l[d]="string"==typeof e?e:s,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},39770:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var r=n(87462),s=(n(67294),n(3905));const i={title:"\u4f7f\u7528 Visual Basic 6 (VBA) \u4ece\u6587\u4ef6\u5939\u83b7\u53d6\u6587\u4ef6\u8def\u5f84",caption:"\u4ece\u6587\u4ef6\u5939\u83b7\u53d6\u6587\u4ef6"},o=void 0,l={unversionedId:"codestack/visual-basic/algorithms/fso/get-files/index",id:"codestack/visual-basic/algorithms/fso/get-files/index",title:"\u4f7f\u7528 Visual Basic 6 (VBA) \u4ece\u6587\u4ef6\u5939\u83b7\u53d6\u6587\u4ef6\u8def\u5f84",description:"\u4f7f\u7528 Visual Basic 6 (VBA) \u7f16\u5199\u7684\u51fd\u6570\uff0c\u7528\u4e8e\u83b7\u53d6\u6307\u5b9a\u6587\u4ef6\u5939\u4e2d\u6240\u6709\u6587\u4ef6\u7684\u5217\u8868\uff0c\u5e76\u63d0\u4f9b\u904d\u5386\u5b50\u76ee\u5f55\u548c\u6307\u5b9a\u6587\u4ef6\u6269\u5c55\u540d\u7684\u9009\u9879\u3002",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/visual-basic/algorithms/fso/get-files/index.md",sourceDirName:"codestack/visual-basic/algorithms/fso/get-files",slug:"/codestack/visual-basic/algorithms/fso/get-files/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/visual-basic/algorithms/fso/get-files/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/visual-basic/algorithms/fso/get-files/index.md",tags:[],version:"current",frontMatter:{title:"\u4f7f\u7528 Visual Basic 6 (VBA) \u4ece\u6587\u4ef6\u5939\u83b7\u53d6\u6587\u4ef6\u8def\u5f84",caption:"\u4ece\u6587\u4ef6\u5939\u83b7\u53d6\u6587\u4ef6"},sidebar:"tutorialSidebar",previous:{title:"\u5728VBA\u5b8f\u4e2d\u6d4f\u89c8\u6587\u4ef6\u5939",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/visual-basic/algorithms/fso/browse-folder/"},next:{title:"Visual Basic (VBA) \u4e2d\u7684\u8f93\u5165\u548c\u8f93\u51fa (I/O) \u5904\u7406",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/visual-basic/algorithms/fso/io/"}},a={},c=[{value:"labels: \u6587\u4ef6,\u6269\u5c55\u540d,\u904d\u5386,\u9012\u5f52",id:"labels-\u6587\u4ef6\u6269\u5c55\u540d\u904d\u5386\u9012\u5f52",level:2}],u={toc:c},d="wrapper";function p(e){let{components:t,...n}=e;return(0,s.kt)(d,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"\u4f7f\u7528 Visual Basic 6 (VBA) \u7f16\u5199\u7684\u51fd\u6570\uff0c\u7528\u4e8e\u83b7\u53d6\u6307\u5b9a\u6587\u4ef6\u5939\u4e2d\u6240\u6709\u6587\u4ef6\u7684\u5217\u8868\uff0c\u5e76\u63d0\u4f9b\u904d\u5386\u5b50\u76ee\u5f55\u548c\u6307\u5b9a\u6587\u4ef6\u6269\u5c55\u540d\u7684\u9009\u9879\u3002"),(0,s.kt)("h2",{id:"labels-\u6587\u4ef6\u6269\u5c55\u540d\u904d\u5386\u9012\u5f52"},"labels: ","[\u6587\u4ef6,\u6269\u5c55\u540d,\u904d\u5386,\u9012\u5f52]"),(0,s.kt)("p",null,"\u8fd9\u4e2a Visual Basic 6 (VBA) \u51fd\u6570\u53ef\u4ee5\u5728\u6307\u5b9a\u6587\u4ef6\u5939\u4e2d\u67e5\u627e\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u5e76\u63d0\u4f9b\u904d\u5386\u5b50\u76ee\u5f55\u548c\u6307\u5b9a\u6587\u4ef6\u6269\u5c55\u540d\u7684\u9009\u9879\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-vb"},'vFiles = GetFiles("D:\\MyFolder") \'\u83b7\u53d6 D \u76d8\u4e2d MyFolder \u6587\u4ef6\u5939\u53ca\u5176\u6240\u6709\u5b50\u6587\u4ef6\u5939\u4e2d\u7684\u6240\u6709\u6587\u4ef6\nvFiles = GetFiles("D:\\MyFolder", False) \'\u4ec5\u83b7\u53d6 D \u76d8\u4e2d MyFolder \u6587\u4ef6\u5939\u4e2d\u7684\u9876\u5c42\u6587\u4ef6\nvFiles = GetFiles("D:\\MyFolder", True, "txt") \'\u83b7\u53d6 D \u76d8\u4e2d MyFolder \u6587\u4ef6\u5939\u4e2d\u6240\u6709 .txt \u683c\u5f0f\u7684\u6587\u4ef6\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-vb"},'Function GetFiles(path As String, Optional includeSubFolders As Boolean = True, Optional ext As String = "") As Variant\n\n    Dim paths() As String\n    Dim isInit As Boolean\n    \n    isInit = False\n    \n    Dim fso As Object\n    Set fso = CreateObject("Scripting.FileSystemObject")\n    \n    Dim folder As Object\n    Set folder = fso.GetFolder(path)\n    \n    CollectFilesFromFolder folder, includeSubFolders, ext, paths, isInit\n    \n    If isInit Then\n        GetFiles = paths\n    Else\n        GetFiles = Empty\n    End If\n    \nEnd Function\n\nSub CollectFilesFromFolder(folder As Object, includeSubFolders As Boolean, ext As String, ByRef paths() As String, ByRef isInit As Boolean)\n    \n    For Each file In folder.files\n        Dim fileExt As String\n        fileExt = Right(file.path, Len(file.path) - InStrRev(file.path, "."))\n        If LCase(fileExt) = LCase(ext) Then\n            If Not isInit Then\n                ReDim paths(0)\n                isInit = True\n            Else\n                ReDim Preserve paths(UBound(paths) + 1)\n            End If\n            paths(UBound(paths)) = file.path\n        End If\n    Next\n    \n    If includeSubFolders Then\n        Dim subFolder As Object\n        For Each subFolder In folder.SubFolders\n            CollectFilesFromFolder subFolder, includeSubFolders, ext, paths, isInit\n        Next\n    End If\n    \nEnd Sub\n')))}p.isMDXComponent=!0}}]);