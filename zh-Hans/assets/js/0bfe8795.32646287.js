"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[84145],{3905:(n,e,t)=>{t.d(e,{Zo:()=>p,kt:()=>w});var o=t(67294);function r(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function i(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?s(Object(t),!0).forEach((function(e){r(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function a(n,e){if(null==n)return{};var t,o,r=function(n,e){if(null==n)return{};var t,o,r={},s=Object.keys(n);for(o=0;o<s.length;o++)t=s[o],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(o=0;o<s.length;o++)t=s[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}var l=o.createContext({}),c=function(n){var e=o.useContext(l),t=e;return n&&(t="function"==typeof n?n(e):i(i({},e),n)),t},p=function(n){var e=c(n.components);return o.createElement(l.Provider,{value:e},n.children)},d="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return o.createElement(o.Fragment,{},e)}},u=o.forwardRef((function(n,e){var t=n.components,r=n.mdxType,s=n.originalType,l=n.parentName,p=a(n,["components","mdxType","originalType","parentName"]),d=c(t),u=r,w=d["".concat(l,".").concat(u)]||d[u]||m[u]||s;return t?o.createElement(w,i(i({ref:e},p),{},{components:t})):o.createElement(w,i({ref:e},p))}));function w(n,e){var t=arguments,r=e&&e.mdxType;if("string"==typeof n||r){var s=t.length,i=new Array(s);i[0]=u;var a={};for(var l in e)hasOwnProperty.call(e,l)&&(a[l]=e[l]);a.originalType=n,a[d]="string"==typeof n?n:r,i[1]=a;for(var c=2;c<s;c++)i[c]=t[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}u.displayName="MDXCreateElement"},63398:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var o=t(87462),r=(t(67294),t(3905));const s={title:"\u4f7f\u7528SOLIDWORKS API\u8fd0\u884c\u7ec4\u4ef6\u7684\u65cb\u8f6c\u52a8\u753b",caption:"\u8fd0\u884c\u7ec4\u4ef6\u7684\u65cb\u8f6c\u52a8\u753b"},i=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-rotation-animation/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-rotation-animation/index",title:"\u4f7f\u7528SOLIDWORKS API\u8fd0\u884c\u7ec4\u4ef6\u7684\u65cb\u8f6c\u52a8\u753b",description:"\u8be5\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528SOLIDWORKS API\u4e2d\u7684\u6f14\u793a\u53d8\u6362\u8fd0\u884c\u7ec4\u4ef6\u56f4\u7ed5\u8f74\u7684\u5e73\u6ed1\u65cb\u8f6c\u52a8\u753b\u3002",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-rotation-animation/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-rotation-animation",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-rotation-animation/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-rotation-animation/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-rotation-animation/index.md",tags:[],version:"current",frontMatter:{title:"\u4f7f\u7528SOLIDWORKS API\u8fd0\u884c\u7ec4\u4ef6\u7684\u65cb\u8f6c\u52a8\u753b",caption:"\u8fd0\u884c\u7ec4\u4ef6\u7684\u65cb\u8f6c\u52a8\u753b"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS API\u8fd0\u884c\u4e00\u7ec4\u5b8f\u7684\u5b8f",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-macros-group/"},next:{title:"Fix failed SOLIDWORKS VSTA (C# or VB.NET) macro",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/run-vsta-macro-error/"}},l={},c=[{value:"labels: assembly, transform, rotation, animation",id:"labels-assembly-transform-rotation-animation",level:2},{value:"\u6ce8\u610f",id:"\u6ce8\u610f",level:3}],p={toc:c},d="wrapper";function m(n){let{components:e,...s}=n;return(0,r.kt)(d,(0,o.Z)({},p,s,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u8be5\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528SOLIDWORKS API\u4e2d\u7684\u6f14\u793a\u53d8\u6362\u8fd0\u884c\u7ec4\u4ef6\u56f4\u7ed5\u8f74\u7684\u5e73\u6ed1\u65cb\u8f6c\u52a8\u753b\u3002\nimage: component-rotation.gif"),(0,r.kt)("h2",{id:"labels-assembly-transform-rotation-animation"},"labels: ","[assembly, transform, rotation, animation]"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u7ec4\u4ef6\u56f4\u7ed5Y\u8f74\u7684\u65cb\u8f6c\u52a8\u753b",src:t(24066).Z,width:"300",height:"163"})),(0,r.kt)("p",null,"\u6b64\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528",(0,r.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2012/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.icomponent2~presentationtransform.html"},"SOLIDWORKS API"),"\u4e2d\u7684\u6f14\u793a\u53d8\u6362\u65b9\u6cd5\u8fd0\u884c\u7ec4\u4ef6\u56f4\u7ed5Y\u8f74\u7684\u5e73\u6ed1\u65cb\u8f6c\u52a8\u753b\u3002"),(0,r.kt)("p",null,"\u8fd9\u5141\u8bb8\u4ec5\u4e3a\u4e86\u89c6\u89c9\u6548\u679c\u800c\u79fb\u52a8\u7ec4\u4ef6\uff0c\u800c\u4e0d\u6539\u53d8\u51e0\u4f55\u5f62\u72b6\u3002\u7ec4\u4ef6\u5c06\u88ab\u79fb\u52a8\uff0c\u65e0\u8bba\u5b83\u5728\u7a7a\u95f4\u4e2d\u662f\u5426\u5b8c\u5168\u5b9a\u4e49\uff08\u901a\u8fc7\u914d\u5408\u6216\u56fa\u5b9a\u7ea6\u675f\uff09\u3002\u5e76\u4e14\u914d\u5408\u5173\u7cfb\u4ecd\u7136\u4fdd\u7559\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u9009\u62e9\u88c5\u914d\u4e2d\u7684\u4efb\u4f55\u7ec4\u4ef6\u5e76\u8fd0\u884c\u5b8f"),(0,r.kt)("li",{parentName:"ul"},"\u7ec4\u4ef6\u56f4\u7ed5\u5176Y\u8f74\u65cb\u8f6c"),(0,r.kt)("li",{parentName:"ul"},"\u8981\u505c\u6b62\u52a8\u753b\uff0c\u8bf7\u6e05\u9664\u9009\u62e9\uff08\u53d6\u6d88\u9009\u62e9\u6240\u6709\u5bf9\u8c61\uff09"),(0,r.kt)("li",{parentName:"ul"},"\u8981\u4fee\u6539\u65cb\u8f6c\u901f\u5ea6\uff0c\u8bf7\u66f4\u6539",(0,r.kt)("em",{parentName:"li"},"RunRotationAnimation"),"\u65b9\u6cd5\u7684\u53ef\u9009\u53c2\u6570",(0,r.kt)("em",{parentName:"li"},"speed"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'If Not swComp Is Nothing Then\n    RunRotationAnimation swModel, swComp, 2 \'\u901f\u5ea6x2\nElse\n    MsgBox "\u8bf7\u9009\u62e9\u7ec4\u4ef6"\nEnd If\n')),(0,r.kt)("h3",{id:"\u6ce8\u610f"},"\u6ce8\u610f"),(0,r.kt)("p",null,"\u4e3a\u4e86\u542f\u7528\u6f14\u793a\u6a21\u5f0f\uff0c\u9700\u8981\u5c06",(0,r.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2012/english/api/sldworksapi/SOLIDWORKS.Interop.sldworks~SOLIDWORKS.Interop.sldworks.IAssemblyDoc~EnablePresentation.html"},"IAssemblyDoc::EnablePresentation"),"\u5c5e\u6027\u8bbe\u7f6e\u4e3aTrue\u3002"),(0,r.kt)("p",null,"\u5728\u52a8\u753b\u5b8c\u6210\u540e\uff0c\u9700\u8981\u5c06\u6b64\u5c5e\u6027\u8bbe\u7f6e\u4e3aFalse\uff0c\u5426\u5219\u6240\u6709SOLIDWORKS\u83dc\u5355\u90fd\u5c06\u88ab\u9501\u5b9a\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u88c5\u914d\u6f14\u793a\u6a21\u5f0f\u4e2d\u7684\u9501\u5b9a\u83dc\u5355",src:t(63068).Z,width:"649",height:"345"}),"{ width=300 }"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Const PI As Double = 3.14159265359\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    \n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n    \n        Dim swSelMgr As SldWorks.SelectionMgr\n        \n        Set swSelMgr = swModel.SelectionManager\n        \n        Dim swComp As SldWorks.Component2\n        Set swComp = swSelMgr.GetSelectedObjectsComponent4(1, -1)\n        \n        If Not swComp Is Nothing Then\n            RunRotationAnimation swModel, swComp\n        Else\n            MsgBox "\u8bf7\u9009\u62e9\u7ec4\u4ef6"\n        End If\n        \n    Else\n        MsgBox "\u8bf7\u6253\u5f00\u88c5\u914d"\n    End If\n    \nEnd Sub\n\nSub RunRotationAnimation(assy As SldWorks.AssemblyDoc, comp As SldWorks.Component2, Optional speed As Double = 1)\n    \n    Dim swSelMgr As SldWorks.SelectionMgr\n        \n    Set swSelMgr = assy.SelectionManager\n        \n    Dim rotStep As Double\n    rotStep = PI * 2 / 360 * speed\n    \n    Dim curAng As Double\n    \n    Dim swModelView As SldWorks.ModelView\n    Set swModelView = assy.ActiveView\n            \n    assy.EnablePresentation = True\n    \n    While swSelMgr.GetSelectedObjectCount2(-1) <> 0\n        For curAng = 0 To PI * 2 Step rotStep\n            Dim animStep As MathTransform\n            Set animStep = GetTransform(comp, curAng)\n            comp.PresentationTransform = animStep\n            swModelView.GraphicsRedraw Nothing\n            DoEvents\n        Next\n    Wend\n    \n    assy.EnablePresentation = False\n    \nEnd Sub\n\nFunction GetTransform(comp As SldWorks.Component2, angle As Double) As MathTransform\n    \n    Dim swMathUtils As SldWorks.MathUtility\n    \n    Set swMathUtils = swApp.GetMathUtility\n    \n    Dim swOrigPt As SldWorks.MathPoint\n    Dim dPt(2) As Double\n    dPt(0) = 0: dPt(1) = 0: dPt(2) = 0\n    \n    Set swOrigPt = swMathUtils.CreatePoint(dPt)\n    \n    Set swOrigPt = swOrigPt.MultiplyTransform(comp.Transform2)\n    \n    Dim swAxisVec As SldWorks.MathVector\n    Dim dVec(2) As Double\n    dVec(0) = 0: dVec(1) = 1: dVec(2) = 0\n    \n    Set swAxisVec = swMathUtils.CreateVector(dVec)\n    \n    Set swAxisVec = swAxisVec.MultiplyTransform(comp.Transform2)\n    \n    Set GetTransform = swMathUtils.CreateTransformRotateAxis(swOrigPt, swAxisVec, angle)\n    \nEnd Function\n')))}m.isMDXComponent=!0},24066:(n,e,t)=>{t.d(e,{Z:()=>o});const o=t.p+"assets/images/component-rotation-c8727c839c0eb8cea4a686070b435d10.gif"},63068:(n,e,t)=>{t.d(e,{Z:()=>o});const o=t.p+"assets/images/locked-menu-74799bb44295d667f3ce4f8289b726d1.png"}}]);