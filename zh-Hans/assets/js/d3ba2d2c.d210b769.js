"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[45121],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>D});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=o.createContext({}),m=function(e){var t=o.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},l=function(e){var t=m(e.components);return o.createElement(i.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=m(n),d=r,D=p["".concat(i,".").concat(d)]||p[d]||u[d]||s;return n?o.createElement(D,a(a({ref:t},l),{},{components:n})):o.createElement(D,a({ref:t},l))}));function D(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,a=new Array(s);a[0]=d;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c[p]="string"==typeof e?e:r,a[1]=c;for(var m=2;m<s;m++)a[m]=n[m];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1806:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>c,toc:()=>m});var o=n(87462),r=(n(67294),n(3905));const s={title:"\u4f7f\u7528SOLIDWORKS Document Manager API\u5411\u6a21\u578b\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027",caption:"\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027"},a=void 0,c={unversionedId:"codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index",id:"codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index",title:"\u4f7f\u7528SOLIDWORKS Document Manager API\u5411\u6a21\u578b\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027",description:"\u4f7f\u7528SOLIDWORKS Document Manager API\u5411\u6a21\u578b\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684VBA\u5b8f",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index.md",sourceDirName:"codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property",slug:"/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index.md",tags:[],version:"current",frontMatter:{title:"\u4f7f\u7528SOLIDWORKS Document Manager API\u5411\u6a21\u578b\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027",caption:"\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS\u6587\u6863\u7ba1\u7406\u5668API\u7ba1\u7406\u6587\u4ef6\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/"},next:{title:"\u7528\u4e8e\u7ba1\u7406SOLIDWORKS\u6587\u4ef6\u4e2d\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684Excel\u5b8f",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/excel-functions/"}},i={},m=[{value:"labels: \u4e0d\u53ef\u89c1, \u81ea\u5b9a\u4e49\u5c5e\u6027",id:"labels-\u4e0d\u53ef\u89c1-\u81ea\u5b9a\u4e49\u5c5e\u6027",level:2}],l={toc:m},p="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,o.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u4f7f\u7528SOLIDWORKS Document Manager API\u5411\u6a21\u578b\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684VBA\u5b8f"),(0,r.kt)("h2",{id:"labels-\u4e0d\u53ef\u89c1-\u81ea\u5b9a\u4e49\u5c5e\u6027"},"labels: ","[\u4e0d\u53ef\u89c1, \u81ea\u5b9a\u4e49\u5c5e\u6027]"),(0,r.kt)("p",null,'SOLIDWORKS\u6a21\u578b\u5305\u542b\u591a\u4e2a\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u4f8b\u5982$PRP:"SW-File Name"\uff0c$PRP:"SW-Title"\u3002\u8fd9\u4e9b\u5c5e\u6027\u662f\u53ea\u8bfb\u7684\uff0c\u65e0\u6cd5\u4ece\u7528\u6237\u754c\u9762\u8fdb\u884c\u4fee\u6539\u3002\u4f46\u662f\uff0c\u53ef\u4ee5\u4f7f\u7528Document Manager API\u6dfb\u52a0\u65b0\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u3002\u6b64\u5c5e\u6027\u5728\u81ea\u5b9a\u4e49\u5c5e\u6027\u7ba1\u7406\u5668\u9875\u9762\u4e2d\u4e0d\u53ef\u7528\uff0c\u7528\u6237\u6216SOLIDWORKS API\u65e0\u6cd5\u4fee\u6539\u3002'),(0,r.kt)("p",null,"\u6b64VBA\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4e3a\u6307\u5b9a\u7684\u6a21\u578b\u6dfb\u52a0\u4e0d\u53ef\u89c1\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u3002\u8bf7\u6309\u7167\u4ee5\u4e0b\u914d\u7f6e\u5b8f\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Const FILE_PATH As String = "C:\\SampleModel.SLDPRT" \'\u8981\u6dfb\u52a0\u4e0d\u53ef\u89c1\u5c5e\u6027\u7684\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\nConst PRP_NAME As String = "MyProperty" \'\u8981\u6dfb\u52a0\u7684\u5c5e\u6027\u540d\u79f0\nConst PRP_VAL As String = "MyValue" \'\u8981\u5206\u914d\u7684\u5c5e\u6027\u503c\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Const SW_DM_KEY As String = "Your license"\n\nConst FILE_PATH As String = "C:\\SampleModel.SLDPRT"\nConst PRP_NAME As String = "MyProperty"\nConst PRP_VAL As String = "MyValue"\n\nDim swDmClassFactory As SwDocumentMgr.swDmClassFactory\nDim swDmApp As SwDocumentMgr.SwDMApplication\n\nSub main()\n\n    Set swDmClassFactory = CreateObject("SwDocumentMgr.SwDMClassFactory")\n    \n    If Not swDmClassFactory Is Nothing Then\n        \n        Set swDmApp = swDmClassFactory.GetApplication(SW_DM_KEY)\n        Dim swDmDoc As SwDocumentMgr.SwDMDocument19\n        Set swDmDoc = OpenDocument(FILE_PATH, False)\n        \n        swDmDoc.AddInvisibleCustomProperty PRP_NAME, SwDmCustomInfoType.swDmCustomInfoText, PRP_VAL\n        swDmDoc.SetInvisibleCustomProperty PRP_NAME, PRP_VAL\n        \n        swDmDoc.Save\n        swDmDoc.CloseDoc\n        \n    Else\n        MsgBox "\u672a\u5b89\u88c5Document Manager SDK"\n    End If\n    \nEnd Sub\n\nFunction OpenDocument(filePath As String, readOnly As Boolean) As SwDocumentMgr.SwDMDocument19\n    \n    Dim openErr As SwDmDocumentOpenError\n    \n    Dim docType As SwDocumentMgr.SwDmDocumentType\n    \n    Dim ext As String\n    ext = LCase(Right(filePath, Len(".SLDXXX")))\n    \n    Select Case ext\n        Case ".sldprt"\n            docType = swDmDocumentPart\n        Case ".sldasm"\n            docType = swDmDocumentAssembly\n        Case ".slddrw"\n            docType = swDmDocumentDrawing\n    End Select\n    \n    Dim swDmDoc As SwDocumentMgr.SwDMDocument19\n    \n    Set swDmDoc = swDmApp.GetDocument(filePath, docType, readOnly, openErr)\n    \n    If swDmDoc Is Nothing Then\n        Err.Raise vbError, "", "\u65e0\u6cd5\u6253\u5f00\u6587\u6863: " & openErr\n    End If\n    \n    Set OpenDocument = swDmDoc\n    \nEnd Function\n')))}u.isMDXComponent=!0}}]);