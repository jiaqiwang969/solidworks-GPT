"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[63229],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>f});var o=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},s=Object.keys(e);for(o=0;o<s.length;o++)r=s[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=o.createContext({}),d=function(e){var t=o.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=d(e.components);return o.createElement(c.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,s=e.originalType,c=e.parentName,l=a(e,["components","mdxType","originalType","parentName"]),p=d(r),m=n,f=p["".concat(c,".").concat(m)]||p[m]||u[m]||s;return r?o.createElement(f,i(i({ref:t},l),{},{components:r})):o.createElement(f,i({ref:t},l))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=r.length,i=new Array(s);i[0]=m;var a={};for(var c in t)hasOwnProperty.call(t,c)&&(a[c]=t[c]);a.originalType=e,a[p]="string"==typeof e?e:n,i[1]=a;for(var d=2;d<s;d++)i[d]=r[d];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}m.displayName="MDXCreateElement"},66586:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var o=r(87462),n=(r(67294),r(3905));const s={caption:"Scale Imported Geometry",title:"VBA macro to scale the geometry of the imported features using SOLIDWORKS API",description:"VBA macro scales the bodies from the imported features of the foreign formats (e.g. STEP, IGES) with the specified scale factor",image:"imported-feature.png"},i=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/scale-imported-part/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/scale-imported-part/index",title:"VBA macro to scale the geometry of the imported features using SOLIDWORKS API",description:"VBA macro scales the bodies from the imported features of the foreign formats (e.g. STEP, IGES) with the specified scale factor",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/scale-imported-part/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/scale-imported-part",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/scale-imported-part/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/scale-imported-part/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/scale-imported-part/index.md",tags:[],version:"current",frontMatter:{caption:"Scale Imported Geometry",title:"VBA macro to scale the geometry of the imported features using SOLIDWORKS API",description:"VBA macro scales the bodies from the imported features of the foreign formats (e.g. STEP, IGES) with the specified scale factor",image:"imported-feature.png"},sidebar:"tutorialSidebar",previous:{title:"Save the selected body into external file using SOLIDWORKS API",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/save-body-to-file/"},next:{title:"Fix missing Visual Studio SOLIDWORKS API SDK project templates",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/sdk-installation/"}},c={},d=[],l={toc:d},p="wrapper";function u(e){let{components:t,...s}=e;return(0,n.kt)(p,(0,o.Z)({},l,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Imported geometry feature",src:r(20009).Z,width:"322",height:"536"}),"{ width=250 }"),(0,n.kt)("p",null,"This VBA macro scales all bodies form the imported features in active SOLIDWORKS part file. THe imported features will be generated if file is loaded from neutral formats like STEP, IGES, Parasolid unless 3D Interconnect option is used."),(0,n.kt)("p",null,"Set the scale factor in the ",(0,n.kt)("strong",{parentName:"p"},"SCALE_FACTOR")," constant."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Const SCALE_FACTOR As Double = 2.5\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    \n    Dim errs As Long\n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n        \n        Dim swFeat As SldWorks.Feature\n        \n        Dim i As Integer\n        i = -1\n        \n        Do\n            i = i + 1\n            Set swFeat = swModel.FeatureByPositionReverse(i)\n            \n            If swFeat.GetTypeName2() = "BaseBody" Then\n                \n                Dim swBody As SldWorks.Body2\n                \n                Set swBody = swFeat.GetFaces()(0).GetBody\n                Set swBody = swBody.Copy\n                \n                ApplyScale swBody, SCALE_FACTOR\n                \n                swFeat.SetBody swBody\n                \n            End If\n            \n            If swFeat.GetTypeName2() = "OriginProfileFeature" Then\n                Exit Do\n            End If\n            \n        Loop While Not swFeat Is Nothing\n        \n    Else\n        Err.Raise vbError, "", "Failed to load model: " & errs\n    End If\n    \nEnd Sub\n\nSub ApplyScale(body As SldWorks.Body2, scaleFactor As Double)\n\n    Dim dMatrix(15) As Double\n    dMatrix(0) = 1: dMatrix(1) = 0: dMatrix(2) = 0: dMatrix(3) = 0\n    dMatrix(4) = 1: dMatrix(5) = 0: dMatrix(6) = 0: dMatrix(7) = 0\n    dMatrix(8) = 1: dMatrix(9) = 0: dMatrix(10) = 0: dMatrix(11) = 0\n    dMatrix(12) = scaleFactor: dMatrix(13) = 0: dMatrix(14) = 0: dMatrix(15) = 0\n\n    Dim swMathUtils As SldWorks.MathUtility\n    Set swMathUtils = swApp.GetMathUtility\n    \n    Dim swMathTransform As SldWorks.MathTransform\n    Set swMathTransform = swMathUtils.CreateTransform(dMatrix)\n\n    body.ApplyTransform swMathTransform\n    \nEnd Sub\n')))}u.isMDXComponent=!0},20009:(e,t,r)=>{r.d(t,{Z:()=>o});const o=r.p+"assets/images/imported-feature-2c7085812b40eb12d19aee5242307b6e.png"}}]);