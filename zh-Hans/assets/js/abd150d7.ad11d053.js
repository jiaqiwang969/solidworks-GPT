"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[7184],{3905:(e,t,n)=>{n.d(t,{Zo:()=>i,kt:()=>u});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},m=Object.keys(e);for(a=0;a<m.length;a++)n=m[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(e);for(a=0;a<m.length;a++)n=m[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var r=a.createContext({}),A=function(e){var t=a.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},i=function(e){var t=A(e.components);return a.createElement(r.Provider,{value:t},e.children)},l="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,m=e.originalType,r=e.parentName,i=d(e,["components","mdxType","originalType","parentName"]),l=A(n),p=o,u=l["".concat(r,".").concat(p)]||l[p]||c[p]||m;return n?a.createElement(u,s(s({ref:t},i),{},{components:n})):a.createElement(u,s({ref:t},i))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var m=n.length,s=new Array(m);s[0]=p;var d={};for(var r in t)hasOwnProperty.call(t,r)&&(d[r]=t[r]);d.originalType=e,d[l]="string"==typeof e?e:o,s[1]=d;for(var A=2;A<m;A++)s[A]=n[A];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},53791:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>s,default:()=>c,frontMatter:()=>m,metadata:()=>d,toc:()=>A});var a=n(87462),o=(n(67294),n(3905));const m={title:"Custom enable command state for SOLIDWORKS commands",caption:"Custom Enable Command State",description:"Explanation on using the custom enable states for the SOLIDWORKS commands using SwEx framework","toc-group-name":"labs-solidworks-swex",sidebar_position:0},s=void 0,d={unversionedId:"codestack/labs/solidworks/swex/add-in/commands-manager/command-states/index",id:"codestack/labs/solidworks/swex/add-in/commands-manager/command-states/index",title:"Custom enable command state for SOLIDWORKS commands",description:"Explanation on using the custom enable states for the SOLIDWORKS commands using SwEx framework",source:"@site/docs/codestack/labs/solidworks/swex/add-in/commands-manager/command-states/index.md",sourceDirName:"codestack/labs/solidworks/swex/add-in/commands-manager/command-states",slug:"/codestack/labs/solidworks/swex/add-in/commands-manager/command-states/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/commands-manager/command-states/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/labs/solidworks/swex/add-in/commands-manager/command-states/index.md",tags:[],version:"current",sidebarPosition:0,frontMatter:{title:"Custom enable command state for SOLIDWORKS commands",caption:"Custom Enable Command State",description:"Explanation on using the custom enable states for the SOLIDWORKS commands using SwEx framework","toc-group-name":"labs-solidworks-swex",sidebar_position:0},sidebar:"tutorialSidebar",previous:{title:"SOLIDWORKS commands manager with SwEx.AddIn framework",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/commands-manager/"},next:{title:"Defining commands buttons in SOLIDWORKS toolbar using SwEx.AddIn framework",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/labs/solidworks/swex/add-in/commands-manager/defining-commands/"}},r={},A=[],i={toc:A},l="wrapper";function c(e){let{components:t,...m}=e;return(0,o.kt)(l,(0,a.Z)({},i,m,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"There are 4 command states supported by SOLIDWORKS:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Deselected and enabled. This is default option when button can be clicked"),(0,o.kt)("li",{parentName:"ol"},"Deselected and disabled. This option is used when the command is not supported in certain framework. For example mate command will be disabled in parts and drawings as it is only supported in the assemblies."),(0,o.kt)("li",{parentName:"ol"},"Selected and disabled. This represents the disabled checked button"),(0,o.kt)("li",{parentName:"ol"},"Selected and enabled. This represents checked button")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Supported command states",src:n(16007).Z,width:"139",height:"33"})),(0,o.kt)("p",null,"SwEx framework will assign the appropriate state (enabled or disabled) for the commands based on their supported workspaces if defined in the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/T_CodeStack_SwEx_AddIn_Attributes_CommandItemInfoAttribute.htm"},"CommandItemInfoAttribute"),". However user can alter the state to provide more advanced management (for example it might be required to enable command if certain object is selected or if any bodies or components are present in the model). To do this it is required to specify the enable method handler as the last parameter of ",(0,o.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/M_CodeStack_SwEx_AddIn_SwAddInEx_AddCommandGroup__1.htm"},"AddCommandGroup")," or ",(0,o.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/M_CodeStack_SwEx_AddIn_SwAddInEx_AddContextMenu__1.htm"},"AddContextMenu")," methods."),(0,o.kt)("p",null,"The method is defined as ",(0,o.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/T_CodeStack_SwEx_AddIn_EnableMethodDelegate_1.htm"},"EnableMethodDelegate")," delegate and provides the command id as first parameter and state passed by reference as second parameter."),(0,o.kt)("p",null,"The value of state will be preassigned based on the workspace and can be changed by the user within the method."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"This method allows to implement the toggle button in toolbar and menu. To set the checked state assign the ",(0,o.kt)("em",{parentName:"p"},"SelectEnable")," or ",(0,o.kt)("em",{parentName:"p"},"SelectDisable")," values of ",(0,o.kt)("a",{parentName:"p",href:"https://docs.codestack.net/swex/add-in/html/T_CodeStack_SwEx_AddIn_Enums_CommandItemEnableState_e.htm"},"CommandItemEnableState_e")," enumeration.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},"Public Enum Commands_e\n    Command1\n    Command2\nEnd Enum\n\nPublic Overrides Function OnConnect() As Boolean\n    AddCommandGroup(Of Commands_e)(AddressOf OnButtonClick, AddressOf OnButtonEnable)\n    Return True\nEnd Function\n\nPrivate Sub OnButtonEnable(ByVal cmd As Commands_e, ByRef state As CommandItemEnableState_e)\n    Select Case cmd\n        Case Commands_e.Command1, Commands_e.Command2\n            'TODO: implement logic to identify the state of the button\n            state = CommandItemEnableState_e.DeselectDisable\n    End Select\nEnd Su\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cs"},"public enum Commands_e\n{\n    Command1,\n    Command2\n}\n\npublic override bool OnConnect()\n{\n    AddCommandGroup<Commands_e>(OnButtonClick, OnButtonEnable);\n    return true;\n}\n\nprivate void OnButtonEnable(Commands_e cmd, ref CommandItemEnableState_e state)\n{\n    switch (cmd)\n    {\n        case Commands_e.Command1:\n        case Commands_e.Command2:\n            //TODO: implement logic to identify the state of the button\n            state = CommandItemEnableState_e.DeselectDisable;\n            break;\n    }\n}\n")))}c.isMDXComponent=!0},16007:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,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"}}]);