"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[66286],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var A=r.createContext({}),l=function(e){var t=r.useContext(A),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(A.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,A=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),u=l(n),m=o,f=u["".concat(A,".").concat(m)]||u[m]||d[m]||i;return n?r.createElement(f,s(s({ref:t},c),{},{components:n})):r.createElement(f,s({ref:t},c))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,s=new Array(i);s[0]=m;var a={};for(var A in t)hasOwnProperty.call(t,A)&&(a[A]=t[A]);a.originalType=e,a[u]="string"==typeof e?e:o,s[1]=a;for(var l=2;l<i;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4690:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>A,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var r=n(87462),o=(n(67294),n(3905));const i={layout:"sw-tool",title:"Set title as part number for new file using SOLIDWORKS API",caption:"Set Title To Next Part Number",description:"VBA Macro to set title with automatically incremented number from the shared file using SOLIDWORKS API for new files",image:"automatic-model-title.png",labels:["part number","title"],group:"Model"},s=void 0,a={unversionedId:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title/index",id:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title/index",title:"Set title as part number for new file using SOLIDWORKS API",description:"VBA Macro to set title with automatically incremented number from the shared file using SOLIDWORKS API for new files",source:"@site/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title/index.md",sourceDirName:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title",slug:"/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",title:"Set title as part number for new file using SOLIDWORKS API",caption:"Set Title To Next Part Number",description:"VBA Macro to set title with automatically incremented number from the shared file using SOLIDWORKS API for new files",image:"automatic-model-title.png",labels:["part number","title"],group:"Model"},sidebar:"tutorialSidebar",previous:{title:"Create a dynamic auto updatable date custom property in SOLIDWORKS file",permalink:"/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-date/"},next:{title:"Batch create feature folders in the active SOLIDWORKS document",permalink:"/solidworks-GPT/zh-Hans/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders/"}},A={},l=[],c={toc:l},u="wrapper";function d(e){let{components:t,...i}=e;return(0,o.kt)(u,(0,r.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Model title set to part number",src:n(84240).Z,width:"963",height:"376"}),"{ width=450 }"),(0,o.kt)("p",null,"This VBA macro automatically increments the part number and sets this as a title for newly created file using SOLIDWORKS API."),(0,o.kt)("p",null,"Part number is incremented and stored in the external text file which can be shared across different users if needed."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Current part number value in the text file",src:n(25965).Z,width:"519",height:"302"}),"{ width=350 }"),(0,o.kt)("p",null,"Macro provides several options to format the title which can be modified by changes in the values of the constants in the macro."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Const NMB_SRC_FILE_PATH As String = "D:\\prt.txt" \'path to store the current part index\nConst NMB_FORMAT As String = "000" \'padding for the number, e.g. 001, 002, instead of 1, 2\nConst BASE_NAME As String = "PRT-" \'Base prefix for file naming\n')),(0,o.kt)("p",null,"Follow the video tutorial in the ",(0,o.kt)("a",{parentName:"p",href:"/docs/codestack/solidworks-api/application/documents/handle-document-load/"},"Run Macro On Document Load")," article for the guide of running this macro automatically for each newly created model."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Const NMB_SRC_FILE_PATH As String = "D:\\prt.txt"\nConst NMB_FORMAT As String = "000"\nConst BASE_NAME As String = "PRT-"\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n        \n    Dim swModel As SldWorks.ModelDoc2\n        \n    Set swModel = swApp.ActiveDoc\n    \n    Dim lastNumber As Integer\n    \n    lastNumber = ReadNumber(NMB_SRC_FILE_PATH)\n    \n    Dim thisNumber As Integer\n    thisNumber = lastNumber + 1\n    \n    Dim name As String\n    name = BASE_NAME & Format(thisNumber, NMB_FORMAT)\n    \n    If False = swModel.SetTitle2(name) Then\n        Err.Raise vbError, "", "Failed to set title"\n    End If\n    \n    StoreNumber NMB_SRC_FILE_PATH, thisNumber\n    \nEnd Sub\n\nFunction ReadNumber(filePath As String) As Integer\n    \n    Dim fileNo As Integer\n\n    fileNo = FreeFile\n    \n    Dim number As String\n    \n    Open filePath For Input As #fileNo\n        \n    Line Input #fileNo, number\n    \n    Close #fileNo\n    \n    ReadNumber = CInt(number)\n    \nEnd Function\n\nSub StoreNumber(filePath As String, number As Integer)\n    \n    Dim fileNo As Integer\n    fileNo = FreeFile\n    \n    Open filePath For Output As #fileNo\n    \n    Print #fileNo, CStr(number)\n    \n    Close #fileNo\n    \nEnd Sub\n')))}d.isMDXComponent=!0},84240:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/automatic-model-title-4b1299f66346bd02dee5cf6fbd58a4e5.png"},25965:(e,t,n)=>{n.d(t,{Z:()=>r});const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgcAAAEuCAMAAAAtNEFqAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAAG7a8ydxoZd0M/7+/hgYGHvF4IygtWIsAEWM36fq9QArfLGxsdbdqnufh1NWZgAANn89NKCmvNrgq1Z9hrnR6SjP5MaDOOvr69+Uhua4sKPI4qc/K8nm7ABMnDMzNH29y+rv+CYAMsjW5KfAvXx8fD/O8rLL5ZdYACYAACdwwqvZ46dYSe7x8V1viODl9duQOp651VmWtnupfiVreuWilKeml2JQf+js9patx0QAMkJMANnm6dHp78ja7qG61htLUqSHV2a2/+Tk5Ka/2rXO53dMAMHc4tzi8szd79i/htXcze7x+WttMc10Y6rDnqvE35m10aK82LzJ2aLM1fL0sgAAWV6l3IzD0Jreq2V2j6NOPyYAWdWcX/PSyzEyhkMUIgBZq7dgT5PF4Kh4c+/v77a8zNbd76/E10JCQpzF2UQAALbZ7XkyAP/bkHjBnZfb7a6qf1ad77Z7NTB9zY3J2OXq9ciGek8nNnV1dZuaiNvhzyVsvKjB3JGEYLpJM9majlDS8vT2+ni1xHKvvo9sMQAyhlYANdTb7ZVrZ7fc7qmnfXa/28NdSq7HwZpVTKVeAL6Jg+WnYr5SPd7p7Hm/8HnC2+emmYu82HCBmX+Qmpre7zF9rJg3JNDg8F09TezFv1gAAJGowI5FO7rfzsLj66mpqVYAYF4rANnf8I9sWJA6AKzR267H4SsuW5mxzLuam9Tj8srKyuGYi8PDw6qMWb2hYZXH07dCK7z1+gBah2imtbne72BwiYOEhLKAfDKB0ZDb/46/2+ipnAAAYJzR3kKInKTP3n1QAEVPU9vn87TV3oDd9GhyhIVKQtJ+bobI1v+2ZgBfsJtZAHe87qW/uzpmtrXd5pqwx+Odj5PM2tzd3XtaiDUAALd8X1mj87q6ul/V88hpVzEANWJzjDEAYJzh8sLW66GgoJWVlZLi9ABPoJvL1bzZ373g6ILK9ouMjJxFNbp+Nbvg8bZmAJHC3ZuftQA6kGGp4Lt9cT17rbBdTGl6kdmfYITAzQAAAFFXS18AAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAODUlEQVR4Xu3dD3xVZR3H8VMMQ4YNNRX/wERAELTM0tACtF0mgsZChIWilxCn4kxhS0hGdHHTpAxNLLQUZhIVUyyJzH+UrI1RRs7SZgQlCoQaQpoV8ur3fZ7fuffce879MxSzc77vV7vnnOc859wbz4e7O6F0ikQpRVfXrkhAOii9YnMZdimabj9TSnCKSneWfZaibNiQrtLBFcwg6h4+s8gp3awHFF3duzqlfDsgdJDQfYqu7qVOadFHKepeYgck2AHB39gBCXbwXtC4+MP5LW7sxMRD7onnd88h+vzawYh0d+I/7gO9CyZd1pbfZZM6MXHWyovzWzlLn3/ECH8Hzet6r1v36roh69a1rKutrDxNh2k/eqxta35tj3ViYvziJ/O7OK7P7+9g3LjatmHDhvW+79khQ1qa91ZWztUTtB891nZYfrYDPcjFdvCt/NjBe8x+6GDJqfktyehgXEos1oEO7ntVOmhuPvbll+fqCdqPthS0vFsyJt5ZknKnjgEmxpf8MeVWmfCEZ+taEtfnHzcus4Mrr2zpd/Yrr6xf0TJ+/OrKG8aPfxsdlPeciE19H3NUsM7OD4F966BE//oAlOgY2A5+koKJJZceeavZXqeDIkcHHR0rhvXu3RtvB0OaO24YNiyog7OKv522Be++KnfMWNq6BkzLxA6CdbKDI1PMxJJL7eZfOihydFBbO/DsV9avX7Fi/OrVlXsfuf32t9PBx6fPkQ07yOsd6OB8HRS+Dp6wBZiHr16ng8LTwa/RQSyltnZ9RgdmuHxOveMU/zL2++W/mj7hk47j9MEgtvUTviajfcy+mZpSPucsORmrx7hcjvM6TY56TkzdNbbgBLvF+eLzMu8TfgV2kDGxJJFImA8H2F6ugwIT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"}}]);