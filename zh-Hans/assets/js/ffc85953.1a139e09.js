"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[15578],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},d=Object.keys(e);for(i=0;i<d.length;i++)n=d[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(i=0;i<d.length;i++)n=d[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var r=i.createContext({}),l=function(e){var t=i.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=l(e.components);return i.createElement(r.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,d=e.originalType,r=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=l(n),u=a,g=m["".concat(r,".").concat(u)]||m[u]||c[u]||d;return n?i.createElement(g,o(o({ref:t},p),{},{components:n})):i.createElement(g,o({ref:t},p))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var d=n.length,o=new Array(d);o[0]=u;var s={};for(var r in t)hasOwnProperty.call(t,r)&&(s[r]=t[r]);s.originalType=e,s[m]="string"==typeof e?e:a,o[1]=s;for(var l=2;l<d;l++)o[l]=n[l];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},39793:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>c,frontMatter:()=>d,metadata:()=>s,toc:()=>l});var i=n(87462),a=(n(67294),n(3905));const d={title:"Debugging SOLIDWORKS PDM Add-In - Best Practices",caption:"Debugging SOLIDWORKS PDM Add-In - Best Practices",description:"Detailed guide for debugging the SOLIDWORKS PDM Add-In. Simplified debugging using the Vault Browser tool",image:"debug-addin.png",labels:["add-in","api","attach to process","debugging","epdm","example","notepad","pdm","solidworks pdm","visual studio"],"redirect-from":["/2018/03/debugging-solidworks-pdm-add-in-best.html"]},o=void 0,s={unversionedId:"codestack/solidworks-pdm-api/getting-started/add-ins/debugging-best-practices/index",id:"codestack/solidworks-pdm-api/getting-started/add-ins/debugging-best-practices/index",title:"Debugging SOLIDWORKS PDM Add-In - Best Practices",description:"Detailed guide for debugging the SOLIDWORKS PDM Add-In. Simplified debugging using the Vault Browser tool",source:"@site/docs/codestack/solidworks-pdm-api/getting-started/add-ins/debugging-best-practices/index.md",sourceDirName:"codestack/solidworks-pdm-api/getting-started/add-ins/debugging-best-practices",slug:"/codestack/solidworks-pdm-api/getting-started/add-ins/debugging-best-practices/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-pdm-api/getting-started/add-ins/debugging-best-practices/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-pdm-api/getting-started/add-ins/debugging-best-practices/index.md",tags:[],version:"current",frontMatter:{title:"Debugging SOLIDWORKS PDM Add-In - Best Practices",caption:"Debugging SOLIDWORKS PDM Add-In - Best Practices",description:"Detailed guide for debugging the SOLIDWORKS PDM Add-In. Simplified debugging using the Vault Browser tool",image:"debug-addin.png",labels:["add-in","api","attach to process","debugging","epdm","example","notepad","pdm","solidworks pdm","visual studio"],"redirect-from":["/2018/03/debugging-solidworks-pdm-add-in-best.html"]},sidebar:"tutorialSidebar",previous:{title:"How to create SOLIDWORKS PDM Professional (EPDM) add-in",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-pdm-api/getting-started/add-ins/create/"},next:{title:"Using SOLIDWORKS PDM API In VBA And VSTA Macros",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-pdm-api/getting-started/macros/"}},r={},l=[],p={toc:l},m="wrapper";function c(e){let{components:t,...d}=e;return(0,a.kt)(m,(0,i.Z)({},p,d,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"When it comes to debugging of SOLIDWORKS PDM add-ins a lot of developers find this process cumbersome and complicated. This especially applies if you have been developing desktop or SOLIDWORKS applications before and now need to develop PDM add-in."),(0,a.kt)("p",null,"The main complexity comes from the fact that SOLIDWORKS PDM is a server-client system fully integrated into the Windows explorer process on the client machines. That means that the add-ins (as in-process extensions) are loaded into explorer.exe process. It is important to understand that explorer.exe is not only the process for Windows File Explorer, rather it also manages the start menu, taskbar, desktop, etc. So it is not enough to simply close the Windows File Explorer to unlock the add-in dlls."),(0,a.kt)("p",null,"SOLIDWORKS PDM provides a handy framework for developers which greatly simplify the development process. You can find the ",(0,a.kt)("em",{parentName:"p"},"Debug Add-ins")," menu under the Add-ins node in the vault tree of the ",(0,a.kt)("em",{parentName:"p"},"SOLIDWORKS PDM Administration")," console."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Debug add-in command in the Administration Panel",src:n(93864).Z,width:"320",height:"297"}),"{ width=320 height=297 }"),(0,a.kt)("p",null,"You need to select single dll with your add-in to load it into the debugger."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"GUID of the add-in",src:n(53955).Z,width:"640",height:"246"}),"{ width=640 height=246 }"),(0,a.kt)("p",null,"Once selected the entry of your add-in appears in the list and will remain there until removed. So it is not required to open this console every time the project is rebuilt."),(0,a.kt)("p",null,"As I have previously pointed SOLIDWORKS PDM is a client-server architecture system and all the add-ins are hosted on a server and redistributed to clients machines. When the add-in is added as debug add-in - this will not load the add-in dlls to the server. The add-in will be debugged locally from directly from the ",(0,a.kt)("em",{parentName:"p"},"bin")," folder. This also means that another users of the vault won't see the add-in in their systems."),(0,a.kt)("p",null,"Traditionally SOLIDWORKS PDM add-ins are debugged via Notepad process by selecting the path to notepad.exe in the ",(0,a.kt)("em",{parentName:"p"},"Start external program")," action in the Debug settings of the project:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Start debugging in the external Notepad application",src:n(47691).Z,width:"640",height:"346"}),"{ width=640 height=344 }"),(0,a.kt)("p",null,"This allows to start the debugging process by simply running the solution (F5) and this will bring Notepad. In order to start actual debugging it is required to:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Select File->Open menu command in the Notepad"),(0,a.kt)("li",{parentName:"ol"},"Navigate to the local vault folder"),(0,a.kt)("li",{parentName:"ol"},"Change the filter to ",(0,a.kt)("em",{parentName:"li"},"All Files ("),".",(0,a.kt)("em",{parentName:"li"},")")," to see all files in the vault")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Debugging add-in in the Notepad",src:n(48865).Z,width:"400",height:"271"}),"{ width=400 height=271 }"),(0,a.kt)("p",null,"The benefit of this approach - stopping the Visual Studio debugging session (by clicking Stop button in Visual Studio or by closing the Notepad) will release the dlls from the memory so it is not required to restart explorer.exe process to compile new version of the add-in.  "),(0,a.kt)("p",null,"The limitations are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Not possible to have multi-select for files or folders"),(0,a.kt)("li",{parentName:"ul"},"Too many steps required to be performed each time new debug session is started (i.e. click Open menu, navigate to vault, change filter). This may approximately take 5-10 seconds for each debug session.")),(0,a.kt)("p",null,"Much better approach is to use the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/codestackdev/pdm-vault-browser/releases/tag/initial"},"PDM Vault Browser "),"tool. Source code is available on ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/codestackdev/pdm-vault-browser"},"GitHub"),". Source code is provided below (must be compiled in .NET Framework 4.0 otherwise the debug symbols will not be loaded):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},'using System;\nusing System.Linq;\nusing System.Windows.Forms;\n\nnamespace SwPdmVaultBrowser\n{\n    class Program\n    {\n        [STAThread]\n        static void Main(string[] args)\n        {\n            var path = "";\n\n            if (args.Any())\n            {\n                path = args.First();\n            }\n\n            var dlg = new OpenFileDialog()\n            {\n                InitialDirectory = path,\n                Multiselect = true \n            };\n\n            dlg.ShowDialog();\n        }\n    }\n}\n\n')),(0,a.kt)("p",null,"This tool is a simple File Browse Dialog with multi-selection option enabled. The tool also takes a command line argument with the full path to the folder in the PDM vault. So when started it will automatically browse to the specified folder:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Debugging the add-in with PDM Vault Browser",src:n(37755).Z,width:"640",height:"330"}),"{ width=640 height=328 }"),(0,a.kt)("p",null,"Now when starting the debugger it will automatically bring you to the specified folder in the vault without the need to specify the filter.  "),(0,a.kt)("p",null,"Video Demonstration:"),(0,a.kt)("p",null,"{% youtube { id: uVcc4zvsSN0 } %}"),(0,a.kt)("p",null,"Examples of PDM add-ins. Please read the ",(0,a.kt)("a",{parentName:"p",href:"/docs/codestack/solidworks-pdm-api/getting-started/add-ins/create/"},"How To Create SOLIDWORKS PDM Professional Add-In")," article to learn how to build PDM add-in from scratch."),(0,a.kt)("details",null,(0,a.kt)("summary",null,"C# Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},'using EdmLib;\nusing System;\nusing System.Linq;\nusing System.Runtime.InteropServices;\n\nnamespace CodeStack\n{\n    [ComVisible(true)]\n    [Guid("8219E7E8-1765-4699-B509-E9DD84B337B4")]\n    public class PdmAddInSample : IEdmAddIn5\n    {\n        private enum Commands_e\n        {\n            GetIds\n        }\n        \n        public void GetAddInInfo(ref EdmAddInInfo poInfo, IEdmVault5 poVault, IEdmCmdMgr5 poCmdMgr)\n        {\n            poInfo.mbsAddInName = "SW PDM Helper";\n            poInfo.mbsDescription = "Utility functions for SOLIDWORKS PDM";\n            poInfo.mlAddInVersion = 1;\n            poInfo.mlRequiredVersionMajor = 17; //SOLIDWORKS PDM 2017 SP0\n\n            poCmdMgr.AddCmd((int)Commands_e.GetIds, "Get ID");\n        }\n\n        public void OnCmd(ref EdmCmd poCmd, ref Array ppoData)\n        {\n            if (poCmd.meCmdType == EdmCmdType.EdmCmd_Menu)\n            {\n                if (poCmd.mlCmdID == (int)Commands_e.GetIds)\n                {\n                    Func<EdmCmdData, int> getIdFunc = (d) => \n                    {\n                        var isFile = d.mlObjectID1 != 0;\n\n                        if (isFile)\n                        {\n                            return d.mlObjectID1;\n                        }\n                        else\n                        {\n                            return d.mlObjectID2;\n                        }\n                    };\n\n                    var msg = string.Join(Environment.NewLine,\n                        (ppoData as EdmCmdData[]).Select(\n                            d => $"{d.mbsStrData1} - {getIdFunc(d)}").ToArray());\n\n                    (poCmd.mpoVault as IEdmVault10).MsgBox(0, msg);\n                }\n            }\n        }\n    }\n}\n\n'))),(0,a.kt)("details",null,(0,a.kt)("summary",null,"VB.NET Example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Imports EdmLib\nImports System.Runtime.InteropServices\nImports System.Text\n\nNamespace CodeStack\n\n    <ComVisible(True)>\n    <Guid("B761142B-BEEB-4E4D-8332-6B9E9D646B16")>\n    Public Class PdmAddInSample\n        Implements IEdmAddIn5\n\n        Private Enum Commands_e\n            GetIds\n        End Enum\n\n        Public Sub GetAddInInfo(ByRef poInfo As EdmAddInInfo, ByVal poVault As IEdmVault5, ByVal poCmdMgr As IEdmCmdMgr5) Implements IEdmAddIn5.GetAddInInfo\n\n            poInfo.mbsAddInName = "SW PDM Helper"\n            poInfo.mbsDescription = "Utility functions for SOLIDWORKS PDM"\n            poInfo.mlAddInVersion = 1\n            poInfo.mlRequiredVersionMajor = 17\n            poCmdMgr.AddCmd(CInt(Commands_e.GetIds), "Get ID1")\n\n        End Sub\n\n        Public Sub OnCmd(ByRef poCmd As EdmCmd, ByRef ppoData As Array) Implements IEdmAddIn5.OnCmd\n\n            If poCmd.meCmdType = EdmCmdType.EdmCmd_Menu Then\n\n                If poCmd.mlCmdID = Commands_e.GetIds Then\n\n                    Dim msg As New StringBuilder()\n\n                    For Each data As EdmCmdData In ppoData\n                        msg.AppendLine($"{data.mbsStrData1} - {GetId(data)}")\n                    Next\n\n                    TryCast(poCmd.mpoVault, IEdmVault10).MsgBox(0, msg.ToString())\n\n                End If\n            End If\n        End Sub\n\n        Private Function GetId(data As EdmCmdData) As Integer\n\n            Dim isFile = data.mlObjectID1 <> 0\n\n            If isFile Then\n                Return data.mlObjectID1\n            Else\n                Return data.mlObjectID2\n            End If\n\n        End Function\n\n    End Class\n\nEnd Namespace\n\n'))))}c.isMDXComponent=!0},93864:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/debug-addin-09b0cdb665492938ee849157973e5207.png"},53955:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/debug-addins-register-06aeb1c1bc4b99489e227f6b546469c1.png"},48865:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/debug-notepad-1b6c0845011fe5a814e64699a5133166.gif"},37755:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/debug-with-pdm-vault-browser-5588230e87ca88540632c3b0a2132339.png"},47691:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/start-ext-prg-notepad-1f0d7495c42f85dfd63970fce1925c19.png"}}]);