"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[59938],{3905:(e,s,r)=>{r.d(s,{Zo:()=>p,kt:()=>f});var n=r(67294);function t(e,s,r){return s in e?Object.defineProperty(e,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[s]=r,e}function o(e,s){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);s&&(n=n.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var s=1;s<arguments.length;s++){var r=null!=arguments[s]?arguments[s]:{};s%2?o(Object(r),!0).forEach((function(s){t(e,s,r[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))}))}return e}function a(e,s){if(null==e)return{};var r,n,t=function(e,s){if(null==e)return{};var r,n,t={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],s.indexOf(r)>=0||(t[r]=e[r]);return t}(e,s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],s.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var l=n.createContext({}),m=function(e){var s=n.useContext(l),r=s;return e&&(r="function"==typeof e?e(s):i(i({},s),e)),r},p=function(e){var s=m(e.components);return n.createElement(l.Provider,{value:s},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var s=e.children;return n.createElement(n.Fragment,{},s)}},u=n.forwardRef((function(e,s){var r=e.components,t=e.mdxType,o=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),d=m(r),u=t,f=d["".concat(l,".").concat(u)]||d[u]||c[u]||o;return r?n.createElement(f,i(i({ref:s},p),{},{components:r})):n.createElement(f,i({ref:s},p))}));function f(e,s){var r=arguments,t=s&&s.mdxType;if("string"==typeof e||t){var o=r.length,i=new Array(o);i[0]=u;var a={};for(var l in s)hasOwnProperty.call(s,l)&&(a[l]=s[l]);a.originalType=e,a[d]="string"==typeof e?e:t,i[1]=a;for(var m=2;m<o;m++)i[m]=r[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},14421:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>a,toc:()=>m});var n=r(87462),t=(r(67294),r(3905));const o={title:"\u4f7f\u7528 SOLIDWORKS PDM API \u8bbe\u7f6e\u6587\u4ef6\u5939\u6743\u9650\u7684 Power Shell \u811a\u672c",caption:"\u8bbe\u7f6e\u6587\u4ef6\u5939\u6743\u9650"},i=void 0,a={unversionedId:"codestack/solidworks-pdm-api/permissions/set-folder-permissions/index",id:"codestack/solidworks-pdm-api/permissions/set-folder-permissions/index",title:"\u4f7f\u7528 SOLIDWORKS PDM API \u8bbe\u7f6e\u6587\u4ef6\u5939\u6743\u9650\u7684 Power Shell \u811a\u672c",description:"\u4f7f\u7528 SOLIDWORKS PDM API \u4e3a\u6307\u5b9a\u7528\u6237\u8bbe\u7f6e\u6307\u5b9a\u6587\u4ef6\u5939\u7684\u6743\u9650\u7684 Vb.NET Power Shell \u811a\u672c",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-pdm-api/permissions/set-folder-permissions/index.md",sourceDirName:"codestack/solidworks-pdm-api/permissions/set-folder-permissions",slug:"/codestack/solidworks-pdm-api/permissions/set-folder-permissions/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-pdm-api/permissions/set-folder-permissions/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-pdm-api/permissions/set-folder-permissions/index.md",tags:[],version:"current",frontMatter:{title:"\u4f7f\u7528 SOLIDWORKS PDM API \u8bbe\u7f6e\u6587\u4ef6\u5939\u6743\u9650\u7684 Power Shell \u811a\u672c",caption:"\u8bbe\u7f6e\u6587\u4ef6\u5939\u6743\u9650"},sidebar:"tutorialSidebar",previous:{title:"\u5728SOLIDWORKS Professional PDM API\u4e2d\u7ba1\u7406\u6743\u9650",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-pdm-api/permissions/"},next:{title:"pdm tasks",permalink:"/solidworks-GPT/zh-Hans/docs/category/pdm-tasks"}},l={},m=[{value:"labels: permissions,folder",id:"labels-permissionsfolder",level:2},{value:"set-permissions.ps1",id:"set-permissionsps1",level:2},{value:"set-permissions.cmd",id:"set-permissionscmd",level:2}],p={toc:m},d="wrapper";function c(e){let{components:s,...o}=e;return(0,t.kt)(d,(0,n.Z)({},p,o,{components:s,mdxType:"MDXLayout"}),(0,t.kt)("p",null,"\u4f7f\u7528 SOLIDWORKS PDM API \u4e3a\u6307\u5b9a\u7528\u6237\u8bbe\u7f6e\u6307\u5b9a\u6587\u4ef6\u5939\u7684\u6743\u9650\u7684 Vb.NET Power Shell \u811a\u672c\nimage: folder-permissions.png"),(0,t.kt)("h2",{id:"labels-permissionsfolder"},"labels: ","[permissions,folder]"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"SOLIDWORKS PDM \u7ba1\u7406\u9762\u677f\u4e2d\u7684\u6587\u4ef6\u5939\u6743\u9650",src:r(86154).Z,width:"877",height:"827"}),"{ width=450 }"),(0,t.kt)("p",null,"\u6b64 Power Shell \u811a\u672c\u5141\u8bb8\u4f7f\u7528 SOLIDWORKS PDM API \u4e3a\u6307\u5b9a\u7528\u6237\u8bbe\u7f6e\u6307\u5b9a\u6587\u4ef6\u5939\u7684\u6743\u9650\u3002"),(0,t.kt)("p",null,"\u8981\u4f7f\u7528\u811a\u672c\uff0c\u8bf7\u521b\u5efa PowerShell \u6587\u4ef6\u548c\u547d\u4ee4\u884c\u6587\u4ef6\uff0c\u5982\u4e0b\u6240\u793a\u3002"),(0,t.kt)("p",null,"\u9700\u8981\u5c06 SOLIDWORKS PDM \u4e92\u64cd\u4f5c\u6587\u4ef6\u653e\u7f6e\u5728\u4e0e\u811a\u672c\u6587\u4ef6\u76f8\u540c\u7684\u6587\u4ef6\u5939\u4e2d\u3002\u6709\u5173\u751f\u6210\u4e92\u64cd\u4f5c\u6587\u4ef6\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605",(0,t.kt)("a",{parentName:"p",href:"/docs/codestack/solidworks-pdm-api/getting-started#framework-20-or-older"},".NET Framework 2.0 \u4e2d\u7684\u4e92\u64cd\u4f5c"),"\u6587\u7ae0\u3002"),(0,t.kt)("p",null,"\u811a\u672c\u53c2\u6570\uff1a"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("em",{parentName:"li"},"vaultName")," - \u6267\u884c\u64cd\u4f5c\u7684\u5e93\u7684\u540d\u79f0"),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("em",{parentName:"li"},"userName")," - \u6267\u884c\u64cd\u4f5c\u7684\u7528\u6237\u540d\uff08\u5e94\u5177\u6709\u5206\u914d\u6743\u9650\u7684\u6743\u9650\uff09"),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("em",{parentName:"li"},"password")," - \u4e0a\u8ff0\u7528\u6237\u540d\u7684\u5bc6\u7801"),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("em",{parentName:"li"},"folderName")," - \u8981\u66f4\u6539\u6743\u9650\u7684\u6587\u4ef6\u5939\u7684\u5b8c\u6574\u8def\u5f84"),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("em",{parentName:"li"},"targetUserName")," - \u8981\u66f4\u6539\u6743\u9650\u7684\u7528\u6237\u540d"),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("em",{parentName:"li"},"permissions")," - \u8981\u5206\u914d\u7684\u6743\u9650\u3002\u6574\u6570\u503c\uff0c\u8868\u793a\u5355\u4e2a\u6743\u9650\u6216\u4e00\u7ec4\u6743\u9650\u3002\u6743\u9650\u6570\u5b57\u5728",(0,t.kt)("a",{parentName:"li",href:"https://help.solidworks.com/2018/english/api/epdmapi/EPDM.Interop.epdm~EPDM.Interop.epdm.EdmRightFlags.html"},"EdmRightFlags"),"\u4e2d\u5b9a\u4e49\u3002\u5c06\u6240\u9700\u6743\u9650\u7684\u503c\u76f8\u52a0\u4ee5\u5206\u914d\u591a\u4e2a\u503c\uff08\u4f8b\u5982\uff0c\u4e3a\u8bfb\u53d6\u6587\u4ef6\u6743\u9650\u8bbe\u7f6e 1\uff0c\u4e3a\u8bfb\u53d6\u3001\u7b7e\u51fa\u3001\u5220\u9664\u548c\u6dfb\u52a0\u6587\u4ef6\u8bbe\u7f6e 15 ","[1 + 2 + 4 + 8]","\uff09")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'> set-permissions.cmd MyVault admin pwd "D:\\My Vaults\\Vault1\\Folder1" user1 15\n')),(0,t.kt)("h2",{id:"set-permissionsps1"},"set-permissions.ps1"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-ps1"},'$vaultName=$args[0]\n$userName=$args[1]\n$password=$args[2]\n$folderName=$args[3]\n$targetUserName=$args[4]\n$permissions=$args[5]\n\n$ScriptDir = Split-Path $script:MyInvocation.MyCommand.Path\n\n$Assem = ( \n    $ScriptDir + "\\Interop.EdmLib.dll"\n    ) \n    \n$Source = @"\nImports System\nImports System.IO\nImports EdmLib\n\nPublic Class SwPdmTools\n\n    Shared Sub New()\n        AddHandler AppDomain.CurrentDomain.AssemblyResolve, AddressOf OnAssemblyResolve\n    End Sub\n\n    Public Shared Sub LoadLibrary(ParamArray libs As Object())\n        For Each [lib] As String In libs\n            Console.WriteLine(String.Format("Loading library: {0}", [lib]))\n            Dim assm As System.Reflection.Assembly = System.Reflection.Assembly.LoadFrom([lib])\n            Console.WriteLine(assm.GetName().ToString())\n        Next\n    End Sub\n\n    Private Shared Function OnAssemblyResolve(ByVal sender As Object, ByVal args As ResolveEventArgs) As System.Reflection.Assembly\n        For Each assm As System.Reflection.Assembly In AppDomain.CurrentDomain.GetAssemblies()\n\n            If assm.GetName().ToString() = args.Name Then\n                Return assm\n            End If\n        Next\n\n        Return Nothing\n    End Function\n    \n    Public Shared Sub SetFolderPermissions(vaultName As String, userName As String, password As String, folderName As String, targetUserName As String, permissions As Integer)\n\n        Try\n            Dim vault As IEdmVault7 = New EdmVault5\n            vault.Login(userName, password, vaultName)\n\n            If vault.IsLoggedIn Then\n\n                Dim folder As IEdmFolder7 = vault.GetFolderFromPath(folderName)\n\n                If Not folder Is Nothing Then\n\n                    Dim userMgr As IEdmUserMgr7\n                    userMgr = vault.CreateUtility(EdmUtility.EdmUtil_UserMgr)\n\n                    Dim targetUser As IEdmUser5 = userMgr.GetUser(targetUserName)\n\n                    If Not targetUser Is Nothing Then\n\n                        Dim perm As EdmFolderPermission = New EdmFolderPermission()\n                        perm.meOwnerType = EdmObjectType.EdmObject_User\n                        perm.mlOwnerID = targetUser.ID\n                        perm.mlEdmRightFlag = permissions\n                        perm.mlFolderID = folder.ID\n                        userMgr.SetFolderPermissions(New EdmFolderPermission() {perm})\n\n                    Else\n                        Throw New NullReferenceException("Failed to find a user")\n                    End If\n\n                Else\n                    Throw New NullReferenceException("Failed to find a folder")\n                End If\n            Else\n                Throw New NullReferenceException("Failed to login to vault")\n            End If\n\n        Catch ex As Exception\n            Console.ForegroundColor = ConsoleColor.DarkRed\n            Console.WriteLine(ex.Message)\n            Console.ResetColor()\n        End Try\n\n    End Sub\n\nEnd Class\n"@\n\nAdd-Type -TypeDefinition $Source -ReferencedAssemblies $Assem -Language VisualBasic\n\n[SwPdmTools]::LoadLibrary($Assem)\n[SwPdmTools]::SetFolderPermissions($vaultName, $userName, $password, $folderName, $targetUserName, $permissions)\n')),(0,t.kt)("h2",{id:"set-permissionscmd"},"set-permissions.cmd"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-cmd"},'SET vaultName=%1\nSET userName=%2\nSET password=%3\nSET folderName=%4\nSET targetUserName=%5\nSET permissions=%6\n\nPowerShell -NoProfile -ExecutionPolicy Bypass -File "%~dp0set-permissions.ps1" %vaultName% %userName% %password% %folderName% %targetUserName% %permissions%\n')))}c.isMDXComponent=!0},86154:(e,s,r)=>{r.d(s,{Z:()=>n});const n=r.p+"assets/images/folder-permissions-cac42c3e8332348938bbd54416b6e8c9.png"}}]);