"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[60678],{3905:(e,r,o)=>{o.d(r,{Zo:()=>l,kt:()=>g});var t=o(67294);function n(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function s(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}function a(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?s(Object(o),!0).forEach((function(r){n(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}function i(e,r){if(null==e)return{};var o,t,n=function(e,r){if(null==e)return{};var o,t,n={},s=Object.keys(e);for(t=0;t<s.length;t++)o=s[t],r.indexOf(o)>=0||(n[o]=e[o]);return n}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)o=s[t],r.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var c=t.createContext({}),d=function(e){var r=t.useContext(c),o=r;return e&&(o="function"==typeof e?e(r):a(a({},r),e)),o},l=function(e){var r=d(e.components);return t.createElement(c.Provider,{value:r},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},m=t.forwardRef((function(e,r){var o=e.components,n=e.mdxType,s=e.originalType,c=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),p=d(o),m=n,g=p["".concat(c,".").concat(m)]||p[m]||u[m]||s;return o?t.createElement(g,a(a({ref:r},l),{},{components:o})):t.createElement(g,a({ref:r},l))}));function g(e,r){var o=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var s=o.length,a=new Array(s);a[0]=m;var i={};for(var c in r)hasOwnProperty.call(r,c)&&(i[c]=r[c]);i.originalType=e,i[p]="string"==typeof e?e:n,a[1]=i;for(var d=2;d<s;d++)a[d]=o[d];return t.createElement.apply(null,a)}return t.createElement.apply(null,o)}m.displayName="MDXCreateElement"},28606:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var t=o(87462),n=(o(67294),o(3905));const s={layout:"sw-tool",title:"Upgrade cosmetic threads in active SOLIDWORKS part or assembly using SOLIDWORKS API",caption:"Upgrade Cosmetic Threads",description:"VBA macro upgrades cosmetic threads to a new (SOLIDWORKS 2020) version which allows to improve performance of the document",image:"upgrade-cosmetic-thread.png",labels:["api","upgrade","performance","cosmetic thread"],group:"Performance"},a=void 0,i={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads/index",title:"Upgrade cosmetic threads in active SOLIDWORKS part or assembly using SOLIDWORKS API",description:"VBA macro upgrades cosmetic threads to a new (SOLIDWORKS 2020) version which allows to improve performance of the document",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",title:"Upgrade cosmetic threads in active SOLIDWORKS part or assembly using SOLIDWORKS API",caption:"Upgrade Cosmetic Threads",description:"VBA macro upgrades cosmetic threads to a new (SOLIDWORKS 2020) version which allows to improve performance of the document",image:"upgrade-cosmetic-thread.png",labels:["api","upgrade","performance","cosmetic thread"],group:"Performance"},sidebar:"tutorialSidebar",previous:{title:"Macro to suspend rebuild operation in SOLIDWORKS model using API",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/suspend-rebuild/"},next:{title:"Generate report for the SOLIDWORKS file versions (created and last saved) for all the files in the folder",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report/"}},c={},d=[],l={toc:d},p="wrapper";function u(e){let{components:r,...s}=e;return(0,n.kt)(p,(0,t.Z)({},l,s,{components:r,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Upgrade cosmetic threads command",src:o(32828).Z,width:"526",height:"566"}),"{ width=500 }"),(0,n.kt)("p",null,"This macro invokes the ",(0,n.kt)("em",{parentName:"p"},"Upgrade cosmetic thread features")," command in SOLIDWORKS part and assembly which may improve the performance of the document."),(0,n.kt)("p",null,"This macro will be beneficial to use along with task automation software such as ",(0,n.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2019/English/SolidWorks/sldworks/c_SOLIDWORKS_Task_Scheduler_Overview.htm"},"SOLIDWORKS Task Scheduler")," or ",(0,n.kt)("a",{parentName:"p",href:"https://cadplus.xarial.com/batch/"},"Batch+"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Dim swApp As SldWorks.SldWorks\nDim swModel As SldWorks.ModelDoc2\n\nSub main()\n\n    Set swApp = Application.SldWorks\n\n    Dim allowUpgrade As Boolean\n    allowUpgrade = swApp.GetUserPreferenceToggle(swUserPreferenceToggle_e.swEnableAllowCosmeticThreadsUpgrade)\n\ntry:\n    On Error GoTo catch\n    \n    Set swModel = swApp.ActiveDoc\n        \n    If Not swModel Is Nothing Then\n                \n        swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swEnableAllowCosmeticThreadsUpgrade, True\n        \n        If False = swModel.Extension.UpgradeLegacyCThreads() Then\n            Debug.Print "Thread is not upgraded"\n        End If\n            \n    Else\n        Err.Raise vbError, "", "Please open document"\n    End If\n    \n    GoTo finally\n    \ncatch:\n    swApp.SendMsgToUser2 Err.Description, swMessageBoxIcon_e.swMbStop, swMessageBoxBtn_e.swMbOk\nfinally:\n    \n    swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swEnableAllowCosmeticThreadsUpgrade, allowUpgrade\n\nEnd Sub\n')))}u.isMDXComponent=!0},32828:(e,r,o)=>{o.d(r,{Z:()=>t});const t=o.p+"assets/images/upgrade-cosmetic-thread-c84c84d34b28bbdea45a32a114b84f29.png"}}]);