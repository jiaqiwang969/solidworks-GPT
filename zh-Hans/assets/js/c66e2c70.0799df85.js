"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[87303],{3905:(e,n,r)=>{r.d(n,{Zo:()=>d,kt:()=>w});var s=r(67294);function t(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,s)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function a(e,n){if(null==e)return{};var r,s,t=function(e,n){if(null==e)return{};var r,s,t={},o=Object.keys(e);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)>=0||(t[r]=e[r]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)r=o[s],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var l=s.createContext({}),c=function(e){var n=s.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},d=function(e){var n=c(e.components);return s.createElement(l.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},f=s.forwardRef((function(e,n){var r=e.components,t=e.mdxType,o=e.originalType,l=e.parentName,d=a(e,["components","mdxType","originalType","parentName"]),u=c(r),f=t,w=u["".concat(l,".").concat(f)]||u[f]||p[f]||o;return r?s.createElement(w,i(i({ref:n},d),{},{components:r})):s.createElement(w,i({ref:n},d))}));function w(e,n){var r=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var o=r.length,i=new Array(o);i[0]=f;var a={};for(var l in n)hasOwnProperty.call(n,l)&&(a[l]=n[l]);a.originalType=e,a[u]="string"==typeof e?e:t,i[1]=a;for(var c=2;c<o;c++)i[c]=r[c];return s.createElement.apply(null,i)}return s.createElement.apply(null,r)}f.displayName="MDXCreateElement"},23906:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var s=r(87462),t=(r(67294),r(3905));const o={image:"solidworks-file-versions-report.png"},i=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report/index",title:"index",description:"SOLIDWORKS\u6587\u4ef6\u7248\u672c\u62a5\u544a { width=500 }",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/versions-report/index.md",tags:[],version:"current",frontMatter:{image:"solidworks-file-versions-report.png"},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528SOLIDWORKS API\u5347\u7ea7\u6d3b\u52a8SOLIDWORKS\u96f6\u4ef6\u6216\u88c5\u914d\u4e2d\u7684\u7f8e\u5316\u87ba\u7eb9",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/upgrade-cosmetic-threads/"},next:{title:"Managing SOLIDWORKS Documents with the API",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/documents/"}},l={},c=[],d={toc:c},u="wrapper";function p(e){let{components:n,...o}=e;return(0,t.kt)(u,(0,s.Z)({},d,o,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"SOLIDWORKS\u6587\u4ef6\u7248\u672c\u62a5\u544a",src:r(43762).Z,width:"1227",height:"692"})," { width=500 }"),(0,t.kt)("p",null,"\u8fd9\u4e2aVBA\u5b8f\u751f\u6210\u4e00\u4e2aCSV\u62a5\u544a\uff08\u53ef\u4ee5\u5728Excel\u4e2d\u6253\u5f00\uff09\uff0c\u62a5\u544a\u4e86\u6307\u5b9a\u6587\u4ef6\u5939\u4e2dSOLIDWORKS\u6587\u4ef6\u7684\u521b\u5efa\u548c\u6700\u540e\u4fdd\u5b58\u7248\u672c\u3002"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"\u8fd9\u4e2a\u5b8f\u4e0d\u4f1a\u9010\u4e2a\u6253\u5f00\u6bcf\u4e2a\u6a21\u578b\uff0c\u8fd9\u663e\u8457\u51cf\u5c11\u4e86\u5904\u7406\u65f6\u95f4\u3002")),(0,t.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539\u4e0b\u9762\u7684\u5e38\u91cf\u6765\u914d\u7f6e\u5b8f\u7684\u8f93\u5165\u548c\u8f93\u51fa\u53c2\u6570\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-vb"},'Const INPUT_FOLDER_PATH As String = "D:\\MyModels" \'SOLIDWORKS\u6587\u4ef6\u6240\u5728\u6587\u4ef6\u5939\u7684\u5b8c\u6574\u8def\u5f84\nConst OUT_FILE_PATH As String = "D:\\sw-file-versions.csv" \'\u62a5\u544a\u7684\u8f93\u51faCSV\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\nConst FILES_FILTER As String = "*.sld*" \'\u652f\u6301\u901a\u914d\u7b26\u7684\u6587\u4ef6\u8fc7\u6ee4\u5668\nConst INCLUDE_SUB_FOLDERS As Boolean = True \'True\u8868\u793a\u5904\u7406\u5b50\u6587\u4ef6\u5939\uff0cFalse\u8868\u793a\u53ea\u5904\u7406\u9876\u5c42\u6587\u4ef6\n')),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-vb"},'Const INPUT_FOLDER_PATH As String = "D:\\MyModels"\nConst OUT_FILE_PATH As String = "D:\\sw-file-versions.csv"\nConst FILES_FILTER As String = "*.sld*"\nConst INCLUDE_SUB_FOLDERS As Boolean = True\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Dim vFilePaths As Variant\n    vFilePaths = GetFiles(INPUT_FOLDER_PATH, INCLUDE_SUB_FOLDERS, FILES_FILTER)\n    \n    Dim i As Integer\n    \n    Dim fileNo As Integer\n    fileNo = FreeFile\n    \n    Open OUT_FILE_PATH For Output As #fileNo\n \n    Print #fileNo, "\u6587\u4ef6\u8def\u5f84,\u521b\u5efa\u65e5\u671f,\u6700\u540e\u4fdd\u5b58\u65e5\u671f"\n    \n    For i = 0 To UBound(vFilePaths)\n    \n        Dim filePath As String\n        filePath = vFilePaths(i)\n        Dim vVers As Variant\n        vVers = swApp.VersionHistory(filePath)\n            \n        Dim swCreatedVers As String\n        Dim swLastSavedVers As String\n        \n        If Not IsEmpty(vVers) Then\n            swCreatedVers = ConvertFileVersionToSwMajorVersion(ExtractSwRevisonFromHistoryRecord(CStr(vVers(0))))\n            swLastSavedVers = ConvertFileVersionToSwMajorVersion(ExtractSwRevisonFromHistoryRecord(CStr(vVers(UBound(vVers)))))\n        Else\n            swCreatedVers = "???"\n            swLastSavedVers = "???"\n        End If\n        \n        Print #fileNo, filePath & "," & swCreatedVers & "," & swLastSavedVers\n        \n    Next\n    \n    Close #fileNo\n\nEnd Sub\n\nFunction GetFiles(path As String, includeSubFolders As Boolean, Optional filter As String) As Variant\n\n    Dim paths() As String\n    Dim isInit As Boolean\n    \n    isInit = False\n    \n    Dim fso As Object\n    Set fso = CreateObject("Scripting.FileSystemObject")\n    \n    Dim folder As Object\n    Set folder = fso.GetFolder(path)\n    \n    CollectFilesFromFolder folder, includeSubFolders, filter, paths, isInit\n    \n    If isInit Then\n        GetFiles = paths\n    Else\n        GetFiles = Empty\n    End If\n    \nEnd Function\n\nSub CollectFilesFromFolder(folder As Object, includeSubFolders As Boolean, filter As String, ByRef paths() As String, ByRef isInit As Boolean)\n    \n    For Each file In folder.files\n        \n        If LCase(file.path) Like LCase(filter) Then\n            If Not isInit Then\n                ReDim paths(0)\n                isInit = True\n            Else\n                ReDim Preserve paths(UBound(paths) + 1)\n            End If\n            paths(UBound(paths)) = file.path\n        End If\n    Next\n    \n    If includeSubFolders Then\n        Dim subFolder As Object\n        For Each subFolder In folder.SubFolders\n            CollectFilesFromFolder subFolder, includeSubFolders, filter, paths, isInit\n        Next\n    End If\n    \nEnd Sub\n\nFunction ExtractSwRevisonFromHistoryRecord(fileVers As String) As String\n    \n    ExtractSwRevisonFromHistoryRecord = Left(fileVers, InStr(fileVers, "[") - 1)\n    \nEnd Function\n\nFunction ConvertFileVersionToSwMajorVersion(versNumber As Integer) As String\n    \n    Dim swVersMajor As String\n    \n    If versNumber >= 5000 Then\n        swVersMajor = 2012 + (versNumber - 5000) / 1000\n    Else\n        Select Case versNumber\n            Case 44\n                swVersMajor = 95\n            Case 243\n                swVersMajor = 96\n            Case 483\n                swVersMajor = 97\n            Case 629\n                swVersMajor = "97Plus"\n            Case 822\n                swVersMajor = 98\n            Case 1008\n                swVersMajor = "98Plus"\n            Case 1137\n                swVersMajor = 99\n            Case 1500\n                swVersMajor = 2000\n            Case 1750\n                swVersMajor = 2001\n            Case 1950\n                swVersMajor = "2001Plus"\n            Case 2200\n                swVersMajor = 2003\n            Case 2500\n                swVersMajor = 2004\n            Case 2800\n                swVersMajor = 2005\n            Case 3100\n                swVersMajor = 2006\n            Case 3400\n                swVersMajor = 2007\n            Case 3800\n                swVersMajor = 2008\n            Case 4100\n                swVersMajor = 2009\n            Case 4400\n                swVersMajor = 2010\n            Case 4700\n                swVersMajor = 2011\n        End Select\n    End If\n    \n    ConvertFileVersionToSwMajorVersion = "SOLIDWORKS " & swVersMajor\n    \nEnd Function\n\n\n')))}p.isMDXComponent=!0},43762:(e,n,r)=>{r.d(n,{Z:()=>s});const s=r.p+"assets/images/solidworks-file-versions-report-9642a2dfdc8ddf431f21a45e6124c0c1.png"}}]);