"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[12477],{3905:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>g});var r=t(67294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var p=r.createContext({}),c=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},l=function(e){var n=c(e.components);return r.createElement(p.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,s=e.mdxType,o=e.originalType,p=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),u=c(t),m=s,g=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return t?r.createElement(g,a(a({ref:n},l),{},{components:t})):r.createElement(g,a({ref:n},l))}));function g(e,n){var t=arguments,s=n&&n.mdxType;if("string"==typeof e||s){var o=t.length,a=new Array(o);a[0]=m;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i[u]="string"==typeof e?e:s,a[1]=i;for(var c=2;c<o;c++)a[c]=t[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},61866:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var r=t(87462),s=(t(67294),t(3905));const o={title:"\u4f7f\u7528\u5b8f\u5728SOLIDWORKS\u4e2d\u4f7f\u7528API\u66f4\u6539\u7cfb\u7edf\u9875\u9762\u8bbe\u7f6e\u9009\u9879",image:"page-setup.png",labels:["\u6253\u5370","\u9875\u9762\u8bbe\u7f6e","\u9996\u9009\u9879"]},a=void 0,i={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/system-page-setup/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/system-page-setup/index",title:"\u4f7f\u7528\u5b8f\u5728SOLIDWORKS\u4e2d\u4f7f\u7528API\u66f4\u6539\u7cfb\u7edf\u9875\u9762\u8bbe\u7f6e\u9009\u9879",description:"\u9875\u9762\u8bbe\u7f6e{ width=350 }",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/system-page-setup/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/system-page-setup",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/system-page-setup/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/system-page-setup/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/system-page-setup/index.md",tags:[],version:"current",frontMatter:{title:"\u4f7f\u7528\u5b8f\u5728SOLIDWORKS\u4e2d\u4f7f\u7528API\u66f4\u6539\u7cfb\u7edf\u9875\u9762\u8bbe\u7f6e\u9009\u9879",image:"page-setup.png",labels:["\u6253\u5370","\u9875\u9762\u8bbe\u7f6e","\u9996\u9009\u9879"]},sidebar:"tutorialSidebar",previous:{title:"\u4fee\u590d\u8fd0\u884c\u65e7\u7248 SWBasic (*.swb) SOLIDWORKS \u5b8f\u65f6\u7684\u9519\u8bef",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/swb-macro-error/"},next:{title:"\u4f7f\u7528SOLIDWORKS API\u81ea\u52a8\u5316\u8868\u683c\uff08BOM\u3001\u901a\u7528\u3001\u4fee\u8ba2\u7b49\uff09",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/tables/"}},p={},c=[],l={toc:c},u="wrapper";function d(e){let{components:n,...o}=e;return(0,s.kt)(u,(0,r.Z)({},l,o,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"\u9875\u9762\u8bbe\u7f6e",src:t(46537).Z,width:"509",height:"518"}),"{ width=350 }"),(0,s.kt)("p",null,"\u672c\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528SOLIDWORKS API\u66f4\u6539\u7cfb\u7edf\u9875\u9762\u8bbe\u7f6e\u9009\u9879\uff08\u7eb8\u5f20\u5927\u5c0f\u548c\u6bd4\u4f8b\uff09\uff0c\u5e76\u5c06\u5f53\u524d\u6587\u6863\u9009\u9879\u8bbe\u7f6e\u4e3a\u4f7f\u7528\u7cfb\u7edf\u8bbe\u7f6e\u3002"),(0,s.kt)("p",null,"\u6b64\u793a\u4f8b\u8fd8\u6f14\u793a\u4e86\u5982\u4f55\u901a\u8fc7\u6307\u5b9a\u7eb8\u5f20\u540d\u79f0\u68c0\u7d22",(0,s.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2016/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IPageSetup~PrinterPaperSize.html"},"IPageSetup::PrinterPaperSize"),"\u7684\u7cfb\u7edf\u7279\u5b9a\u7eb8\u5f20\u5927\u5c0f\u6574\u6570\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-vb"},'Private Declare PtrSafe Function DeviceCapabilities Lib "winspool.drv" Alias "DeviceCapabilitiesA" (ByVal lpDeviceName As String, ByVal lpPort As String, ByVal iIndex As Long, ByRef lpOutput As Any, ByRef lpDevMode As Any) As Long\n\nConst PAPER_NAME As String = "A4"\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    Dim swModel As SldWorks.ModelDoc2\n    \n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n        \n        Dim swAppPageSetup As SldWorks.PageSetup\n        Set swAppPageSetup = swModel.Extension.AppPageSetup\n        \n        swAppPageSetup.PrinterPaperSize = GetPaper(swModel.Printer, PAPER_NAME)\n        swAppPageSetup.ScaleToFit = False\n        swAppPageSetup.Scale2 = 50\n        \n        swModel.Extension.UsePageSetup = swPageSetupInUse_e.swPageSetupInUse_Application\n        \n    Else\n        MsgBox "\u8bf7\u6253\u5f00\u6a21\u578b"\n    End If\n    \nEnd Sub\n\nPublic Function GetPaper(printerName As String, paperName As String) As Integer\n    \n    Const DC_PAPERNAMES As Integer = &H10\n    Const DC_PAPERS As Integer = &H2\n    \n    Dim papersCount As Integer\n    papersCount = DeviceCapabilities(printerName, "", DC_PAPERS, ByVal vbNullString, 0)\n    \n    If papersCount > 0 Then\n    \n        Dim papersCodes() As Integer\n        ReDim papersCodes(papersCount - 1)\n        \n        DeviceCapabilities printerName, "", DC_PAPERS, papersCodes(0), 0\n        \n        Dim papersNames As String\n        papersNames = String$(64 * papersCount, 0)\n        DeviceCapabilities printerName, "", DC_PAPERNAMES, ByVal papersNames, 0\n      \n        Dim i As Integer\n        \n        For i = 0 To papersCount\n            If LCase(ParsePaperName(papersNames, 64 * i + 1)) = LCase(paperName) Then\n                GetPaper = papersCodes(i)\n            End If\n        Next\n    Else\n        Err.Raise vbError, "", "\u6307\u5b9a\u7684\u6253\u5370\u673a\u6ca1\u6709\u53ef\u7528\u7684\u5c3a\u5bf8"\n    End If\n    \nEnd Function\n\nFunction ParsePaperName(papersNames As String, offset As Integer) As String\n\n    Dim paperName As String\n    \n    paperName = Mid(papersNames, offset, 64)\n    \n    Dim nullCharIndex As Integer\n    nullCharIndex = InStr(paperName, vbNullChar)\n    \n    If nullCharIndex <> 0 Then\n        paperName = Left$(paperName, nullCharIndex - 1)\n    End If\n     \n    ParsePaperName = paperName\n    \nEnd Function\n')))}d.isMDXComponent=!0},46537:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/page-setup-07ba795e5f55ac51f3258b7f6530ac5c.png"}}]);