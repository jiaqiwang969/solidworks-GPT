"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[86681],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>A});var s=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,s,o=function(e,n){if(null==e)return{};var t,s,o={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=s.createContext({}),d=function(e){var n=s.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=d(e.components);return s.createElement(l.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},c=s.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=d(t),c=o,A=u["".concat(l,".").concat(c)]||u[c]||m[c]||r;return t?s.createElement(A,a(a({ref:n},p),{},{components:t})):s.createElement(A,a({ref:n},p))}));function A(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,a=new Array(r);a[0]=c;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[u]="string"==typeof e?e:o,a[1]=i;for(var d=2;d<r;d++)a[d]=t[d];return s.createElement.apply(null,a)}return s.createElement.apply(null,t)}c.displayName="MDXCreateElement"},28265:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var s=t(87462),o=(t(67294),t(3905));const r={layout:"sw-tool",title:"\u4eceSOLIDWORKS\u96f6\u4ef6\u6216\u88c5\u914d\u4ef6\u7ec4\u4ef6\u5bfc\u51fa\u5c55\u5f00\u56fe\u6848",image:"assembly-flat-pattern.svg",labels:["\u4f7f\u7528\u4f4d\u7f6e","\u7236\u7ea7","\u7ec4\u4ef6"],group:"\u5bfc\u5165/\u5bfc\u51fa","redirect-from":["/solidworks-api/document/sheet-metal/export-assembly-components/"]},a=void 0,i={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-all-flat-patterns/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-all-flat-patterns/index",title:"\u4eceSOLIDWORKS\u96f6\u4ef6\u6216\u88c5\u914d\u4ef6\u7ec4\u4ef6\u5bfc\u51fa\u5c55\u5f00\u56fe\u6848",description:"\u8fd9\u4e2aVBA\u5b8f\u5141\u8bb8\u4ece\u6d3b\u52a8SOLIDWORKS\u88c5\u914d\u6216\u6d3b\u52a8\u96f6\u4ef6\u6587\u6863\u4e2d\u7684\u6240\u6709\u94a3\u91d1\u7ec4\u4ef6\u5bfc\u51fa\u6240\u6709\u5c55\u5f00\u56fe\u6848\u5230DXF/DWG\u3002",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-all-flat-patterns/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-all-flat-patterns",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-all-flat-patterns/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-all-flat-patterns/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-all-flat-patterns/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",title:"\u4eceSOLIDWORKS\u96f6\u4ef6\u6216\u88c5\u914d\u4ef6\u7ec4\u4ef6\u5bfc\u51fa\u5c55\u5f00\u56fe\u6848",image:"assembly-flat-pattern.svg",labels:["\u4f7f\u7528\u4f4d\u7f6e","\u7236\u7ea7","\u7ec4\u4ef6"],group:"\u5bfc\u5165/\u5bfc\u51fa","redirect-from":["/solidworks-api/document/sheet-metal/export-assembly-components/"]},sidebar:"tutorialSidebar",previous:{title:"Exclude Selected Entities from Cut List",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/exclude-selected-bodies/"},next:{title:"Macro to export selected bodies to foreign format",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/export-bodies/"}},l={},d=[{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2},{value:"\u8f93\u51fa\u540d\u79f0\u6a21\u677f",id:"\u8f93\u51fa\u540d\u79f0\u6a21\u677f",level:3},{value:"\u5728\u6587\u4ef6\u540d\u4e2d\u5305\u542b\u6570\u91cf",id:"\u5728\u6587\u4ef6\u540d\u4e2d\u5305\u542b\u6570\u91cf",level:3},{value:"\u5c55\u5f00\u56fe\u6848\u9009\u9879",id:"\u5c55\u5f00\u56fe\u6848\u9009\u9879",level:3},{value:"\u8df3\u8fc7\u5df2\u521b\u5efa\u7684\u6587\u4ef6",id:"\u8df3\u8fc7\u5df2\u521b\u5efa\u7684\u6587\u4ef6",level:2},{value:"\u6545\u969c\u6392\u9664",id:"\u6545\u969c\u6392\u9664",level:2},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:2}],p={toc:d},u="wrapper";function m(e){let{components:n,...r}=e;return(0,o.kt)(u,(0,s.Z)({},p,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"\u8fd9\u4e2aVBA\u5b8f\u5141\u8bb8\u4ece\u6d3b\u52a8SOLIDWORKS\u88c5\u914d\u6216\u6d3b\u52a8\u96f6\u4ef6\u6587\u6863\u4e2d\u7684\u6240\u6709\u94a3\u91d1\u7ec4\u4ef6\u5bfc\u51fa\u6240\u6709\u5c55\u5f00\u56fe\u6848\u5230DXF/DWG\u3002"),(0,o.kt)("p",null,"\u5b8f\u5141\u8bb8\u5728\u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\u540d\u65f6\u7075\u6d3b\u4f7f\u7528\u5360\u4f4d\u7b26\uff08\u539f\u59cb\u6587\u4ef6\u540d\u3001\u7279\u5f81\u540d\u3001\u81ea\u5b9a\u4e49\u5c5e\u6027\u3001\u5207\u5272\u5217\u8868\u81ea\u5b9a\u4e49\u5c5e\u6027\u7b49\uff09\u4e0e\u81ea\u7531\u6587\u672c\u7ed3\u5408\uff0c\u5e76\u652f\u6301\u6307\u5b9a\u5b50\u6587\u4ef6\u5939\u3002"),(0,o.kt)("p",null,"\u5bfc\u51fa\u5b8c\u6210\u540e\u5c06\u663e\u793a\u4ee5\u4e0b\u6d88\u606f\u6846\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"\u5bfc\u51fa\u5b8c\u6210\u65f6\u663e\u793a\u7684\u6d88\u606f\u6846",src:t(71904).Z,width:"354",height:"128"})),(0,o.kt)("p",null,"{%youtube id: FtXkdSlekG8 %}"),(0,o.kt)("h2",{id:"\u914d\u7f6e"},"\u914d\u7f6e"),(0,o.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539",(0,o.kt)("strong",{parentName:"p"},"OUT_NAME_TEMPLATE"),"\u548c",(0,o.kt)("strong",{parentName:"p"},"FLAT_PATTERN_OPTIONS"),"\u5e38\u91cf\u6765\u914d\u7f6e\u5b8f\u3002"),(0,o.kt)("h3",{id:"\u8f93\u51fa\u540d\u79f0\u6a21\u677f"},"\u8f93\u51fa\u540d\u79f0\u6a21\u677f"),(0,o.kt)("p",null,"\u6b64\u5e38\u91cf\u5141\u8bb8\u6307\u5b9a\u5c55\u5f00\u56fe\u6848\u7684\u8f93\u51fa\u8def\u5f84\u6a21\u677f\u3002"),(0,o.kt)("p",null,"\u8fd9\u53ef\u4ee5\u662f\u7edd\u5bf9\u8def\u5f84\u6216\u76f8\u5bf9\u8def\u5f84\u3002\u5982\u679c\u662f\u540e\u8005\uff0c\u5219\u7ed3\u679c\u5c06\u76f8\u5bf9\u4e8e\u88c5\u914d\u76ee\u5f55\u4fdd\u5b58\u3002"),(0,o.kt)("p",null,"\u6269\u5c55\u540d\uff08.dxf\u6216.dwg\uff09\u5fc5\u987b\u4f5c\u4e3a\u547d\u540d\u6a21\u677f\u7684\u4e00\u90e8\u5206\u6307\u5b9a\u3002"),(0,o.kt)("p",null,"\u652f\u6301\u4ee5\u4e0b\u5360\u4f4d\u7b26\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"<","_","FileName","_","> - \u94a3\u91d1\u90e8\u4ef6\u6240\u5728\u7684\u96f6\u4ef6\u6587\u4ef6\u7684\u540d\u79f0\uff08\u4e0d\u5305\u62ec\u6269\u5c55\u540d\uff09"),(0,o.kt)("li",{parentName:"ul"},"<","_","FeatureName","_","> - \u5c55\u5f00\u56fe\u6848\u7279\u5f81\u7684\u540d\u79f0"),(0,o.kt)("li",{parentName:"ul"},"<","_","ConfName","_","> - \u6b64\u5c55\u5f00\u56fe\u6848\u7684\u914d\u7f6e\u7684\u540d\u79f0\uff08\u5373\u7ec4\u4ef6\u7684\u5f15\u7528\u914d\u7f6e\uff09"),(0,o.kt)("li",{parentName:"ul"},"<","_","AssmFileName","_","> - \u4e3b\u88c5\u914d\u7684\u540d\u79f0"),(0,o.kt)("li",{parentName:"ul"},"<$CLPRP:","[PropertyName]","> - \u4efb\u4f55\u5207\u5272\u5217\u8868\u5c5e\u6027\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u8bfb\u53d6\u503c\uff0c\u4f8b\u5982\\<Thickness",">","\u5c06\u88ab\u66ff\u6362\u4e3a\u5207\u5272\u5217\u8868\u81ea\u5b9a\u4e49\u5c5e\u6027",(0,o.kt)("em",{parentName:"li"},"Thickness"),"\u7684\u503c"),(0,o.kt)("li",{parentName:"ul"},"<$PRP:","[PropertyName]","> - \u4efb\u4f55\u94a3\u91d1\u96f6\u4ef6\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u8bfb\u53d6\u503c\uff0c\u4f8b\u5982\\<PartNo",">","\u5c06\u88ab\u66ff\u6362\u4e3a\u5207\u5272\u5217\u8868\u81ea\u5b9a\u4e49\u5c5e\u6027",(0,o.kt)("em",{parentName:"li"},"PartNo"),"\u7684\u503c"),(0,o.kt)("li",{parentName:"ul"},"<$ASSMPRP:","[PropertyName]","> - \u4efb\u4f55\u4e3b\u88c5\u914d\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u8bfb\u53d6\u503c\uff0c\u4f8b\u5982\\<ProductId",">","\u5c06\u88ab\u66ff\u6362\u4e3a\u5207\u5272\u5217\u8868\u81ea\u5b9a\u4e49\u5c5e\u6027",(0,o.kt)("em",{parentName:"li"},"ProductId"),"\u7684\u503c")),(0,o.kt)("p",null,"\u5360\u4f4d\u7b26\u5c06\u5728\u8fd0\u884c\u65f6\u4e3a\u6bcf\u4e2a\u5c55\u5f00\u56fe\u6848\u89e3\u6790\u3002"),(0,o.kt)("p",null,"\u4f8b\u5982\uff0c\u4ee5\u4e0b\u503c\u5c06\u4f7f\u7528\u96f6\u4ef6\u6587\u6863\u7684\u540d\u79f0\u5c06\u5c55\u5f00\u56fe\u6848\u4fdd\u5b58\u5728\u4e0e\u4e3b\u88c5\u914d\u76f8\u540c\u6587\u4ef6\u5939\u4e2d\u7684",(0,o.kt)("em",{parentName:"p"},"DXFs"),"\u5b50\u6587\u4ef6\u5939\u4e2d\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Const OUT_NAME_TEMPLATE As String = "DXFs\\<_FileName_>.dxf"\n')),(0,o.kt)("p",null,"\u800c\u4ee5\u4e0b\u540d\u79f0\u5c06\u5c06\u6240\u6709\u5c55\u5f00\u56fe\u6848\u4f5c\u4e3aDWG\u6587\u4ef6\u4fdd\u5b58\u5230",(0,o.kt)("em",{parentName:"p"},"D"),"\u9a71\u52a8\u5668\u4e0a\u7684",(0,o.kt)("em",{parentName:"p"},"Output"),"\u6587\u4ef6\u5939\u4e2d\uff0c\u5176\u4e2d\u6587\u4ef6\u540d\u5c06\u4ece\u6bcf\u4e2a\u76f8\u5e94\u5c55\u5f00\u56fe\u6848\u7684",(0,o.kt)("em",{parentName:"p"},"PartNo"),"\u5c5e\u6027\u4e2d\u63d0\u53d6\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Const OUT_NAME_TEMPLATE As String = "D:\\Output\\<$CLPRP:PartNo>.dwg"\n')),(0,o.kt)("p",null,"\u4ee5\u4e0b\u8bbe\u7f6e\u5c06\u521b\u5efa\u4e0e\u5207\u5272\u5217\u8868\u4e2d\u7684",(0,o.kt)("strong",{parentName:"p"},"Thickness"),"\u81ea\u5b9a\u4e49\u5c5e\u6027\u503c\u76f8\u5bf9\u5e94\u7684\u5b50\u6587\u4ef6\u5939\uff0c\u5e76\u4f7f\u7528\u4ece\u4e3b\u88c5\u914d\u4e2d\u63d0\u53d6\u7684",(0,o.kt)("strong",{parentName:"p"},"ProductName"),"\u81ea\u5b9a\u4e49\u5c5e\u6027\u503c\uff0c\u540e\u8ddf\u4e0b\u5212\u7ebf\u7b26\u53f7\u548c\u6765\u81ea\u94a3\u91d1\u96f6\u4ef6\u6587\u6863\u7684",(0,o.kt)("strong",{parentName:"p"},"PartNo"),"\u5c5e\u6027\u503c\u7684\u6587\u4ef6\u540d\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Const OUT_NAME_TEMPLATE As String = "D:\\Output\\<$CLPRP:Thickness>\\<$ASSMPRP:ProductName>_<$PRP:PartNo>.dwg"\n')),(0,o.kt)("h3",{id:"\u5728\u6587\u4ef6\u540d\u4e2d\u5305\u542b\u6570\u91cf"},"\u5728\u6587\u4ef6\u540d\u4e2d\u5305\u542b\u6570\u91cf"),(0,o.kt)("p",null,"\u6b64\u5b8f\u6ca1\u6709\u660e\u786e\u7684\u53d8\u91cf\u6765\u5728\u6587\u4ef6\u540d\u4e2d\u5305\u542b\u5c55\u5f00\u56fe\u6848\u7684\u6570\u91cf\u3002\u4f46\u662f\uff0c\u53ef\u4ee5\u901a\u8fc7\u5305\u542b\u81ea\u52a8",(0,o.kt)("strong",{parentName:"p"},"QUANTITY"),"\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684\u503c\u4e0e",(0,o.kt)("strong",{parentName:"p"},"<$CLPRP:QUANTITY>"),"\u5360\u4f4d\u7b26\u6765\u63d0\u53d6\u591a\u4f53\u94a3\u91d1\u96f6\u4ef6\u7684\u6570\u91cf\u503c\u3002"),(0,o.kt)("p",null,"\u4e3a\u4e86\u5728\u88c5\u914d\u4e2d\u5305\u542b\u7ec4\u4ef6\u6570\u91cf\uff0c\u8bf7\u4f7f\u7528",(0,o.kt)("a",{parentName:"p",href:"/docs/codestack/solidworks-api/document/assembly/components/write-quantities/"},"\u5c06SOLIDWORKS\u88c5\u914d\u4e2d\u7684\u7ec4\u4ef6\u6570\u91cf\u5199\u5165\u81ea\u5b9a\u4e49\u5c5e\u6027"),"\u5b8f\u3002\u5728\u5bfc\u51fa\u4e4b\u524d\u8fd0\u884c\u6b64\u5b8f\u4ee5\u521b\u5efa\u5177\u6709\u6570\u91cf\u503c\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u7136\u540e\u4f7f\u7528",(0,o.kt)("strong",{parentName:"p"},"<$CLPRP:Qty>"),"\u5360\u4f4d\u7b26\u5c06\u5176\u5305\u542b\u5230\u8f93\u51fa\u6587\u4ef6\u540d\u4e2d\u3002"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f\uff0c\u6b64\u5b8f\u4e0d\u4f1a\u5c06\u591a\u4f53\u94a3\u91d1\u96f6\u4ef6\u7684\u6570\u91cf\u4e0e\u7ec4\u4ef6\u6570\u91cf\u76f8\u4e58")),(0,o.kt)("h3",{id:"\u5c55\u5f00\u56fe\u6848\u9009\u9879"},"\u5c55\u5f00\u56fe\u6848\u9009\u9879"),(0,o.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a",(0,o.kt)("strong",{parentName:"p"},"FLAT_PATTERN_OPTIONS"),"\u7684\u503c\u6765\u914d\u7f6e\u9009\u9879\u3002\u4f7f\u7528",(0,o.kt)("strong",{parentName:"p"},"+"),"\u6765\u7ec4\u5408\u9009\u9879"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"\u5c55\u5f00\u56fe\u6848\u5bfc\u51fa\u9009\u9879",src:t(73931).Z,width:"247",height:"455"})),(0,o.kt)("p",null,"\u4f8b\u5982\uff0c\u8981\u5bfc\u51fa\u9690\u85cf\u8fb9\u3001\u5e93\u7279\u5f81\u548c\u6210\u578b\u5de5\u5177\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u8bbe\u7f6e\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},"Const FLAT_PATTERN_OPTIONS As Integer = SheetMetalOptions_e.IncludeHiddenEdges + SheetMetalOptions_e.ExportLibraryFeatures + SheetMetalOptions_e.ExportFormingTools\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f\uff0c\u5fc5\u987b\u59cb\u7ec8\u6307\u5b9a\u51e0\u4f55\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u662f\u5c55\u5f00\u56fe\u6848\u5bfc\u51fa\u6240\u5fc5\u9700\u7684")),(0,o.kt)("h2",{id:"\u8df3\u8fc7\u5df2\u521b\u5efa\u7684\u6587\u4ef6"},"\u8df3\u8fc7\u5df2\u521b\u5efa\u7684\u6587\u4ef6"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"SKIP_EXISTING_FILES"),"\u9009\u9879\u5141\u8bb8\u6307\u5b9a\u5982\u679c\u8f93\u51fa\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u5219\u5b8f\u662f\u5426\u5e94\u91cd\u65b0\u751f\u6210\u8f93\u51fa\u6587\u4ef6\u3002"),(0,o.kt)("p",null,"\u5c06\u6b64\u9009\u9879\u8bbe\u7f6e\u4e3atrue\u4ee5\u8df3\u8fc7\u5982\u679c\u76ee\u6807\u4f4d\u7f6e\u4e0a\u5b58\u5728\u8f93\u51fa\u6587\u4ef6\uff08.dxf\u6216.dwg\uff09\u5219\u4e0d\u5bfc\u51fa\u6587\u4ef6\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},"Const SKIP_EXISTING_FILES As Boolean = True\n")),(0,o.kt)("p",null,"\u5f53\u5904\u7406\u5927\u578b\u88c5\u914d\u65f6\uff0c\u6b64\u9009\u9879\u53ef\u80fd\u5f88\u6709\u7528\uff0c\u5e76\u4e14\u9700\u8981\u5728SOLIDWORKS\u91cd\u65b0\u542f\u52a8\u540e\u7ee7\u7eed\u6267\u884c\u3002\u5bfc\u51fa\u5c55\u5f00\u56fe\u6848\u662f\u4e00\u4e2a\u6027\u80fd\u6d88\u8017\u5f88\u5927\u7684\u64cd\u4f5c\uff0c\u56e0\u6b64\u5728\u5904\u7406\u5927\u578b\u4f5c\u4e1a\u65f6\uff0cSOLIDWORKS\u53ef\u80fd\u4f1a\u5d29\u6e83\u6216\u6302\u8d77\u3002\u6b64\u9009\u9879\u53ef\u4ee5\u5e2e\u52a9\u5728\u91cd\u65b0\u542f\u52a8\u540e\u7ee7\u7eed\u5bfc\u51fa\u3002"),(0,o.kt)("h2",{id:"\u6545\u969c\u6392\u9664"},"\u6545\u969c\u6392\u9664"),(0,o.kt)("p",null,"\u5982\u679c\u5b8f\u62a5\u544a\u9519\u8bef\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4e0d\u4f1a\u7acb\u5373\u660e\u786e\u5bfc\u81f4\u9519\u8bef\u7684\u539f\u56e0\uff0c\u56e0\u4e3a\u9519\u8bef\u8be6\u7ec6\u4fe1\u606f\u88ab\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u201c\u541e\u566c\u201d\u4e86\u3002\u4e3a\u4e86\u7981\u7528\u9519\u8bef\u5904\u7406\u5e76\u663e\u793a\u5bfc\u81f4\u9519\u8bef\u7684\u786e\u5207\u884c\uff0c\u8bf7\u5728\u4ee3\u7801\u4e2d\u5c06\u6240\u6709",(0,o.kt)("em",{parentName:"p"},"On Error GoTo catch_"),"\u884c\u6ce8\u91ca\u6389\uff0c\u65b9\u6cd5\u662f\u5728\u884c\u7684\u5f00\u5934\u653e\u7f6e\u6487\u53f7'\uff0c\u5982\u4e0b\u6240\u793a\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"jagged",jagged:!0},"Sub main()\n        \n    Set swApp = Application.SldWorks\n    \ntry_:\n    'On Error GoTo catch_\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb",metastring:"jagged",jagged:!0},"Sub ExportFlatPattern(part As SldWorks.PartDoc, flatPattern As SldWorks.Feature, outFilePath As String, opts As SheetMetalOptions_e, conf As String)\n    \n    Dim swModel As SldWorks.ModelDoc2\n    Set swModel = part\n    \n    Dim error As ErrObject\n    Dim hide As Boolean\n\ntry_:\n    \n    'On Error GoTo catch_\n")),(0,o.kt)("p",null,"\u8bf7\u63d0\u4ea4",(0,o.kt)("a",{parentName:"p",href:"https://github.com/xarial/codestack/issues/new?labels=bug"},"\u9519\u8bef\u62a5\u544a"),"\u5e76\u9644\u4e0a\u6b64\u9519\u8bef\u7684\u5feb\u7167\u548c\u7528\u4e8e\u91cd\u73b0\u7684\u6a21\u578b\uff08\u5982\u679c\u53ef\u80fd\uff09\u3002"),(0,o.kt)("h2",{id:"\u6ce8\u610f\u4e8b\u9879"},"\u6ce8\u610f\u4e8b\u9879"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u6709\u8f7b\u91cf\u7ea7\u7ec4\u4ef6\uff0c\u5b8f\u5c06\u8981\u6c42\u89e3\u6790\u5b83\u4eec\u3002\u5982\u679c\u672a\u89e3\u6790\u7ec4\u4ef6\uff0c\u5219\u5b8f\u53ef\u80fd\u4f1a\u751f\u6210\u9519\u8bef\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u5c06\u5bfc\u51fa\u6bcf\u4e2a\u591a\u4f53\u94a3\u91d1\u96f6\u4ef6\u7684\u6bcf\u4e2a\u5c55\u5f00\u56fe\u6848\u3002\u786e\u4fdd\u4f7f\u7528<","_","FeatureName","_",">\u6216<$CLPRP:","[PropertyName]",">\u533a\u5206\u7ed3\u679c\u6587\u4ef6"),(0,o.kt)("li",{parentName:"ul"},"$PRP\u548c$ASSMPRP\u503c\u5c06\u9996\u5148\u4ece\u914d\u7f6e\u7279\u5b9a\u5c5e\u6027\u4e2d\u63d0\u53d6\uff0c\u5982\u679c\u4e3a\u7a7a\uff0c\u5219\u4ece\u4e00\u822c\u6587\u4ef6\u5c5e\u6027\u4e2d\u63d0\u53d6"),(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u6307\u5b9a\u7684\u5c5e\u6027\u4e0d\u5b58\u5728\uff08\u5bf9\u4e8e$CLPRP\u3001$PRP\u548c$ASSMPRP\uff09\uff0c\u5219\u4f7f\u7528\u7a7a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u5360\u4f4d\u7b26\u503c"),(0,o.kt)("li",{parentName:"ul"},"\u5b8f\u5c06\u5904\u7406\u6240\u6709\u4e0d\u540c\u7684\u7ec4\u4ef6\uff08\u6587\u4ef6\u8def\u5f84+\u914d\u7f6e\uff09"),(0,o.kt)("li",{parentName:"ul"},"\u5b8f\u5c06\u81ea\u52a8\u521b\u5efa\u6240\u9700\u7684\u6587\u4ef6\u5939"),(0,o.kt)("li",{parentName:"ul"},"\u5b8f\u5c06\u4f7f\u7528","_","\u66ff\u6362\u6240\u6709\u8def\u5f84\u65e0\u6548\u7b26\u53f7"),(0,o.kt)("li",{parentName:"ul"},"\u5b8f\u5c06\u4ec5\u5bfc\u51fa\u5207\u5272\u5217\u8868\u4e0b\u7684\u552f\u4e00\u5b9e\u4f53\uff0c\u5e76\u8df3\u8fc7\u5c5e\u4e8e\u5df2\u5bfc\u51fa\u5207\u5272\u5217\u8868\u7684\u5c55\u5f00\u56fe\u6848")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vb"},'Enum SheetMetalOptions_e\n    ExportFlatPatternGeometry = 1\n    IncludeHiddenEdges = 2\n    ExportBendLines = 4\n    IncludeSketches = 8\n    MergeCoplanarFaces = 16\n    ExportLibraryFeatures = 32\n    ExportFormingTools = 64\n    ExportBoundingBox = 2048\nEnd Enum\n\nConst SKIP_EXISTING_FILES As Boolean = False\n\nConst OUT_NAME_TEMPLATE As String = "DXFs\\<_FileName_>_<_FeatureName_>_<_ConfName_>_<$CLPRP:Description>.dxf"\n\nConst FLAT_PATTERN_OPTIONS As Integer = SheetMetalOptions_e.ExportBendLines + SheetMetalOptions_e.ExportFlatPatternGeometry\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n        \n    Set swApp = Application.SldWorks\n    \ntry_:\n    On Error GoTo catch_\n    \n    Dim swModel As SldWorks.ModelDoc2\n    Set swModel = swApp.ActiveDoc\n    \n    If swModel Is Nothing Then\n        Err.Raise vbError, "", "\u8bf7\u6253\u5f00\u88c5\u914d\u6216\u96f6\u4ef6\u6587\u6863"\n    End If\n    \n    If swModel.GetType() = swDocumentTypes_e.swDocASSEMBLY Then\n    \n        Dim swAssy As SldWorks.AssemblyDoc\n        \n        Set swAssy = swModel\n            \n        swAssy.ResolveAllLightWeightComponents True\n            \n        Dim vComps As Variant\n        vComps = GetDistinctSheetMetalComponents(swAssy)\n        \n        Dim i As Integer\n        \n        For i = 0 To UBound(vComps)\n        \n            Dim swComp As SldWorks.Component2\n            Set swComp = vComps(i)\n            \n            ProcessSheetMetalModel swAssy, swComp.GetModelDoc2(), swComp.ReferencedConfiguration\n        \n        Next\n        \n    ElseIf swModel.GetType() = swDocumentTypes_e.swDocPART Then\n        \n        Dim swPart As SldWorks.PartDoc\n        Set swPart = swApp.ActiveDoc\n        \n        ProcessSheetMetalModel swPart, swPart, swPart.ConfigurationManager.ActiveConfiguration.Name\n        \n    Else\n        Err.Raise vbError, "", "\u4ec5\u652f\u6301\u88c5\u914d\u548c\u96f6\u4ef6\u6587\u6863"\n    End If\n    \n    swApp.SendMsgToUser2 "\u64cd\u4f5c\u5b8c\u6210", swMessageBoxIcon_e.swMbInformation, swMessageBoxBtn_e.swMbOk\n    \n    GoTo finally_\n    \ncatch_:\n    swApp.SendMsgToUser2 Err.Description, swMessageBoxIcon_e.swMbStop, swMessageBoxBtn_e.swMbOk\nfinally_:\n\nEnd Sub\n\nFunction GetDistinctSheetMetalComponents(assy As SldWorks.AssemblyDoc) As Variant\n    \n    Dim vComps As Variant\n    vComps = assy.GetComponents(False)\n        \n    Dim i As Integer\n    \n    Dim swSheetMetalComps() As SldWorks.Component2\n    \n    For i = 0 To UBound(vComps)\n        \n        Dim swComp As SldWorks.Component2\n        Set swComp = vComps(i)\n                \n        If False = swComp.IsSuppressed() Then\n            \n            If Not ContainsComponent(swSheetMetalComps, swComp) Then\n                \n                If IsSheetMetalComponent(swComp) Then\n                    If (Not swSheetMetalComps) = -1 Then\n                        ReDim swSheetMetalComps(0)\n                    Else\n                        ReDim Preserve swSheetMetalComps(UBound(swSheetMetalComps) + 1)\n                    End If\n                    \n                    Set swSheetMetalComps(UBound(swSheetMetalComps)) = swComp\n                End If\n            \n            End If\n            \n        End If\n        \n    Next\n    \n    If (Not swSheetMetalComps) = -1 Then\n        GetDistinctSheetMetalComponents = Empty\n    Else\n        GetDistinctSheetMetalComponents = swSheetMetalComps\n    End If\n    \nEnd Function\n\nFunction IsSheetMetalComponent(comp As SldWorks.Component2) As Boolean\n    \n    Dim vBodies As Variant\n    vBodies = comp.GetBodies3(swBodyType_e.swSolidBody, Empty)\n    \n    If Not IsEmpty(vBodies) Then\n        \n        Dim i As Integer\n        \n        For i = 0 To UBound(vBodies)\n            Dim swBody As SldWorks.Body2\n            Set swBody = vBodies(i)\n            \n            If False <> swBody.IsSheetMetal() Then\n                IsSheetMetalComponent = True\n                Exit Function\n            End If\n            \n        Next\n    End If\n    \n    IsSheetMetalComponent = False\n    \nEnd Function\n\nFunction ContainsComponent(comps As Variant, swComp As SldWorks.Component2) As Boolean\n\n    Dim i As Integer\n    \n    For i = 0 To UBound(comps)\n        Dim swThisComp As SldWorks.Component2\n        Set swThisComp = comps(i)\n        \n        If swThisComp.GetPathName() = swComp.GetPathName() And swThisComp.ReferencedConfiguration = swComp.ReferencedConfiguration Then\n            ContainsComponent = True\n            Exit Function\n        End If\n    Next\n    \n    ContainsComponent = False\n\nEnd Function\n\nFunction ComposeOutFileName(template As String, rootModel As SldWorks.ModelDoc2, sheetMetalModel As SldWorks.ModelDoc2, conf As String, flatPatternFeat As SldWorks.Feature, cutListFeat As SldWorks.Feature) As String\n\n    Dim regEx As Object\n    Set regEx = CreateObject("VBScript.RegExp")\n    \n    regEx.Global = True\n    regEx.IgnoreCase = True\n    regEx.Pattern = "<[^>]*>"\n    \n    Dim regExMatches As Object\n    Set regExMatches = regEx.Execute(template)\n    \n    Dim i As Integer\n    \n    Dim outFileName As String\n    outFileName = template\n    \n    For i = regExMatches.Count - 1 To 0 Step -1\n        \n        Dim regExMatch As Object\n        Set regExMatch = regExMatches.Item(i)\n                    \n        Dim tokenName As String\n        tokenName = Mid(regExMatch.Value, 2, Len(regExMatch.Value) - 2)\n        \n        outFileName = Left(outFileName, regExMatch.FirstIndex) & ResolveToken(tokenName, rootModel, sheetMetalModel, conf, flatPatternFeat, cutListFeat) & Right(outFileName, Len(outFileName) - (regExMatch.FirstIndex + regExMatch.Length))\n    Next\n    \n    ComposeOutFileName = ReplaceInvalidPathSymbols(GetFullPath(rootModel, outFileName))\n    \nEnd Function\n\nFunction ReplaceInvalidPathSymbols(path As String) As String\n    \n    Const REPLACE_SYMB As String = "_"\n    \n    Dim res As String\n    res = Right(path, Len(path) - Len("X:\\"))\n    \n    Dim drive As String\n    drive = Left(path, Len("X:\\"))\n    \n    Dim invalidSymbols As Variant\n    invalidSymbols = Array("/", ":", "*", "?", """", "<", ">", "|")\n    \n    Dim i As Integer\n    For i = 0 To UBound(invalidSymbols)\n        Dim invalidSymb As String\n        invalidSymb = CStr(invalidSymbols(i))\n        res = Replace(res, invalidSymb, REPLACE_SYMB)\n    Next\n    \n    ReplaceInvalidPathSymbols = drive + res\n    \nEnd Function\n\nFunction ResolveToken(token As String, rootModel As SldWorks.ModelDoc2, sheetMetalModel As SldWorks.ModelDoc2, conf As String, flatPatternFeat As SldWorks.Feature, cutListFeat As SldWorks.Feature) As String\n    \n    Const FILE_NAME_TOKEN As String = "_FileName_"\n    Const ASSM_FILE_NAME_TOKEN As String = "_AssmFileName_"\n    Const FEAT_NAME_TOKEN As String = "_FeatureName_"\n    Const CONF_NAME_TOKEN As String = "_ConfName_"\n    \n    Const PRP_TOKEN As String = "$PRP:"\n    Const CUT_LIST_PRP_TOKEN As String = "$CLPRP:"\n    Const ASM_PRP_TOKEN As String = "$ASSMPRP:"\n    \n    Select Case LCase(token)\n        Case LCase(FILE_NAME_TOKEN)\n            ResolveToken = GetFileNameWithoutExtension(sheetMetalModel.GetPathName)\n        Case LCase(FEAT_NAME_TOKEN)\n            ResolveToken = flatPatternFeat.Name\n        Case LCase(CONF_NAME_TOKEN)\n            ResolveToken = conf\n        Case LCase(ASSM_FILE_NAME_TOKEN)\n            If rootModel.GetPathName() = "" Then\n                Err.Raise vbError, "", "\u5fc5\u987b\u4fdd\u5b58\u88c5\u914d\u4ee5\u4f7f\u7528 " & ASSM_FILE_NAME_TOKEN\n            End If\n            ResolveToken = GetFileNameWithoutExtension(rootModel.GetPathName())\n        Case Else\n            \n            Dim prpName As String\n                        \n            If Left(token, Len(PRP_TOKEN)) = PRP_TOKEN Then\n                prpName = Right(token, Len(token) - Len(PRP_TOKEN))\n                ResolveToken = GetModelPropertyValue(sheetMetalModel, conf, prpName)\n            ElseIf Left(token, Len(ASM_PRP_TOKEN)) = ASM_PRP_TOKEN Then\n                prpName = Right(token, Len(token) - Len(ASM_PRP_TOKEN))\n                ResolveToken = GetModelPropertyValue(rootModel, rootModel.ConfigurationManager.ActiveConfiguration.Name, prpName)\n            ElseIf Left(token, Len(CUT_LIST_PRP_TOKEN)) = CUT_LIST_PRP_TOKEN Then\n                prpName = Right(token, Len(token) - Len(CUT_LIST_PRP_TOKEN))\n                ResolveToken = GetPropertyValue(cutListFeat.CustomPropertyManager, prpName)\n            Else\n                Err.Raise vbError, "", "\u65e0\u6cd5\u8bc6\u522b\u7684\u5360\u4f4d\u7b26: " & token\n            End If\n            \n    End Select\n    \nEnd Function\n\nFunction GetModelPropertyValue(model As SldWorks.ModelDoc2, confName As String, prpName As String) As String\n    \n    Dim prpVal As String\n    Dim swCustPrpMgr As SldWorks.CustomPropertyManager\n    \n    Set swCustPrpMgr = model.Extension.CustomPropertyManager(confName)\n    prpVal = GetPropertyValue(swCustPrpMgr, prpName)\n    \n    If prpVal = "" Then\n        Set swCustPrpMgr = model.Extension.CustomPropertyManager("")\n        prpVal = GetPropertyValue(swCustPrpMgr, prpName)\n    End If\n    \n    GetModelPropertyValue = prpVal\n    \nEnd Function\n\nFunction GetPropertyValue(custPrpMgr As SldWorks.CustomPropertyManager, prpName As String) As String\n    Dim resVal As String\n    custPrpMgr.Get2 prpName, "", resVal\n    GetPropertyValue = resVal\nEnd Function\n\nFunction GetFileNameWithoutExtension(path As String) As String\n    GetFileNameWithoutExtension = Mid(path, InStrRev(path, "\\") + 1, InStrRev(path, ".") - InStrRev(path, "\\") - 1)\nEnd Function\n\nFunction GetCutListFeatures(model As SldWorks.ModelDoc2) As Variant\n    GetCutListFeatures = GetFeaturesByType(model, "CutListFolder")\nEnd Function\n\nFunction GetFlatPatternFeatures(model As SldWorks.ModelDoc2) As Variant\n    GetFlatPatternFeatures = GetFeaturesByType(model, "FlatPattern")\nEnd Function\n\n\n\n\u5b50\u8fc7\u7a0b`ProcessSheetMetalModel`\u7528\u4e8e\u5904\u7406\u94a3\u91d1\u6a21\u578b\u3002\u5b83\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570\uff1a`rootModel`\uff08\u6839\u6a21\u578b\uff09\u3001`sheetMetalModel`\uff08\u94a3\u91d1\u6a21\u578b\uff09\u548c`conf`\uff08\u914d\u7f6e\u540d\u79f0\uff09\u3002\n\n```vba\nSub ProcessSheetMetalModel(rootModel As SldWorks.ModelDoc2, sheetMetalModel As SldWorks.ModelDoc2, conf As String)\n        \n    Dim vCutListFeats As Variant\n    vCutListFeats = GetCutListFeatures(sheetMetalModel)\n    \n    If Not IsEmpty(vCutListFeats) Then\n        \n        Dim vFlatPatternFeats As Variant\n        vFlatPatternFeats = GetFlatPatternFeatures(sheetMetalModel)\n        \n        If Not IsEmpty(vFlatPatternFeats) Then\n            \n            Dim swProcessedCutListsFeats() As SldWorks.Feature\n            \n            Dim i As Integer\n    \n            For i = 0 To UBound(vFlatPatternFeats)\n                \n                Dim swFlatPatternFeat As SldWorks.Feature\n                Dim swFlatPattern As SldWorks.FlatPatternFeatureData\n                \n                Set swFlatPatternFeat = vFlatPatternFeats(i)\n                \n                Set swFlatPattern = swFlatPatternFeat.GetDefinition\n                \n                Dim swFixedEnt As SldWorks.Entity\n                \n                Set swFixedEnt = swFlatPattern.FixedFace2\n                \n                Dim swBody As SldWorks.Body2\n                \n                If TypeOf swFixedEnt Is SldWorks.Face2 Then\n                    Dim swFixedFace As SldWorks.Face2\n                    Set swFixedFace = swFixedEnt\n                    Set swBody = swFixedFace.GetBody\n                ElseIf TypeOf swFixedEnt Is SldWorks.Edge Then\n                    Dim swFixedEdge As SldWorks.Edge\n                    Set swFixedEdge = swFixedEnt\n                    Set swBody = swFixedEdge.GetBody\n                ElseIf TypeOf swFixedEnt Is SldWorks.Vertex Then\n                    Dim swFixedVert As SldWorks.Vertex\n                    Set swFixedVert = swFixedEnt\n                    Set swBody = swFixedVert.GetBody\n                End If\n                \n                Dim swCutListFeat As SldWorks.Feature\n                Set swCutListFeat = FindCutListFeature(vCutListFeats, swBody)\n                \n                If Not swCutListFeat Is Nothing Then\n                    \n                    Dim isUnique As Boolean\n                                        \n                    If (Not swProcessedCutListsFeats) = -1 Then\n                        isUnique = True\n                    ElseIf Not ContainsSwObject(swProcessedCutListsFeats, swCutListFeat) Then\n                        isUnique = True\n                    Else\n                        isUnique = False\n                    End If\n                    \n                    If isUnique Then\n                        \n                        If (Not swProcessedCutListsFeats) = -1 Then\n                            ReDim swProcessedCutListsFeats(0)\n                        Else\n                            ReDim Preserve swProcessedCutListsFeats(UBound(swProcessedCutListsFeats) + 1)\n                        End If\n                        \n                        Set swProcessedCutListsFeats(UBound(swProcessedCutListsFeats)) = swCutListFeat\n                        \n                        Dim outFileName As String\n                        outFileName = ComposeOutFileName(OUT_NAME_TEMPLATE, rootModel, sheetMetalModel, conf, swFlatPatternFeat, swCutListFeat)\n                        \n                        If Not SKIP_EXISTING_FILES Or Not FileExists(outFileName) Then\n                            ExportFlatPattern sheetMetalModel, swFlatPatternFeat, outFileName, FLAT_PATTERN_OPTIONS, conf\n                        End If\n                    End If\n                    \n                Else\n                    Err.Raise vbError, "", "Failed to find cut-list for flat pattern " & swFlatPatternFeat.Name\n                End If\n                \n            Next\n            \n        Else\n            Err.Raise vbError, "", "No flat pattern features found"\n        End If\n        \n    Else\n        Err.Raise vbError, "", "No cut-list items found"\n    End If\n    \nEnd Sub\n```\n\n\u51fd\u6570`FileExists`\u7528\u4e8e\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002\n\n```vba\nFunction FileExists(filePath As String) As Boolean\n    FileExists = Dir(filePath) <> ""\nEnd Function\n```\n\n\u51fd\u6570`FindCutListFeature`\u7528\u4e8e\u67e5\u627e\u5305\u542b\u6307\u5b9a\u5b9e\u4f53\u7684\u5207\u5272\u5217\u8868\u7279\u5f81\u3002\n\n```vba\nFunction FindCutListFeature(vCutListFeats As Variant, body As SldWorks.Body2) As SldWorks.Feature\n    \n    Dim i As Integer\n    \n    For i = 0 To UBound(vCutListFeats)\n        \n        Dim swCutListFeat As SldWorks.Feature\n        Set swCutListFeat = vCutListFeats(i)\n        \n        Dim swBodyFolder As SldWorks.BodyFolder\n        Set swBodyFolder = swCutListFeat.GetSpecificFeature2\n        \n        Dim vBodies As Variant\n        \n        vBodies = swBodyFolder.GetBodies\n        \n        If ContainsSwObject(vBodies, body) Then\n            Set FindCutListFeature = swCutListFeat\n        End If\n            \n    Next\n    \nEnd Function\n```\n\n\u51fd\u6570`ContainsSwObject`\u7528\u4e8e\u68c0\u67e5\u6570\u7ec4\u4e2d\u662f\u5426\u5305\u542b\u6307\u5b9a\u5bf9\u8c61\u3002\n\n```vba\nFunction ContainsSwObject(vArr As Variant, obj As Object) As Boolean\n    \n    If Not IsEmpty(vArr) Then\n    \n        Dim i As Integer\n        \n        For i = 0 To UBound(vArr)\n            \n            Dim swObj As Object\n            Set swObj = vArr(i)\n            \n            If swApp.IsSame(swObj, obj) = swObjectEquality.swObjectSame Then\n                ContainsSwObject = True\n                Exit Function\n            End If\n        Next\n        \n    End If\n    \n    ContainsSwObject = False\n    \nEnd Function\n```\n\n\u51fd\u6570`GetFeaturesByType`\u7528\u4e8e\u83b7\u53d6\u6307\u5b9a\u7c7b\u578b\u7684\u7279\u5f81\u3002\n\n```vba\nFunction GetFeaturesByType(model As SldWorks.ModelDoc2, typeName As String) As Variant\n    \n    Dim swFeats() As SldWorks.Feature\n    \n    Dim swFeat As SldWorks.Feature\n    \n    Set swFeat = model.FirstFeature\n    \n    Do While Not swFeat Is Nothing\n        \n        If typeName = "CutListFolder" And swFeat.GetTypeName2() = "SolidBodyFolder" Then\n            Dim swBodyFolder As SldWorks.BodyFolder\n            Set swBodyFolder = swFeat.GetSpecificFeature2\n            swBodyFolder.UpdateCutList\n        End If\n        \n        ProcessFeature swFeat, swFeats, typeName\n\n        Set swFeat = swFeat.GetNextFeature\n        \n    Loop\n    \n    If (Not swFeats) = -1 Then\n        GetFeaturesByType = Empty\n    Else\n        GetFeaturesByType = swFeats\n    End If\n    \nEnd Function\n```\n\n\u5b50\u8fc7\u7a0b`ProcessFeature`\u7528\u4e8e\u5904\u7406\u7279\u5f81\u3002\n\n```vba\nSub ProcessFeature(thisFeat As SldWorks.Feature, featsArr() As SldWorks.Feature, typeName As String)\n    \n    If thisFeat.GetTypeName2() = typeName Then\n    \n        If (Not featsArr) = -1 Then\n            ReDim featsArr(0)\n            Set featsArr(0) = thisFeat\n        Else\n            Dim i As Integer\n            \n            For i = 0 To UBound(featsArr)\n                If swApp.IsSame(featsArr(i), thisFeat) = swObjectEquality.swObjectSame Then\n                    Exit Sub\n                End If\n            Next\n            \n            ReDim Preserve featsArr(UBound(featsArr) + 1)\n            Set featsArr(UBound(featsArr)) = thisFeat\n        End If\n    \n    End If\n    \n    Dim swSubFeat As SldWorks.Feature\n    Set swSubFeat = thisFeat.GetFirstSubFeature\n        \n    While Not swSubFeat Is Nothing\n        ProcessFeature swSubFeat, featsArr, typeName\n        Set swSubFeat = swSubFeat.GetNextSubFeature\n    Wend\n        \nEnd Sub\n```\n\n\u5b50\u8fc7\u7a0b`ExportFlatPattern`\u7528\u4e8e\u5bfc\u51fa\u5e73\u9762\u56fe\u3002\n\n```vba\nSub ExportFlatPattern(part As SldWorks.PartDoc, flatPattern As SldWorks.Feature, outFilePath As String, opts As SheetMetalOptions_e, conf As String)\n    \n    Dim swModel As SldWorks.ModelDoc2\n    Set swModel = part\n    \n    Dim error As ErrObject\n    Dim hide As Boolean\n\ntry_:\n    \n    On Error GoTo catch_\n\n    If False = swModel.Visible Then\n        hide = True\n        swModel.Visible = True\n    End If\n    \n    swApp.ActivateDoc3 swModel.GetPathName(), False, swRebuildOnActivation_e.swDontRebuildActiveDoc, 0\n    \n    swModel.FeatureManager.EnableFeatureTree = False\n    swModel.FeatureManager.EnableFeatureTreeWindow = False\n    swModel.ActiveView.EnableGraphicsUpdate = False\n    \n    Dim curConf As String\n    \n    curConf = swModel.ConfigurationManager.ActiveConfiguration.Name\n    \n    If curConf <> conf Then\n        If False = swModel.ShowConfiguration2(conf) Then\n            Err.Raise vbError, "", "Failed to activate configuration"\n        End If\n    End If\n    \n    Dim outDir As String\n    outDir = Left(outFilePath, InStrRev(outFilePath, "\\"))\n    \n    CreateDirectories outDir\n    \n    Dim modelPath As String\n    \n    modelPath = part.GetPathName\n    \n    If modelPath = "" Then\n        Err.Raise vbError, "", "Part document must be saved"\n    End If\n    \n    If False <> flatPattern.Select2(False, -1) Then\n        If False = part.ExportToDWG2(outFilePath, modelPath, swExportToDWG_e.swExportToDWG_ExportSheetMetal, True, Empty, False, False, opts, Empty) Then\n            Err.Raise vbError, "", "Failed to export flat pattern"\n        End If\n    Else\n        Err.Raise vbError, "", "Failed to select flat-pattern"\n    End If\n    \n    swModel.ShowConfiguration2 curConf\n    \n    GoTo finally_\n    \ncatch_:\n    Set error = Err\nfinally_:\n\n    swModel.FeatureManager.EnableFeatureTree = True\n    swModel.FeatureManager.EnableFeatureTreeWindow = True\n    swModel.ActiveView.EnableGraphicsUpdate = True\n    \n    If hide Then\n        swApp.CloseDoc swModel.GetTitle\n    End If\n    \n    If Not error Is Nothing Then\n        Err.Raise error.Number, error.Source, error.Description, error.HelpFile, error.HelpContext\n    End If\n    \nEnd Sub\n```\n\n\u5b50\u8fc7\u7a0b`CreateDirectories`\u7528\u4e8e\u521b\u5efa\u76ee\u5f55\u3002\n\n```vba\nSub CreateDirectories(path As String)\n\n    Dim fso As Object\n    Set fso = CreateObject("Scripting.FileSystemObject")\n\n    If fso.FolderExists(path) Then\n        Exit Sub\n    End If\n\n    CreateDirectories fso.GetParentFolderName(path)\n    \n    fso.CreateFolder path\n    \nEnd Sub\n```\n\n\u51fd\u6570`GetFullPath`\u7528\u4e8e\u83b7\u53d6\u5b8c\u6574\u8def\u5f84\u3002\n\n```vba\nFunction GetFullPath(model As SldWorks.ModelDoc2, path As String)\n    \n    GetFullPath = path\n        \n    If IsPathRelative(path) Then\n        \n        If Left(path, 1) <> "\\" Then\n            path = "\\" & path\n        End If\n        \n        Dim modelPath As String\n        Dim modelDir As String\n        \n        modelPath = model.GetPathName\n        \n        modelDir = Left(modelPath, InStrRev(modelPath, "\\") - 1)\n        \n        GetFullPath = modelDir & path\n        \n    End If\n    \nEnd Function\n```\n\n\u51fd\u6570`IsPathRelative`\u7528\u4e8e\u68c0\u67e5\u8def\u5f84\u662f\u5426\u4e3a\u76f8\u5bf9\u8def\u5f84\u3002\n\n```vba\nFunction IsPathRelative(path As String)\n    IsPathRelative = Mid(path, 2, 1) <> ":" And Not IsPathUnc(path)\nEnd Function\n```\n\n\u51fd\u6570`IsPathUnc`\u7528\u4e8e\u68c0\u67e5\u8def\u5f84\u662f\u5426\u4e3aUNC\u8def\u5f84\u3002\n\n```vba\nFunction IsPathUnc(path As String)\n    IsPathUnc = Left(path, 2) = "\\\\"\nEnd Function\n```\n')))}m.isMDXComponent=!0},73931:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/flat-pattern-export-options-caf08a97bd79cd321c2e6fd5d64b6850.png"},71904:(e,n,t)=>{t.d(n,{Z:()=>s});const s="data:image/png;base64,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"}}]);