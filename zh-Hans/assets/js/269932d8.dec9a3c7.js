"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[59164],{3905:(n,e,o)=>{o.d(e,{Zo:()=>p,kt:()=>m});var t=o(67294);function r(n,e,o){return e in n?Object.defineProperty(n,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[e]=o,n}function i(n,e){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.push.apply(o,t)}return o}function s(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach((function(e){r(n,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}))}return n}function a(n,e){if(null==n)return{};var o,t,r=function(n,e){if(null==n)return{};var o,t,r={},i=Object.keys(n);for(t=0;t<i.length;t++)o=i[t],e.indexOf(o)>=0||(r[o]=n[o]);return r}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(t=0;t<i.length;t++)o=i[t],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(n,o)&&(r[o]=n[o])}return r}var l=t.createContext({}),c=function(n){var e=t.useContext(l),o=e;return n&&(o="function"==typeof n?n(e):s(s({},e),n)),o},p=function(n){var e=c(n.components);return t.createElement(l.Provider,{value:e},n.children)},u="mdxType",d={inlineCode:"code",wrapper:function(n){var e=n.children;return t.createElement(t.Fragment,{},e)}},g=t.forwardRef((function(n,e){var o=n.components,r=n.mdxType,i=n.originalType,l=n.parentName,p=a(n,["components","mdxType","originalType","parentName"]),u=c(o),g=r,m=u["".concat(l,".").concat(g)]||u[g]||d[g]||i;return o?t.createElement(m,s(s({ref:e},p),{},{components:o})):t.createElement(m,s({ref:e},p))}));function m(n,e){var o=arguments,r=e&&e.mdxType;if("string"==typeof n||r){var i=o.length,s=new Array(i);s[0]=g;var a={};for(var l in e)hasOwnProperty.call(e,l)&&(a[l]=e[l]);a.originalType=n,a[u]="string"==typeof n?n:r,s[1]=a;for(var c=2;c<i;c++)s[c]=o[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,o)}g.displayName="MDXCreateElement"},83448:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var t=o(87462),r=(o(67294),o(3905));const i={layout:"sw-macro-fix",title:"\u4fee\u590d SOLIDWORKS \u5b8f\u4e2d\u9519\u8bef\u4f7f\u7528 32 \u4f4d\u7248\u672c\u7684 Windows API \u51fd\u6570",caption:"\u9519\u8bef\u4f7f\u7528 32 \u4f4d\u7248\u672c\u7684 Windows API \u51fd\u6570"},s=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/windows-api-functions-incorrect-use/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/windows-api-functions-incorrect-use/index",title:"\u4fee\u590d SOLIDWORKS \u5b8f\u4e2d\u9519\u8bef\u4f7f\u7528 32 \u4f4d\u7248\u672c\u7684 Windows API \u51fd\u6570",description:"\u4fee\u590d\u7f16\u8bd1\u9519\u8bef - \u5f53\u5b8f\u4f7f\u7528 Windows API \u51fd\u6570\u65f6\uff0c\u5fc5\u987b\u66f4\u65b0\u6b64\u9879\u76ee\u7684\u4ee3\u7801\u4ee5\u5728 64 \u4f4d\u7cfb\u7edf\u4e0a\u4f7f\u7528",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/windows-api-functions-incorrect-use/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/windows-api-functions-incorrect-use",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/windows-api-functions-incorrect-use/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/windows-api-functions-incorrect-use/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/windows-api-functions-incorrect-use/index.md",tags:[],version:"current",frontMatter:{layout:"sw-macro-fix",title:"\u4fee\u590d SOLIDWORKS \u5b8f\u4e2d\u9519\u8bef\u4f7f\u7528 32 \u4f4d\u7248\u672c\u7684 Windows API \u51fd\u6570",caption:"\u9519\u8bef\u4f7f\u7528 32 \u4f4d\u7248\u672c\u7684 Windows API \u51fd\u6570"},sidebar:"tutorialSidebar",previous:{title:"solidworks-api",permalink:"/solidworks-GPT/zh-Hans/docs/category/solidworks-api-3"},next:{title:"\u4fee\u590dSOLIDWORKS\u5b8f\u5728\u88c5\u914d\u6216\u7ed8\u56fe\u4e2d\u4f7f\u7528\u8f7b\u91cf\u7ea7\u7ec4\u4ef6\u7684\u95ee\u9898",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/assembly-drawing-lightweight-components/"}},l={},c=[{value:"\u75c7\u72b6",id:"\u75c7\u72b6",level:2},{value:"\u539f\u56e0",id:"\u539f\u56e0",level:2},{value:"\u89e3\u51b3\u65b9\u6cd5",id:"\u89e3\u51b3\u65b9\u6cd5",level:2}],p={toc:c},u="wrapper";function d(n){let{components:e,...i}=n;return(0,r.kt)(u,(0,t.Z)({},p,i,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u4fee\u590d\u7f16\u8bd1\u9519\u8bef - \u5f53\u5b8f\u4f7f\u7528 Windows API \u51fd\u6570\u65f6\uff0c\u5fc5\u987b\u66f4\u65b0\u6b64\u9879\u76ee\u7684\u4ee3\u7801\u4ee5\u5728 64 \u4f4d\u7cfb\u7edf\u4e0a\u4f7f\u7528\nimage: declare-function-win-api.png\nlabels: ","[\u5b8f, \u6545\u969c\u6392\u9664]","\nredirect-from:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"/2018/04/macro-troubleshooting-incorrect-use-of-32-bit-versions-of-win-api.html")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"\u75c7\u72b6"},"\u75c7\u72b6"),(0,r.kt)("p",null,"\u7cfb\u7edf\u4ece\u65e9\u4e8e 2012 \u7248\u672c\u7684 SOLIDWORKS \u66f4\u65b0\u5230\u66f4\u65b0\u7248\u672c\u3002\n\u6216\u8005\u8fd0\u884c\u67d0\u4e9b\u65e7\u7248\u5b8f\u3002\n\u5b8f\u4f7f\u7528 Windows API \u51fd\u6570\uff08\u4f8b\u5982\u5177\u6709\u6d4f\u89c8\u6587\u4ef6/\u6587\u4ef6\u5939\u5bf9\u8bdd\u6846\u3001\u8fde\u63a5\u5230\u6ce8\u518c\u8868\u3001\u4f7f\u7528\u7a97\u53e3\u53e5\u67c4\uff09\u901a\u8fc7 ",(0,r.kt)("em",{parentName:"p"},"Declare Function")," \u8bed\u53e5\u3002\n\u542f\u52a8\u65f6\u663e\u793a ",(0,r.kt)("em",{parentName:"p"},"\u7f16\u8bd1\u9519\u8bef\uff1a\u5fc5\u987b\u66f4\u65b0\u6b64\u9879\u76ee\u7684\u4ee3\u7801\u4ee5\u5728 64 \u4f4d\u7cfb\u7edf\u4e0a\u4f7f\u7528"),"\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Windows API Declare \u51fd\u6570\u4e0d\u517c\u5bb9\u9519\u8bef",src:o(9313).Z,width:"640",height:"187"}),"{ width=640 height=185 }"),(0,r.kt)("h2",{id:"\u539f\u56e0"},"\u539f\u56e0"),(0,r.kt)("p",null,"SOLIDWORKS \u5728 2013 \u7248\u672c\u4e2d\u5c06 Visual Basic for Application \u73af\u5883\u4ece VB6 \u66f4\u65b0\u4e3a VB7\u3002\nVB6 \u662f 32 \u4f4d\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c ",(0,r.kt)("a",{parentName:"p",href:"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/64-bit-visual-basic-for-applications-overview"},"VB7")," \u662f 64 \u4f4d\u5e94\u7528\u7a0b\u5e8f\u3002\n\u7531\u4e8e 32/64 \u4f4d\u73af\u5883\u4e2d\u53d8\u91cf\u5927\u5c0f\u7684\u5dee\u5f02\uff0c\u9700\u8981\u4f7f\u7528 PtrSafe \u5173\u952e\u5b57\u6765\u786e\u4fdd\u5728 x64 \u7cfb\u7edf\u4e2d\u8fd0\u884c\u5b8f\u662f\u5b89\u5168\u7684\uff0c\u5e76\u4f7f\u7528 LongPtr \u6216 LongLong \u6765\u6b63\u786e\u89e3\u6790 32 \u4f4d\u548c 64 \u4f4d\u73af\u5883\u4e2d\u7684 Long \u7c7b\u578b\u53d8\u91cf\u3002"),(0,r.kt)("h2",{id:"\u89e3\u51b3\u65b9\u6cd5"},"\u89e3\u51b3\u65b9\u6cd5"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4fee\u6539\u6240\u6709\u58f0\u660e\u5e76\u5305\u542b PtrSafe \u5173\u952e\u5b57\u548c LongPtr \u4f5c\u4e3a Long \u7c7b\u578b\u7684\u53d8\u91cf\u58f0\u660e"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u9700\u8981\u652f\u6301\u65e7\u7248\u672c\u7684 SOLIDWORKS\uff082012 \u5e74\u4e4b\u524d\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u9884\u7f16\u8bd1\u6761\u4ef6\u8bed\u53e5 #IF-#Else")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'#If VBA7 Then\n    Private Type BROWSEINFO\n      hOwner As LongPtr\n      pidlRoot As Long\n      pszDisplayName As String\n      lpszTitle As String\n      ulFlags As Long\n      lpfnCallback As LongPtr\n      lParam As LongPtr\n      iImage As Long\n    End Type\n\n    Private Declare PtrSafe Function SHBrowseForFolder Lib "Shell32" (lpbi As BROWSEINFO) As Long\n    Private Declare PtrSafe Function SHGetPathFromIDList Lib "Shell32" (ByVal pidList As LongPtr, ByVal lpBuffer As String) As Long\n    Private Declare PtrSafe Sub CoTaskMemFree Lib "ole32" (ByVal hMem As LongPtr)\n#Else\n    Private Type BROWSEINFO\n        hOwner As Long\n        pidlRoot As Long\n        pszDisplayName As Long\n        lpszTitle As String\n        ulFlags As Long\n        lpfnCallback As Long\n        lParam As Long\n        iImage As Long\n    End Type\n    \n    Private Declare Function SHBrowseForFolder Lib "Shell32" (lpbi As BROWSEINFO) As Long\n    Private Declare Function SHGetPathFromIDList Lib "Shell32" (ByVal pidList As Long, ByVal lpBuffer As String) As Long\n    Private Declare Sub CoTaskMemFree Lib "ole32" (ByVal hMem As Long)\n#End If\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n        \n    swApp.SendMsgToUser "Selected folder " & BrowseForFolder\n    \nEnd Sub\n\nPublic Function BrowseForFolder() As String\n  \n    Dim bi As BROWSEINFO\n    Dim pidl As Long\n    Dim path As String\n  \n    bi.lpszTitle = ""\n    bi.ulFlags = 0\n    \n    pidl = SHBrowseForFolder(bi)\n    If pidl <> 0 Then\n    \n        path = Space$(265)\n        SHGetPathFromIDList pidl, path\n        path = Left$(path, InStr(path, Chr$(0)) - 1)\n    \n        CoTaskMemFree lngPIDL\n    End If\n    \n    BrowseForFolder = path\n    \nEnd Function\n\n')))}d.isMDXComponent=!0},9313:(n,e,o)=>{o.d(e,{Z:()=>t});const t=o.p+"assets/images/declare-function-win-api-3a639327dceb5ec2730f4b32ff4988b4.png"}}]);