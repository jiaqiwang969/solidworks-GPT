"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[60479],{3905:(e,n,o)=>{o.d(n,{Zo:()=>c,kt:()=>b});var t=o(67294);function i(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function r(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function s(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){i(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function a(e,n){if(null==e)return{};var o,t,i=function(e,n){if(null==e)return{};var o,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||(i[o]=e[o]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var l=t.createContext({}),d=function(e){var n=t.useContext(l),o=n;return e&&(o="function"==typeof e?e(n):s(s({},n),e)),o},c=function(e){var n=d(e.components);return t.createElement(l.Provider,{value:n},e.children)},w="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var o=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),w=d(o),p=i,b=w["".concat(l,".").concat(p)]||w[p]||u[p]||r;return o?t.createElement(b,s(s({ref:n},c),{},{components:o})):t.createElement(b,s({ref:n},c))}));function b(e,n){var o=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=o.length,s=new Array(r);s[0]=p;var a={};for(var l in n)hasOwnProperty.call(n,l)&&(a[l]=n[l]);a.originalType=e,a[w]="string"==typeof e?e:i,s[1]=a;for(var d=2;d<r;d++)s[d]=o[d];return t.createElement.apply(null,s)}return t.createElement.apply(null,o)}p.displayName="MDXCreateElement"},44287:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var t=o(87462),i=(o(67294),o(3905));const r={title:"Clear revision table and add new revision using SOLIDWORKS API",caption:"Clear Revision Table And Add New Revision"},s=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/clear-revision-table-new-revision/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/clear-revision-table-new-revision/index",title:"Clear revision table and add new revision using SOLIDWORKS API",description:"Example finds the revision table and removes all revisions and then adds new row with custom data",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/clear-revision-table-new-revision/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/clear-revision-table-new-revision",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/clear-revision-table-new-revision/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/clear-revision-table-new-revision/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/clear-revision-table-new-revision/index.md",tags:[],version:"current",frontMatter:{title:"Clear revision table and add new revision using SOLIDWORKS API",caption:"Clear Revision Table And Add New Revision"},sidebar:"tutorialSidebar",previous:{title:"SOLIDWORKS macro to change layer of selected objects in drawing using SOLIDWORKS API",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/change-layer-selected-drawing-objects/"},next:{title:"Macro to copy file paths to all drawings of an assembly components using SOLIDWORKS API",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/drawing/copy-drawing-paths/"}},l={},d=[],c={toc:d},w="wrapper";function u(e){let{components:n,...r}=e;return(0,i.kt)(w,(0,t.Z)({},c,r,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Example finds the revision table and removes all revisions and then adds new row with custom data\nimage: sw-revision-table.png\nlabels: ","[add revision, clear revisions, drawing.revision table, example, solidworks api]","\nredirect-from:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"/2018/03/solidworks-api-drawing-clear-rev-table-add-new-row.html")),(0,i.kt)("hr",null),(0,i.kt)("p",null,"This example finds the revision table and removes all revisions and then adds new row with custom data using SOLIDWORKS API."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Revision Table",src:o(37537).Z,width:"640",height:"178"}),"{ width=640 }"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2018/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.irevisiontableannotation.html"},"IRevisionTableAnnotation")," SOLIDWORKS API interface is used to manage specific functionality of this type of the table."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-vb"},'Dim swApp As SldWorks.SldWorks\nDim swDraw As SldWorks.DrawingDoc\nDim swSheet As SldWorks.Sheet\n\nSub main()\n\n    Set swApp = Application.SldWorks\n\n    Set swDraw = swApp.ActiveDoc\n    \n    If Not swDraw Is Nothing Then\n    \n        Set swSheet = swDraw.GetCurrentSheet\n        \n        Dim swRevTable As SldWorks.RevisionTableAnnotation\n\n        Set swRevTable = swSheet.RevisionTable\n        \n        If Not swRevTable Is Nothing Then\n            \n            ClearRevisionTable swRevTable\n            \n            AddRevision swRevTable, "001", Array("Sample Zone", "", "Description", "", "Admin")\n            \n        Else\n            MsgBox "There is no revision table in the drawing"\n        End If\n    \n    Else\n        MsgBox "Plase open the drawing"\n    End If\n    \nEnd Sub\n\nSub ClearRevisionTable(swRevTable As SldWorks.RevisionTableAnnotation)\n    \n    Dim swTableAnn As SldWorks.TableAnnotation\n    \n    Set swTableAnn = swRevTable\n            \n    Dim i As Integer\n    \n    For i = swTableAnn.RowCount - 1 To 0 Step -1\n        \n        Dim revId As Long\n        revId = swRevTable.GetIdForRowNumber(i)\n        \n        If revId <> 0 Then\n            swRevTable.DeleteRevision revId, True\n        End If\n        \n    Next\n    \nEnd Sub\n\nSub AddRevision(swRevTable As SldWorks.RevisionTableAnnotation, revName As String, rowData As Variant)\n    \n    Dim i As Integer\n    Dim swTableAnn As SldWorks.TableAnnotation\n    \n    Set swTableAnn = swRevTable\n    \n    swRevTable.AddRevision revName\n            \n    For i = 0 To UBound(rowData)\n                \n        If rowData(i) <> "" Then\n            \n            swTableAnn.Text(swTableAnn.RowCount - 1, i) = rowData(i)\n        \n        End If\n                \n    Next\n    \nEnd Sub\n\n')))}u.isMDXComponent=!0},37537:(e,n,o)=>{o.d(n,{Z:()=>t});const t=o.p+"assets/images/sw-revision-table-f18733675d6f94a0e86b95afda25ee86.png"}}]);