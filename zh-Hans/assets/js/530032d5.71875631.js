"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[17095],{3905:(e,o,t)=>{t.d(o,{Zo:()=>m,kt:()=>g});var n=t(67294);function r(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function i(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?i(Object(t),!0).forEach((function(o){r(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}function a(e,o){if(null==e)return{};var t,n,r=function(e,o){if(null==e)return{};var t,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],o.indexOf(t)>=0||(r[t]=e[t]);return r}(e,o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],o.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=n.createContext({}),c=function(e){var o=n.useContext(l),t=o;return e&&(t="function"==typeof e?e(o):s(s({},o),e)),t},m=function(e){var o=c(e.components);return n.createElement(l.Provider,{value:o},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var o=e.children;return n.createElement(n.Fragment,{},o)}},d=n.forwardRef((function(e,o){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,m=a(e,["components","mdxType","originalType","parentName"]),u=c(t),d=r,g=u["".concat(l,".").concat(d)]||u[d]||p[d]||i;return t?n.createElement(g,s(s({ref:o},m),{},{components:t})):n.createElement(g,s({ref:o},m))}));function g(e,o){var t=arguments,r=o&&o.mdxType;if("string"==typeof e||r){var i=t.length,s=new Array(i);s[0]=d;var a={};for(var l in o)hasOwnProperty.call(o,l)&&(a[l]=o[l]);a.originalType=e,a[u]="string"==typeof e?e:r,s[1]=a;for(var c=2;c<i;c++)s[c]=t[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,t)}d.displayName="MDXCreateElement"},97136:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var n=t(87462),r=(t(67294),t(3905));const i={layout:"sw-macro-fix",title:"Fix too long SOLIDWORKS VBA macro line error",caption:"Too Long VBA Macro Line"},s=void 0,a={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-vba-macro-line/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-vba-macro-line/index",title:"Fix too long SOLIDWORKS VBA macro line error",description:"Fixing the Compile error - Invalid outside procedure error when placing the long text into the VBA macro variable",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-vba-macro-line/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-vba-macro-line",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-vba-macro-line/",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-vba-macro-line/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-vba-macro-line/index.md",tags:[],version:"current",frontMatter:{layout:"sw-macro-fix",title:"Fix too long SOLIDWORKS VBA macro line error",caption:"Too Long VBA Macro Line"},sidebar:"tutorialSidebar",previous:{title:"\u8fd0\u884cSOLIDWORKS\u5b8f\u65f6\u4fee\u590d\u8def\u5f84\u8fc7\u957f\u9519\u8bef",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/too-long-macro-path/"},next:{title:"SOLIDWORKS\u5b8f\u7c7b\u578b - VBA (swp), SWBasic (swb), VSTA (dll)",permalink:"/solidworks-GPT/zh-Hans/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/macros/types/"}},l={},c=[{value:"Symptoms",id:"symptoms",level:2},{value:"Cause",id:"cause",level:2},{value:"Resolution",id:"resolution",level:2}],m={toc:c},u="wrapper";function p(e){let{components:o,...i}=e;return(0,r.kt)(u,(0,n.Z)({},m,i,{components:o,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Fixing the Compile error - Invalid outside procedure error when placing the long text into the VBA macro variable\nimage: doc-mgr-key-too-long.gif\nlabels: ","[macro, troubleshooting]","\nredirect-from:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"/2018/04/macro-troubleshooting-too-long-vba-macro-line.html")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"symptoms"},"Symptoms"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"SOLIDWORKS VBA macro is utilizing Document Manager APIs and new license was generated.\nWhen generated license is placed into the macro some text highlighted red and ",(0,r.kt)("em",{parentName:"li"},"Compile error: Invalid outside procedure error")," is displayed"),(0,r.kt)("li",{parentName:"ul"},"Macro is inserting static text into the note or custom properties. Text is replaced with new long text. Inserted string is highlighted and macro doesn't run")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Copy-pasting the Document Manager license key into the macro constant",src:t(38046).Z,width:"600",height:"284"})),(0,r.kt)("h2",{id:"cause"},"Cause"),(0,r.kt)("p",null,"Maximum number of symbols in a single line of VBA code is 1023.\nIt is not possible to insert more symbols without explicitly splitting the lines.\nPasting the line longer than the limit from the buffer will cause compilation errors.  "),(0,r.kt)("h2",{id:"resolution"},"Resolution"),(0,r.kt)("p",null,'Split the line into multiple lines (no longer than 1023 symbols in single line) and use "string1" & _ "string2" to concatenate the lines.  '),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Const SW_DM_KEY As String = "MyCompany:swdocmgr_general-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000," & _\n"swdocmgr_previews-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000," & _\n"swdocmgr_dimxpert-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000," & _\n"swdocmgr_geometry-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000," & _\n"swdocmgr_xml-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000," & _\n"swdocmgr_tessellation-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000-00000"\n\nDim swDmClassFactory As SwDocumentMgr.swDmClassFactory\nDim swDmApp As SwDocumentMgr.SwDMApplication\n\nSub main()\n\n    Set swDmClassFactory = CreateObject("SwDocumentMgr.SwDMClassFactory")\n    \n    If Not swDmClassFactory Is Nothing Then\n        Set swDmApp = swDmClassFactory.GetApplication(SW_DM_KEY)\n        Debug.Print swDmApp.GetLatestSupportedFileVersion()\n    Else\n        MsgBox "Document Manager SDK is not installed"\n    End If\n    \nEnd Sub\n')))}p.isMDXComponent=!0},38046:(e,o,t)=>{t.d(o,{Z:()=>n});const n=t.p+"assets/images/doc-mgr-key-too-long-f87850726d3da020fbc6976a0f738468.gif"}}]);