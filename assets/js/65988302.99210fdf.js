"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[90741],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>D});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),m=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=m(e.components);return o.createElement(c.Provider,{value:t},e.children)},l="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),l=m(n),u=r,D=l["".concat(c,".").concat(u)]||l[u]||d[u]||s;return n?o.createElement(D,a(a({ref:t},p),{},{components:n})):o.createElement(D,a({ref:t},p))}));function D(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,a=new Array(s);a[0]=u;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[l]="string"==typeof e?e:r,a[1]=i;for(var m=2;m<s;m++)a[m]=n[m];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8479:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>m});var o=n(87462),r=(n(67294),n(3905));const s={title:"Add invisible custom property to the model using SOLIDWORKS Document Manager API",caption:"Add Invisible Custom Property",description:"VBA macro to add invisible custom property to the model using SOLIDWORKS Document Manager API",labels:["invisible","custom property"]},a=void 0,i={unversionedId:"codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index",id:"codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index",title:"Add invisible custom property to the model using SOLIDWORKS Document Manager API",description:"VBA macro to add invisible custom property to the model using SOLIDWORKS Document Manager API",source:"@site/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index.md",sourceDirName:"codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property",slug:"/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/",permalink:"/solidworks-GPT/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/add-invisible-custom-property/index.md",tags:[],version:"current",frontMatter:{title:"Add invisible custom property to the model using SOLIDWORKS Document Manager API",caption:"Add Invisible Custom Property",description:"VBA macro to add invisible custom property to the model using SOLIDWORKS Document Manager API",labels:["invisible","custom property"]},sidebar:"tutorialSidebar",previous:{title:"Managing custom properties for files using SOLIDWORKS Document Manager API",permalink:"/solidworks-GPT/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/"},next:{title:"Excel macro to manage custom properties in SOLIDWORKS files",permalink:"/solidworks-GPT/docs/codestack/solidworks-document-manager-api/document/data-storage/custom-properties/excel-functions/"}},c={},m=[],p={toc:m},l="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(l,(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,'SOLIDWORKS models contain several invisible custom properties, such as $PRP:"SW-File Name", $PRP:"SW-Title". Those are read-only and cannot be modified from the user interface. It is however possible to add new custom property using Document Manager API. This property is not available in the custom property manager page and cannot be modified by the user or SOLIDWORKS API.'),(0,r.kt)("p",null,"This VBA example shows how to add the invisible custom property for the specified model. Configure the macro as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Const FILE_PATH As String = "C:\\SampleModel.SLDPRT" \'Full path to file to add invisible property to\nConst PRP_NAME As String = "MyProperty" \'Property name to add\nConst PRP_VAL As String = "MyValue" \'Property value to assign\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-vb"},'Const SW_DM_KEY As String = "Your license"\n\nConst FILE_PATH As String = "C:\\SampleModel.SLDPRT"\nConst PRP_NAME As String = "MyProperty"\nConst PRP_VAL As String = "MyValue"\n\nDim swDmClassFactory As SwDocumentMgr.swDmClassFactory\nDim swDmApp As SwDocumentMgr.SwDMApplication\n\nSub main()\n\n    Set swDmClassFactory = CreateObject("SwDocumentMgr.SwDMClassFactory")\n    \n    If Not swDmClassFactory Is Nothing Then\n        \n        Set swDmApp = swDmClassFactory.GetApplication(SW_DM_KEY)\n        Dim swDmDoc As SwDocumentMgr.SwDMDocument19\n        Set swDmDoc = OpenDocument(FILE_PATH, False)\n        \n        swDmDoc.AddInvisibleCustomProperty PRP_NAME, SwDmCustomInfoType.swDmCustomInfoText, PRP_VAL\n        swDmDoc.SetInvisibleCustomProperty PRP_NAME, PRP_VAL\n        \n        swDmDoc.Save\n        swDmDoc.CloseDoc\n        \n    Else\n        MsgBox "Document Manager SDK is not installed"\n    End If\n    \nEnd Sub\n\nFunction OpenDocument(filePath As String, readOnly As Boolean) As SwDocumentMgr.SwDMDocument19\n    \n    Dim openErr As SwDmDocumentOpenError\n    \n    Dim docType As SwDocumentMgr.SwDmDocumentType\n    \n    Dim ext As String\n    ext = LCase(Right(filePath, Len(".SLDXXX")))\n    \n    Select Case ext\n        Case ".sldprt"\n            docType = swDmDocumentPart\n        Case ".sldasm"\n            docType = swDmDocumentAssembly\n        Case ".slddrw"\n            docType = swDmDocumentDrawing\n    End Select\n    \n    Dim swDmDoc As SwDocumentMgr.SwDMDocument19\n    \n    Set swDmDoc = swDmApp.GetDocument(filePath, docType, readOnly, openErr)\n    \n    If swDmDoc Is Nothing Then\n        Err.Raise vbError, "", "Failed to open document: " & openErr\n    End If\n    \n    Set OpenDocument = swDmDoc\n    \nEnd Function\n')))}d.isMDXComponent=!0}}]);