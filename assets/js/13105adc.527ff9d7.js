"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[78231],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>m});var o=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=o.createContext({}),l=function(e){var t=o.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},d=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},f=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=l(r),f=n,m=u["".concat(c,".").concat(f)]||u[f]||p[f]||a;return r?o.createElement(m,s(s({ref:t},d),{},{components:r})):o.createElement(m,s({ref:t},d))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,s=new Array(a);s[0]=f;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[u]="string"==typeof e?e:n,s[1]=i;for(var l=2;l<a;l++)s[l]=r[l];return o.createElement.apply(null,s)}return o.createElement.apply(null,r)}f.displayName="MDXCreateElement"},20007:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var o=r(87462),n=(r(67294),r(3905));const a={caption:"Batch Create Folders",title:"Batch create feature folders in the active SOLIDWORKS document",description:"VBA macro creates specified number of the feature folders with the specified prefix name in the active SOLIDWORKS part or assembly"},s=void 0,i={unversionedId:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders/index",id:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders/index",title:"Batch create feature folders in the active SOLIDWORKS document",description:"VBA macro creates specified number of the feature folders with the specified prefix name in the active SOLIDWORKS part or assembly",source:"@site/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders/index.md",sourceDirName:"codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders",slug:"/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders/",permalink:"/solidworks-GPT/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-create-folders/index.md",tags:[],version:"current",frontMatter:{caption:"Batch Create Folders",title:"Batch create feature folders in the active SOLIDWORKS document",description:"VBA macro creates specified number of the feature folders with the specified prefix name in the active SOLIDWORKS part or assembly"},sidebar:"tutorialSidebar",previous:{title:"Set title as part number for new file using SOLIDWORKS API",permalink:"/solidworks-GPT/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/auto-part-number-title/"},next:{title:"Batch export SOLIDWORKS models via vbScript",permalink:"/solidworks-GPT/docs/codestack-clone/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/batch-export/"}},c={},l=[],d={toc:l},u="wrapper";function p(e){let{components:t,...r}=e;return(0,n.kt)(u,(0,o.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"This VBA macro allows to create feature folders in the batch mode in the active SOLIDWORKS assembly or part document."),(0,n.kt)("p",null,"Macro will ask for the number of folders to be created and the folder prefix name."),(0,n.kt)("p",null,"Macro will create the specified number of folder with the prefix name followed by the index."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"If folder with the next index already exists, next index will be used for the naming")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Dim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Dim swModel As SldWorks.ModelDoc2\n    \n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n    \n        Dim foldersCount As Integer\n        Dim folderNamePrefix As String\n        \n        foldersCount = CInt(InputBox("Specify the number of folders to create", "Batch Folder Creator", "5"))\n        folderNamePrefix = InputBox("Specify the prefix name of the folder", "Batch Folder Creator", "MyFolder")\n        \n        Dim swAnchorFeat As SldWorks.Feature\n        Set swAnchorFeat = swModel.Extension.GetLastFeatureAdded\n        \n        Dim swFeatMgr As SldWorks.FeatureManager\n        Set swFeatMgr = swModel.FeatureManager\n        \n        Dim i As Integer\n        \n        Dim nextIndex As Integer\n        nextIndex = 0\n        \n        For i = 1 To foldersCount\n            \n            swAnchorFeat.Select2 False, -1\n            \n            Dim swFolderFeat As SldWorks.Feature\n            Set swFolderFeat = swFeatMgr.InsertFeatureTreeFolder2(swFeatureTreeFolderType_e.swFeatureTreeFolder_EmptyBefore)\n            \n            If swFolderFeat Is Nothing Then\n                Err.Raise vbError, "", "Failed to create a folder, make sure there there is at least one feature in the model"\n            End If\n            \n            Dim folderName As String\n            \n            Do\n                nextIndex = nextIndex + 1\n                folderName = folderNamePrefix & nextIndex\n            Loop While False <> swFeatMgr.IsNameUsed(swNameType_e.swFeatureName, folderName)\n            \n            swFolderFeat.Name = folderName\n            \n            swModel.Extension.ReorderFeature swFolderFeat.Name, "", swMoveLocation_e.swMoveToEnd\n            \n        Next\n        \n    Else\n        Err.Raise vbError, "", "No model opened"\n    End If\n    \nEnd Sub\n')))}p.isMDXComponent=!0}}]);