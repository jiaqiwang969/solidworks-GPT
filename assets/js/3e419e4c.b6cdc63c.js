"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[48944],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>y});var o=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,o,a=function(e,t){if(null==e)return{};var r,o,a={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=o.createContext({}),l=function(e){var t=o.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=l(e.components);return o.createElement(p.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var r=e.components,a=e.mdxType,n=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=l(r),u=a,y=m["".concat(p,".").concat(u)]||m[u]||d[u]||n;return r?o.createElement(y,i(i({ref:t},c),{},{components:r})):o.createElement(y,i({ref:t},c))}));function y(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=r.length,i=new Array(n);i[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[m]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<n;l++)i[l]=r[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}u.displayName="MDXCreateElement"},45379:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>n,metadata:()=>s,toc:()=>l});var o=r(87462),a=(r(67294),r(3905));const n={layout:"sw-tool",title:"Macro to copy SOLIDWORKS custom property from material to model",caption:"Copy Custom Property From Material To Model",description:"Macro demonstrates how to copy the specified custom property from the material database to the model custom property using SOLIDWORKS API and XML parsers",image:"copy-material-custom-property.svg",labels:["material","xml","custom property"],group:"Materials"},i=void 0,s={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/copy-custom-property/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/copy-custom-property/index",title:"Macro to copy SOLIDWORKS custom property from material to model",description:"Macro demonstrates how to copy the specified custom property from the material database to the model custom property using SOLIDWORKS API and XML parsers",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/copy-custom-property/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/copy-custom-property",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/copy-custom-property/",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/copy-custom-property/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/copy-custom-property/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",title:"Macro to copy SOLIDWORKS custom property from material to model",caption:"Copy Custom Property From Material To Model",description:"Macro demonstrates how to copy the specified custom property from the material database to the model custom property using SOLIDWORKS API and XML parsers",image:"copy-material-custom-property.svg",labels:["material","xml","custom property"],group:"Materials"},sidebar:"tutorialSidebar",previous:{title:"Change apply appearance option in material using SOLIDWORKS API",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/change-apply-appearance/"},next:{title:"Show Edit Material dialog using SOLIDWORKS API",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/materials/show-edit-material-dialog/"}},p={},l=[],c={toc:l},m="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Custom property in the material",src:r(72702).Z,width:"953",height:"263"}),"{ width=450 }"),(0,a.kt)("p",null,"This macro demonstrates how to copy the specified custom property from the material database to the model custom property using SOLIDWORKS API and XML parsers."),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"MSXML2.DOMDocument")," object is used to read XML of the material database and select the required material node."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Specify the custom property name to copy via ",(0,a.kt)("em",{parentName:"li"},"PRP_NAME")," variable")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Const PRP_NAME As String = "MyProperty"\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Run the macro. Macro will find the material of active part and read the property value from the material database file"),(0,a.kt)("li",{parentName:"ul"},"Macro will create/update the generic custom property of the file to the corresponding value of the custom property from material")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Const PRP_NAME As String = "MyProperty"\n\nDim swApp As SldWorks.SldWorks\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Dim swPart As SldWorks.PartDoc\n    \n    Set swPart = swApp.ActiveDoc\n    \n    If Not swPart Is Nothing Then\n        \n        Dim materialName As String\n        Dim materialDb As String\n        materialDb = GetMaterialDatabase(swPart, materialName)\n        \n        If materialDb <> "" Then\n            Dim prpVal As String\n            prpVal = GetMaterialCustomProperty(materialName, materialDb, PRP_NAME)\n            SetCustomProperty swPart, PRP_NAME, prpVal\n        Else\n            MsgBox "Failed to find the material database"\n        End If\n        \n    Else\n        MsgBox "Please open part"\n    End If\n    \nEnd Sub\n\nFunction GetMaterialDatabase(part As SldWorks.PartDoc, ByRef materialName As String) As String\n    \n    Dim materialDbName As String\n    materialName = part.GetMaterialPropertyName2("", materialDbName)\n\n    Dim vDbs As Variant\n    vDbs = swApp.GetMaterialDatabases()\n    \n    If Not IsEmpty(vDbs) Then\n        \n        Dim i As Integer\n        \n        For i = 0 To UBound(vDbs)\n            Dim dbFilePath As String\n            dbFilePath = vDbs(i)\n            \n            Dim dbFileName As String\n            dbFileName = Right(dbFilePath, Len(dbFilePath) - InStrRev(dbFilePath, "\\"))\n                        \n            If LCase(dbFileName) = LCase(materialDbName & ".sldmat") Then\n                GetMaterialDatabase = dbFilePath\n                Exit Function\n            End If\n            \n        Next\n        \n    End If\n    \n    GetMaterialDatabase = ""\n    \nEnd Function\n\nFunction GetMaterialCustomProperty(materialName As String, materialDb As String, prpName As String) As String\n    \n    Dim xmlDoc As Object\n    \n    Set xmlDoc = CreateObject("MSXML2.DOMDocument")\n    xmlDoc.Load materialDb\n    \n    Dim matNode As Object\n    Set matNode = xmlDoc.SelectSingleNode("//classification/material[@name=\'" & materialName & "\']/custom/prop[@name=\'" & prpName & "\']")\n    \n    If Not matNode Is Nothing Then\n        GetMaterialCustomProperty = matNode.Attributes.GetNamedItem("value").Text\n    Else\n        Err.Raise vbError, , "Failed to find the custom property " & prpName & " in material " & materialName & " in database " & materialDb\n    End If\n    \nEnd Function\n\nSub SetCustomProperty(model As SldWorks.ModelDoc2, prpName As String, prpVal As String)\n    \n    Dim swPrpMgr As SldWorks.CustomPropertyManager\n    Set swPrpMgr = model.Extension.CustomPropertyManager("")\n    swPrpMgr.Add3 prpName, swCustomInfoType_e.swCustomInfoText, prpVal, swCustomPropertyAddOption_e.swCustomPropertyReplaceValue\n    swPrpMgr.Set2 prpName, prpVal\n    \nEnd Sub\n')))}d.isMDXComponent=!0},72702:(e,t,r)=>{r.d(t,{Z:()=>o});const o=r.p+"assets/images/material-custom-property-d0e8f4cb570fabb966e80dfb2e9d7bf4.png"}}]);