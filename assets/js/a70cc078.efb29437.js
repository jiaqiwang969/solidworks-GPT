"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[21545],{3905:(n,e,o)=>{o.d(e,{Zo:()=>c,kt:()=>A});var t=o(67294);function i(n,e,o){return e in n?Object.defineProperty(n,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[e]=o,n}function r(n,e){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.push.apply(o,t)}return o}function a(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach((function(e){i(n,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}))}return n}function s(n,e){if(null==n)return{};var o,t,i=function(n,e){if(null==n)return{};var o,t,i={},r=Object.keys(n);for(t=0;t<r.length;t++)o=r[t],e.indexOf(o)>=0||(i[o]=n[o]);return i}(n,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(t=0;t<r.length;t++)o=r[t],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(n,o)&&(i[o]=n[o])}return i}var m=t.createContext({}),l=function(n){var e=t.useContext(m),o=e;return n&&(o="function"==typeof n?n(e):a(a({},e),n)),o},c=function(n){var e=l(n.components);return t.createElement(m.Provider,{value:e},n.children)},d="mdxType",p={inlineCode:"code",wrapper:function(n){var e=n.children;return t.createElement(t.Fragment,{},e)}},u=t.forwardRef((function(n,e){var o=n.components,i=n.mdxType,r=n.originalType,m=n.parentName,c=s(n,["components","mdxType","originalType","parentName"]),d=l(o),u=i,A=d["".concat(m,".").concat(u)]||d[u]||p[u]||r;return o?t.createElement(A,a(a({ref:e},c),{},{components:o})):t.createElement(A,a({ref:e},c))}));function A(n,e){var o=arguments,i=e&&e.mdxType;if("string"==typeof n||i){var r=o.length,a=new Array(r);a[0]=u;var s={};for(var m in e)hasOwnProperty.call(e,m)&&(s[m]=e[m]);s.originalType=n,s[d]="string"==typeof n?n:i,a[1]=s;for(var l=2;l<r;l++)a[l]=o[l];return t.createElement.apply(null,a)}return t.createElement.apply(null,o)}u.displayName="MDXCreateElement"},42209:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>m,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var t=o(87462),i=(o(67294),o(3905));const r={layout:"sw-tool",title:"Notify the completion of long running SOLIDWORKS command using SOLIDWORKS API",caption:"Notify Long Running Command Completion",description:"VBA macro to handle the long running commands in SOLIDWORKS (open, rebuild, suppress etc.) and beep to notify its completion",image:"command-progress.svg",labels:["events","performance","notification","commands"],group:"Performance"},a=void 0,s={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/long-command-completion-notifier/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/long-command-completion-notifier/index",title:"Notify the completion of long running SOLIDWORKS command using SOLIDWORKS API",description:"VBA macro to handle the long running commands in SOLIDWORKS (open, rebuild, suppress etc.) and beep to notify its completion",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/long-command-completion-notifier/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/long-command-completion-notifier",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/long-command-completion-notifier/",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/long-command-completion-notifier/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/long-command-completion-notifier/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",title:"Notify the completion of long running SOLIDWORKS command using SOLIDWORKS API",caption:"Notify Long Running Command Completion",description:"VBA macro to handle the long running commands in SOLIDWORKS (open, rebuild, suppress etc.) and beep to notify its completion",image:"command-progress.svg",labels:["events","performance","notification","commands"],group:"Performance"},sidebar:"tutorialSidebar",previous:{title:"Macro to highlight/flash specific buttons in SOLIDWORKS toolbar",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/flash-toolbar-buttons/"},next:{title:"Run and configure SOLIDWORKS command using Windows API",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/frame/property-manager-page-windows-api/"}},m={},l=[{value:"Running instructions",id:"running-instructions",level:2}],c={toc:l},d="wrapper";function p(n){let{components:e,...r}=n;return(0,i.kt)(d,(0,t.Z)({},c,r,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Opening large assembly document in SOLIDWORKS",src:o(33021).Z,width:"459",height:"286"}),"{ width=450 }"),(0,i.kt)("p",null,"This VBA macro will listen for SOLIDWORKS commands (e.g. opening, rebuilding, suppressing, resolving etc.) using SOLIDWORKS API and identify the long running ones by matching the execution time to the user assigned delay period. If the command is running longer then this period, the beep signal is played notifying the user that the command is completed. If command is executed faster than no sound is played."),(0,i.kt)("p",null,"This can be useful when working with large models as it is possible to switch the screens or perform another activity while command is being executed and be notified once the operation is completed without the need to constantly monitor the progress."),(0,i.kt)("h2",{id:"running-instructions"},"Running instructions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create new macro and add the following code")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-vb"},"Const MIN_DELAY As Integer = 5\n\nDim swCmdsListener As CommandsListener\n\nSub main()\n\n    Set swCmdsListener = New CommandsListener\n    swCmdsListener.MinimumDelay = MIN_DELAY\n    \nEnd Sub\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Specify the command minimum delay in seconds by changing the value of ",(0,i.kt)("em",{parentName:"li"},"MIN_DELAY")," constant"),(0,i.kt)("li",{parentName:"ul"},"Create new class module and name it ",(0,i.kt)("em",{parentName:"li"},"CommandsListener"),". Paste the following code into the class module:"),(0,i.kt)("li",{parentName:"ul"},"Start the macro. To automatically start the macro with every SOLIDWORKS session follow the ",(0,i.kt)("a",{parentName:"li",href:"/docs/codestack/solidworks-api/getting-started/macros/run-macro-on-solidworks-start/"},"Run SOLIDWORKS macro automatically on application start")," article.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-vb"},'Dim WithEvents swApp As SldWorks.SldWorks\n\nDim IsCommandStarted As Boolean\nDim StartCommand As Long\nDim StartCommandTimeStamp As Date\n\nPublic MinimumDelay As Double\n\nPrivate Sub Class_Initialize()\n    Set swApp = Application.SldWorks\nEnd Sub\n\nPrivate Function swApp_CommandOpenPreNotify(ByVal Command As Long, ByVal UserCommand As Long) As Long\n    IsCommandStarted = True\n    StartCommand = Command\n    StartCommandTimeStamp = Now\n    swApp_CommandOpenPreNotify = 0\nEnd Function\n\nPrivate Function swApp_CommandCloseNotify(ByVal Command As Long, ByVal reason As Long) As Long\n    \n    If IsCommandStarted And Command = StartCommand Then\n    \n        IsCommandStarted = False\n    \n        Dim diff As Integer\n        diff = CInt(DateDiff("s", StartCommandTimeStamp, Now))\n        \n        Debug.Print diff\n        \n        If diff >= MinimumDelay Then\n            Beep\n        End If\n        \n    End If\n    \n    swApp_CommandCloseNotify = 0\n    \nEnd Function\n')))}p.isMDXComponent=!0},33021:(n,e,o)=>{o.d(e,{Z:()=>t});const t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcsAAAEeCAMAAADSL87pAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQAAAHaxzABgh6tgAO/v7zYAAHV1davknwAAYDYANk2ZvLGxsatgNoerh4c2AKrM3GBgYAAANgA2h4fO8M6rYDYAYDaHznShtmAAAGCr8DZgqzY2NqGhocvPyM6HNjY2h4ODgwA2NpeXlzmOtMPDw5S+0oeHYNDR0oeHzqurzvDnoYc2NkWUuPCrYExMTLa6vmCrqzaHh42OjodghyyGsIm4zmAANmAAYIeHNmBgq12hwABgq73JzqioqNbW1qW8xr6+v7u7u4c2YKuHNqtgYNTb4Hx8fGCHh2CHzmmoxcvP1YfOznCrxmA2NjaHq1GUs87Oh7PP3KDF1q6zubnS3oO40VSdvpvC1ECRt6vv72Kkw4680KXJ2jSLsn2yzG+tyWlpaZzG2nauyFiev5DA1rG2u8Ta5IK1zJbD187S1wAAADP/MzP/ZjP/mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZmzGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb//5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZAJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwAM8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8Amf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+ZzP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///9TlTJwAAABrdFJOU/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AeJlF4QAAAAlwSFlzAAAOwwAADsMBx2+oZAAAD1NJREFUeF7tnQt7G8UVhkW1DmkMSuOAa4MlqCxIs4lLCEtok6LaTZ0WSEuhbWLHGEpa3PD//0DPbXZHV+86uqwO3/s80s5N0njenYt2lE1jIr/596VH74IVopEAL8ClH+DSD+yyCzygLsUqWG3g0g9w6Qe49ANc+gEu/QCXK8ejfT3uP9JjDlyuHPsq0w4RcLl6iMVRlXC5ipDHMSrhciXZfzRGJVyuJHDpBhljexYp+Km5PDwjLLyqLGTtw+1U54b65/OjjDl9/I2l1Ip+u3cgtPuWMhazOCpzdi7Pnu9aQ31lKTXj7D7V7sqzZ8+e0PF2/SrZJou9NsHHKTaDw/ldK/hMRCr369g5n2bZUeiOV29n2bcWrgn9WCD1zxsWrMCMXJ7p4BU4vWrp9eF5lv3Xgsw3p9l/LFgLqDPGXZHMti1Yntm4PDOHBXWT+TTbHRosjrLnFqoB/YPhya9XXeZMXB4O9krmtF7DLJ1sIxXazb620PI5OLBAwf5ARy3DTFzGc2XgieXVgyfZCwsVHGdHFlo6vXHeDka/QU5nFi5HR1imTsv+r8Zq+y772EJLpj9W242qHXMWLh+bvUHqtLR4HM3fxVh7ll2x0JJp2whLXzB70fq1asechctTs6ecnn2rgUPLrgG7mQVkOrhvYUquRx33g0t6REuekFyWGbgcHGJ50aMXDeqzlD3LZ+9nUrPQHV+pyUQQL1l7RWfsVxxkZ+DyK2mfLPvsmJ5YJV9XIb49qQuPs++0qodas7CmffHlH/o1oB1fGIjCS3D5tbbPaZKcxCozvmRWF+wiz1WL2qL26i/l8ufyCc56vYE5suJXzBm4DA30jIawSGWm41k9eEWrGqaDY41+XzeXxHL7ZT5fytmeq8zGfetcFmG5c1tiNIQIJ3VxWZv5MpH2YeJemWVf22y1fD7O7ckVqlPrlsmVL39vU9ZyCVd9WF3UL3uLX8cm+cR4FKu8bbl14H4YVZPkmxfF2jXbtcCSyb9f9nrxZtfINdpzmIVLW/wMUZNrKsLTsZcUT+pydb0/dpEzPnUKs3AZ98ac2lzrFI5GL63zNY4xiUth7Gg65nr7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"}}]);