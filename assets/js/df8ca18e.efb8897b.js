"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[38923],{3905:(e,t,o)=>{o.d(t,{Zo:()=>d,kt:()=>h});var r=o(67294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var c=r.createContext({}),l=function(e){var t=r.useContext(c),o=t;return e&&(o="function"==typeof e?e(t):s(s({},t),e)),o},d=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,a=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=l(o),m=n,h=u["".concat(c,".").concat(m)]||u[m]||p[m]||a;return o?r.createElement(h,s(s({ref:t},d),{},{components:o})):r.createElement(h,s({ref:t},d))}));function h(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=o.length,s=new Array(a);s[0]=m;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[u]="string"==typeof e?e:n,s[1]=i;for(var l=2;l<a;l++)s[l]=o[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,o)}m.displayName="MDXCreateElement"},59507:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var r=o(87462),n=(o(67294),o(3905));const a={layout:"sw-macro-fix",title:"Fix issues with failed to connect to database or Excel in SOLIDWORKS macro",caption:"Failed to Connect To Database or Excel",description:"Fixing the error in the macro which connects to database (e.g. SQL, MySql, Oracle, MS Access etc.) or any other data source and doesn't read/write values or displays error",image:"odbc-drivers.png",labels:["macro","troubleshooting"],"redirect-from":["/2018/04/macro-troubleshooting-failed-to-connect-to-database-or-excel.html"]},s=void 0,i={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error/index",title:"Fix issues with failed to connect to database or Excel in SOLIDWORKS macro",description:"Fixing the error in the macro which connects to database (e.g. SQL, MySql, Oracle, MS Access etc.) or any other data source and doesn't read/write values or displays error",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error/",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/connect-database-excel-error/index.md",tags:[],version:"current",frontMatter:{layout:"sw-macro-fix",title:"Fix issues with failed to connect to database or Excel in SOLIDWORKS macro",caption:"Failed to Connect To Database or Excel",description:"Fixing the error in the macro which connects to database (e.g. SQL, MySql, Oracle, MS Access etc.) or any other data source and doesn't read/write values or displays error",image:"odbc-drivers.png",labels:["macro","troubleshooting"],"redirect-from":["/2018/04/macro-troubleshooting-failed-to-connect-to-database-or-excel.html"]},sidebar:"tutorialSidebar",previous:{title:"Fix SOLIDWORKS macro issues with lightweight components in assembly or drawing",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/assembly-drawing-lightweight-components/"},next:{title:"Fix errors when creating sketch segments using SOLIDWORKS API",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/create-sketch-segments-error/"}},c={},l=[{value:"Symptoms",id:"symptoms",level:2},{value:"Cause",id:"cause",level:2},{value:"Resolution",id:"resolution",level:2}],d={toc:l},u="wrapper";function p(e){let{components:t,...a}=e;return(0,n.kt)(u,(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"symptoms"},"Symptoms"),(0,n.kt)("p",null,"SOLIDWORKS macro should connect to database (e.g. SQL, MySql, Oracle, MS Access etc.) or any other data source (e.g. MS Excel).\nMacro doesn't read/write values or displays error."),(0,n.kt)("h2",{id:"cause"},"Cause"),(0,n.kt)("p",null,"The most common way to connect to database or Excel in VBA macros would be via abstraction layer such as ADODB, ODBC, OLEDB.\nIn order to connect to database the corresponding driver must be installed into the system and the valid connection string must be provided.\nThe drivers are also OS-architecture specific (x32/x64)"),(0,n.kt)("h2",{id:"resolution"},"Resolution"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Find what abstraction layer is used. Usually there will be lines of code similar to the following.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-vb"},'Set conn = CreateObject("ADODB.Connection")\nSet records = CreateObject("ADODB.Recordset")\n    \nDim xlsFilePath As String\nxlsFilePath = swApp.GetCurrentMacroPathFolder() & "\\" & EXCEL_FILE_NAME\n    \nconn.Open "Provider=Microsoft.ACE.OLEDB.12.0;" & _\n        "Data Source=" & xlsFilePath & _\n            ";Extended Properties=""Excel 8.0;HDR=Yes;"";"\n')),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Make sure that the appropriate driver is installed. For SOLIDWORKS 2013 onwards (check the drivers for x64 system).\nFor older SOLIDWORKS version check x32 versions). Usually the drivers can be downloaded for free from the database supplier web-site or database installation package.")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"List of ODBC drivers",src:o(4245).Z,width:"320",height:"246"}),"{ width=320 height=245 }"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Modify the connection string as required")))}p.isMDXComponent=!0},4245:(e,t,o)=>{o.d(t,{Z:()=>r});const r=o.p+"assets/images/odbc-drivers-48c839df6180c961d13908e009866e03.png"}}]);