"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[39214],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var o=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var a=o.createContext({}),c=function(e){var t=o.useContext(a),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=c(e.components);return o.createElement(a.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,a=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=i,h=p["".concat(a,".").concat(m)]||p[m]||u[m]||r;return n?o.createElement(h,s(s({ref:t},d),{},{components:n})):o.createElement(h,s({ref:t},d))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,s=new Array(r);s[0]=m;var l={};for(var a in t)hasOwnProperty.call(t,a)&&(l[a]=t[a]);l.originalType=e,l[p]="string"==typeof e?e:i,s[1]=l;for(var c=2;c<r;c++)s[c]=n[c];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},79965:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=n(87462),i=(n(67294),n(3905));const r={layout:"sw-macro-fix",title:"Fix the inconsistent model title extension in SOLIDWORKS API",caption:"Model Title Inconsistency Displaying Extension",description:"Fixing the Run-time Error '5' - Invalid procedure call or argument error when running a macro which is using the title of the model (e.g. inserting the note, linking the custom property value, generating new file name for exporting)",image:"invalid-procedure-or-call-error.png",labels:["macro","troubleshooting"],"redirect-from":["/2018/04/macro-troubleshooting--model-title-inconsistency-displaying-extension.html"]},s=void 0,l={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/model-title-inconsistency-displaying-extension/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/model-title-inconsistency-displaying-extension/index",title:"Fix the inconsistent model title extension in SOLIDWORKS API",description:"Fixing the Run-time Error '5' - Invalid procedure call or argument error when running a macro which is using the title of the model (e.g. inserting the note, linking the custom property value, generating new file name for exporting)",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/model-title-inconsistency-displaying-extension/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/model-title-inconsistency-displaying-extension",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/model-title-inconsistency-displaying-extension/",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/model-title-inconsistency-displaying-extension/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/model-title-inconsistency-displaying-extension/index.md",tags:[],version:"current",frontMatter:{layout:"sw-macro-fix",title:"Fix the inconsistent model title extension in SOLIDWORKS API",caption:"Model Title Inconsistency Displaying Extension",description:"Fixing the Run-time Error '5' - Invalid procedure call or argument error when running a macro which is using the title of the model (e.g. inserting the note, linking the custom property value, generating new file name for exporting)",image:"invalid-procedure-or-call-error.png",labels:["macro","troubleshooting"],"redirect-from":["/2018/04/macro-troubleshooting--model-title-inconsistency-displaying-extension.html"]},sidebar:"tutorialSidebar",previous:{title:"How to fix Missing SOLIDWORKS Type Library References error",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/missing-solidworks-type-library-references/"},next:{title:"SOLIDWORKS macro error when preconditions are not met",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/troubleshooting/macros/preconditions-not-met/"}},a={},c=[{value:"Symptoms",id:"symptoms",level:2},{value:"Cause",id:"cause",level:2},{value:"Resolution",id:"resolution",level:2}],d={toc:c},p="wrapper";function u(e){let{components:t,...r}=e;return(0,i.kt)(p,(0,o.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"symptoms"},"Symptoms"),(0,i.kt)("p",null,"SOLIDWORKS macro is using the title of the model (e.g. inserting the note, linking the custom property value, generating new file name for exporting).\nAs the result macro misbehaves (inserting extension twice) or displays the error: ",(0,i.kt)("em",{parentName:"p"},"Run-time Error '5': Invalid procedure call or argument"),"  "),(0,i.kt)("p",null,"The extension is extracted from the document title via ",(0,i.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2018/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imodeldoc2~gettitle.html"},"IModelDoc2::GetTitle")," SOLIDWORKS API method."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Run-time Error &#39;5&#39;: Invalid procedure call or argument error when running a macro",src:n(71020).Z,width:"640",height:"212"}),"{ width=640 height=211 }"),(0,i.kt)("h2",{id:"cause"},"Cause"),(0,i.kt)("p",null,"There are several factors which affect the way title is displayed to the user:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Extension visibility in the model's title is displayed based on the windows setting ",(0,i.kt)("em",{parentName:"li"},"'Hide extension for known file types'"),".\nDepending on this setting title of the model can either include or exclude extension (e.g. ",(0,i.kt)("em",{parentName:"li"},"Part1 "),"or ",(0,i.kt)("em",{parentName:"li"},"Part1.sldprt"),")  ")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Hide extensions for known file types option in Windows explorer",src:n(33522).Z,width:"278",height:"320"}),"{ width=277 height=320 }"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"For the newly created files (i.e. files which were never saved) extension is never displayed"),(0,i.kt)("li",{parentName:"ul"},"For drawings the title is a composition of a name and the active sheet. The extension is never displayed for drawings")),(0,i.kt)("h2",{id:"resolution"},"Resolution"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Change the setting based on the macro requirement"),(0,i.kt)("li",{parentName:"ul"},"Modify the macro code to consider both options. The example below provides two functions to get the title with or without extension regardless of the conditions.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-vb"},'Dim swApp As SldWorks.SldWorks\nDim swModel As SldWorks.ModelDoc2\n\nSub main()\n\n    Set swApp = Application.SldWorks\n\n    Set swModel = swApp.ActiveDoc\n    \n    If Not swModel Is Nothing Then\n    \n        Debug.Print GetTitleWithoutExtension(swModel)\n        Debug.Print GetTitleWithExtension(swModel)\n        \n    Else\n        MsgBox "Please open the model"\n    End If\n    \nEnd Sub\n\nFunction GetTitleWithExtension(model As SldWorks.ModelDoc2) As String\n    \n    Dim title As String\n    Dim ext As String\n    \n    Select Case model.GetType\n        Case swDocumentTypes_e.swDocPART\n            ext = ".sldprt"\n        Case swDocumentTypes_e.swDocASSEMBLY\n            ext = ".sldasm"\n        Case swDocumentTypes_e.swDocDRAWING\n            ext = ".slddrw"\n    End Select\n    \n    If model.GetPathName() = "" Then\n        title = model.GetTitle + ext \'extension is not shown for file which is not saved\n    Else\n        If IsExtensionShown() Then\n            title = model.GetTitle\n        Else\n            title = model.GetTitle + ext\n        End If\n    End If\n    \n    If model.GetType() = swDocumentTypes_e.swDocDRAWING Then\n        title = model.GetTitle() \'drawing extension never included into the title\n        title = Left(title, InStrRev(title, "-") - 2) + ext \'removing the sheet name from the drawing title\n    End If\n    \n    GetTitleWithExtension = title\n    \nEnd Function\n\nFunction GetTitleWithoutExtension(model As SldWorks.ModelDoc2) As String\n    \n    Const EXT_PATTERN = ".sldxxx"\n    \n    Dim title As String\n    \n    If model.GetPathName() = "" Then\n        title = model.GetTitle \'extension is not shown for file which is not saved\n    Else\n        If IsExtensionShown() Then\n            title = model.GetTitle\n            title = Left(title, Len(title) - Len(EXT_PATTERN))\n        Else\n            title = model.GetTitle\n        End If\n    End If\n    \n    If model.GetType() = swDocumentTypes_e.swDocDRAWING Then\n        title = Left(title, InStrRev(title, "-") - 2)\n    End If\n    \n    GetTitleWithoutExtension = title\n    \nEnd Function\n\nFunction IsExtensionShown() As Boolean\n\n    Const REG_KEY As String = "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\HideFileExt"\n    Const UNCHECKED As Integer = 0\n    \n    Dim wshShell As Object\n    Set wshShell = CreateObject("WScript.Shell")\n    \n    IsExtensionShown = wshShell.RegRead(REG_KEY) = UNCHECKED\n\nEnd Function\n')))}u.isMDXComponent=!0},33522:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/hide-extensions-for-known-file-types-a637cfe14668c70c8058174ea1c549a1.png"},71020:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/invalid-procedure-or-call-error-6dad17977cc838541c8e42dccf63de2b.png"}}]);