"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[81236],{3905:(e,o,n)=>{n.d(o,{Zo:()=>p,kt:()=>w});var t=n(67294);function s(e,o,n){return o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,e}function r(e,o){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),n.push.apply(n,t)}return n}function c(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?r(Object(n),!0).forEach((function(o){s(e,o,n[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}))}return e}function l(e,o){if(null==e)return{};var n,t,s=function(e,o){if(null==e)return{};var n,t,s={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],o.indexOf(n)>=0||(s[n]=e[n]);return s}(e,o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],o.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var i=t.createContext({}),a=function(e){var o=t.useContext(i),n=o;return e&&(n="function"==typeof e?e(o):c(c({},o),e)),n},p=function(e){var o=a(e.components);return t.createElement(i.Provider,{value:o},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var o=e.children;return t.createElement(t.Fragment,{},o)}},u=t.forwardRef((function(e,o){var n=e.components,s=e.mdxType,r=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=a(n),u=s,w=m["".concat(i,".").concat(u)]||m[u]||d[u]||r;return n?t.createElement(w,c(c({ref:o},p),{},{components:n})):t.createElement(w,c({ref:o},p))}));function w(e,o){var n=arguments,s=o&&o.mdxType;if("string"==typeof e||s){var r=n.length,c=new Array(r);c[0]=u;var l={};for(var i in o)hasOwnProperty.call(o,i)&&(l[i]=o[i]);l.originalType=e,l[m]="string"==typeof e?e:s,c[1]=l;for(var a=2;a<r;a++)c[a]=n[a];return t.createElement.apply(null,c)}return t.createElement.apply(null,n)}u.displayName="MDXCreateElement"},89485:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>i,contentTitle:()=>c,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var t=n(87462),s=(n(67294),n(3905));const r={layout:"sw-tool",title:"count all selected components using SOLIDWORKS API",caption:"Count All Selected Components",description:"Macro counts all unique components selected in the assembly and displays the result in the commands bar",image:"status-bar-selected-comps.png",labels:["assembly","count components","solidworks api","status bar","utility"],group:"Assembly","redirect-from":["/2018/03/solidworks-api-assembly-count-selected-components.html","/solidworks-api/document/assembly/count-all-selected-components"]},c=void 0,l={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/count-all-selected-components/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/count-all-selected-components/index",title:"count all selected components using SOLIDWORKS API",description:"Macro counts all unique components selected in the assembly and displays the result in the commands bar",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/count-all-selected-components/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/count-all-selected-components",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/count-all-selected-components/",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/count-all-selected-components/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/count-all-selected-components/index.md",tags:[],version:"current",frontMatter:{layout:"sw-tool",title:"count all selected components using SOLIDWORKS API",caption:"Count All Selected Components",description:"Macro counts all unique components selected in the assembly and displays the result in the commands bar",image:"status-bar-selected-comps.png",labels:["assembly","count components","solidworks api","status bar","utility"],group:"Assembly","redirect-from":["/2018/03/solidworks-api-assembly-count-selected-components.html","/solidworks-api/document/assembly/count-all-selected-components"]},sidebar:"tutorialSidebar",previous:{title:"Macro to copy path of SOLIDWORKS component to clipboard",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/copy-path/"},next:{title:"VBA macro to export component positions to CSV via SOLIDWORKS API",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/document/assembly/components/export-positions/"}},i={},a=[],p={toc:a},m="wrapper";function d(e){let{components:o,...r}=e;return(0,s.kt)(m,(0,t.Z)({},p,r,{components:o,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"This macro counts all unique components selected in the assembly using SOLIDWORKS API. Components can be either selected in the features manager tree or in the graphics area."),(0,s.kt)("p",null,"Macro will also count component if only entity of the component is selected (e.g. face or edge) using ",(0,s.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2018/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.ISelectionMgr.html"},"ISelectionMgr")," SOLIDWORKS API Interface.."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Quantity of selected components displayed in the status bar",src:n(32247).Z,width:"314",height:"320"}),"{ width=320 }"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-vb"},'Dim swApp As SldWorks.SldWorks\nDim swAssy As SldWorks.AssemblyDoc\n\nSub main()\n\n    Set swApp = Application.SldWorks\n    \n    Set swAssy = swApp.ActiveDoc\n    \n    If Not swAssy Is Nothing Then\n            \n        Dim swSelMgr As SldWorks.SelectionMgr\n        Set swSelMgr = swAssy.SelectionManager\n        \n        Dim swCompsColl As Collection\n        Set swCompsColl = New Collection\n        \n        Dim i As Integer\n        \n        For i = 0 To swSelMgr.GetSelectedObjectCount2(-1)\n            \n            Dim swComp As SldWorks.Component2\n            Set swComp = swSelMgr.GetSelectedObjectsComponent2(i)\n            \n            If Not swComp Is Nothing Then\n                If Not Contains(swCompsColl, swComp) Then \'get only unique components\n                    swCompsColl.Add swComp\n                End If\n            End If\n            \n        Next\n        \n        Dim swFrame As SldWorks.Frame\n        Set swFrame = swApp.Frame\n        swFrame.SetStatusBarText "Selected " & swCompsColl.Count() & " component(s)"\n    \n    Else\n        MsgBox "Please open assembly"\n    End If\n    \nEnd Sub\n\nFunction Contains(coll As Collection, item As Object) As Boolean\n    \n    Dim i As Integer\n    \n    For i = 1 To coll.Count\n        If coll.item(i) Is item Then\n            Contains = True\n            Exit Function\n        End If\n    Next\n    \n    Contains = False\n    \nEnd Function\n\n')))}d.isMDXComponent=!0},32247:(e,o,n)=>{n.d(o,{Z:()=>t});const t=n.p+"assets/images/status-bar-selected-comps-361f4ce8bf20f1eaa6791dd0aef89bd2.png"}}]);