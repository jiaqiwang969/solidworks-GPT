"use strict";(self.webpackChunksolidworks_gpt=self.webpackChunksolidworks_gpt||[]).push([[42211],{3905:(t,e,i)=>{i.d(e,{Zo:()=>d,kt:()=>I});var n=i(67294);function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function l(t,e){if(null==t)return{};var i,n,a=function(t,e){if(null==t)return{};var i,n,a={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(a[i]=t[i]);return a}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(a[i]=t[i])}return a}var s=n.createContext({}),c=function(t){var e=n.useContext(s),i=e;return t&&(i="function"==typeof t?t(e):o(o({},e),t)),i},d=function(t){var e=c(t.components);return n.createElement(s.Provider,{value:e},t.children)},m="mdxType",p={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},u=n.forwardRef((function(t,e){var i=t.components,a=t.mdxType,r=t.originalType,s=t.parentName,d=l(t,["components","mdxType","originalType","parentName"]),m=c(i),u=a,I=m["".concat(s,".").concat(u)]||m[u]||p[u]||r;return i?n.createElement(I,o(o({ref:e},d),{},{components:i})):n.createElement(I,o({ref:e},d))}));function I(t,e){var i=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var r=i.length,o=new Array(r);o[0]=u;var l={};for(var s in e)hasOwnProperty.call(e,s)&&(l[s]=e[s]);l.originalType=t,l[m]="string"==typeof t?t:a,o[1]=l;for(var c=2;c<r;c++)o[c]=i[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,i)}u.displayName="MDXCreateElement"},2699:(t,e,i)=>{i.r(e),i.d(e,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var n=i(87462),a=(i(67294),i(3905));const r={title:"Using transformations in SOLIDWORKS API",caption:"Transformation",description:"Applying and reading transformation (components, bodies, sketches etc.) using SOLIDWORKS API",sidebar_position:2,labels:["transform","math"]},o=void 0,l={unversionedId:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation/index",id:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation/index",title:"Using transformations in SOLIDWORKS API",description:"Applying and reading transformation (components, bodies, sketches etc.) using SOLIDWORKS API",source:"@site/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation/index.md",sourceDirName:"codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation",slug:"/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation/",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation/",draft:!1,editUrl:"https://github.com/jiaqiwang969/solidworks-GPT/edit/main/website/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation/index.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Using transformations in SOLIDWORKS API",caption:"Transformation",description:"Applying and reading transformation (components, bodies, sketches etc.) using SOLIDWORKS API",sidebar_position:2,labels:["transform","math"]},sidebar:"tutorialSidebar",previous:{title:"Recording and editing macros in SOLIDWORKS",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/recording/"},next:{title:"Usage of assembly component transformation in SOLIDWORKS API",permalink:"/solidworks-GPT/docs/codestack/solidworks-api/troubleshooting/macros/windows-api-functions-incorrect-use/transformation/assembly-component-transformation/"}},s={},c=[{value:"Identity Matrix",id:"identity-matrix",level:2},{value:"Visual Basic",id:"visual-basic",level:3},{value:"C#",id:"c",level:3}],d={toc:c},m="wrapper";function p(t){let{components:e,...r}=t;return(0,a.kt)(m,(0,n.Z)({},d,r,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Transformation in SOLIDWORKS API is represented in the ",(0,a.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2018/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imathtransform.html"},"IMathTransform")," interface. This is a 4x4 transformation matrix holding the information about transform, scale and translation."),(0,a.kt)("p",null,"Matrix array is represented with 16 doubles (0 to 15) which are aligned in the following order"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null}),(0,a.kt)("th",{parentName:"tr",align:null}),(0,a.kt)("th",{parentName:"tr",align:null}),(0,a.kt)("th",{parentName:"tr",align:null}))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"0"),(0,a.kt)("td",{parentName:"tr",align:null},"1"),(0,a.kt)("td",{parentName:"tr",align:null},"2"),(0,a.kt)("td",{parentName:"tr",align:null},"13")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"3"),(0,a.kt)("td",{parentName:"tr",align:null},"4"),(0,a.kt)("td",{parentName:"tr",align:null},"5"),(0,a.kt)("td",{parentName:"tr",align:null},"14")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"6"),(0,a.kt)("td",{parentName:"tr",align:null},"7"),(0,a.kt)("td",{parentName:"tr",align:null},"8"),(0,a.kt)("td",{parentName:"tr",align:null},"15")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"9"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"11"),(0,a.kt)("td",{parentName:"tr",align:null},"12")))),(0,a.kt)("p",null,"0-8 - rotational part of the matrix"),(0,a.kt)("p",null,"9-11 - translation part of matrix (x, y, z)"),(0,a.kt)("p",null,"12 - scale factor"),(0,a.kt)("p",null,"13-15 - not used"),(0,a.kt)("p",null,"Matrix describe the orientation and translation of various elements in SOLIDWORKS, such as"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Components positions in the assembly"),(0,a.kt)("li",{parentName:"ul"},"Bodies relative movements"),(0,a.kt)("li",{parentName:"ul"},"Relation between sketch coordinate system and model coordinate system"),(0,a.kt)("li",{parentName:"ul"},"Camera orientation and model view rotation")),(0,a.kt)("p",null,"In a very simplistic representation you can consider transforms as a value you need to apply to original location (position, rotation) to get to the destination location."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"transform.svg",src:i(54721).Z,width:"136",height:"114"}),"{ width=250 }"),(0,a.kt)("h2",{id:"identity-matrix"},"Identity Matrix"),(0,a.kt)("p",null,"Identity matrix which represents no rotation, scale or transform will be equal to"),(0,a.kt)("h3",{id:"visual-basic"},"Visual Basic"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},"Dim dMatrix(15) As Double\ndMatrix(0) = 1: dMatrix(1) = 0: dMatrix(2) = 0: dMatrix(3) = 0\ndMatrix(4) = 1: dMatrix(5) = 0: dMatrix(6) = 0: dMatrix(7) = 0\ndMatrix(8) = 1: dMatrix(9) = 0: dMatrix(10) = 0: dMatrix(11) = 0\ndMatrix(12) = 1: dMatrix(13) = 0: dMatrix(14) = 0: dMatrix(15) = 0\n")),(0,a.kt)("h3",{id:"c"},"C#"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"var matrix = new double[]\n{\n    1, 0, 0, 0,\n    1, 0, 0, 0,\n    1, 0, 0, 0,\n    1, 0, 0, 0\n};\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://help.solidworks.com/2018/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imathutility.html"},"IMathUtility")," is a SOLIDWORKS API utility interface providing the access to operations related to composing the transformation based on input parameters (such as rotation angles, translation, raw data)."),(0,a.kt)("p",null,"The following interfaces are usually used while calculation of transformations and translations:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://help.solidworks.com/2018/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imathvector.html"},"IMathVector")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://help.solidworks.com/2018/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.imathpoint.html"},"IMathPoint"))),(0,a.kt)("p",null,"This example contains articles and tutorials explaining the use of transformation matrices."))}p.isMDXComponent=!0},54721:(t,e,i)=>{i.d(e,{Z:()=>n});const n="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMzYuMjc1IDExNC4wNzIiPjxkZWZzPjxtYXJrZXIgaWQ9ImEiIG9yaWVudD0iYXV0byIgb3ZlcmZsb3c9InZpc2libGUiIHJlZlg9IjAiIHJlZlk9IjAiPjxwYXRoIGZpbGw9IiMzOTU3Y2QiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjMzk1N2NkIiBzdHJva2Utd2lkdGg9IjEuMDY2NCIgZD0iTS0xMCAwbC00IDRMMCAwbC0xNC00eiIvPjwvbWFya2VyPjwvZGVmcz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDAuMTYgLTUuOTA4KSI+PHJlY3Qgd2lkdGg9IjMxLjc1IiBoZWlnaHQ9IjUxLjM3MyIgeD0iNDAuODIxIiB5PSI2Ny45NDYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIxLjMyMyIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgZmlsbCBzdHJva2UiIHJ5PSI1Ii8+PHRleHQgc3R5bGU9ImxpbmUtaGVpZ2h0OjEuMjUiIHg9IjQ0LjI3OCIgeT0iMTA0LjYxIiBmaWxsPSIjZTQyMjIyIiBzdHJva2Utd2lkdGg9Ii45MDEiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjM2LjA1NyIgZm9udC13ZWlnaHQ9IjQwMCIgbGV0dGVyLXNwYWNpbmc9IjAiIHdvcmQtc3BhY2luZz0iMCI+PHRzcGFuIHg9IjQ0LjI3OCIgeT0iMTA0LjYxIj5BPC90c3Bhbj48L3RleHQ+PHRleHQgc3R5bGU9ImxpbmUtaGVpZ2h0OjEuMjUiIHg9IjYzLjIyMSIgeT0iMTQyLjg1OCIgZmlsbD0iI2U0MjIyMiIgc3Ryb2tlLXdpZHRoPSIuOTAxIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIzNi4wNTciIGZvbnQtd2VpZ2h0PSI0MDAiIGxldHRlci1zcGFjaW5nPSIwIiB0cmFuc2Zvcm09InJvdGF0ZSgtNDcuNTg1KSIgd29yZC1zcGFjaW5nPSIwIj48dHNwYW4geD0iNjMuMjIxIiB5PSIxNDIuODU4IiBmaWxsPSIjM2E4NDE3Ij5CPC90c3Bhbj48L3RleHQ+PHJlY3Qgd2lkdGg9IjMxLjc1IiBoZWlnaHQ9IjUxLjM3MyIgeD0iNTkuMjkzIiB5PSIxMDYuMzMyIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS4zMjMiIHBhaW50LW9yZGVyPSJtYXJrZXJzIGZpbGwgc3Ryb2tlIiByeT0iNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTQ3LjU4NSkiLz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzOTU3Y2QiIG1hcmtlci1lbmQ9InVybCgjYSkiIGQ9Ik04MC40NCA4OS45MTFjMTIuODU4LTIuMDkzIDI1LjcxNS00LjE4NiAzNS4wMzktMTAuNjc1IDkuMzIzLTYuNDg5IDE1LjExMi0xNy4zNzIgMjAuOTAyLTI4LjI1NyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLjM3OCAyLjY0NikiLz48dGV4dCBzdHlsZT0ibGluZS1oZWlnaHQ6MS4yNSIgeD0iMjIuMjgzIiB5PSIxNDMuMjc0IiBmaWxsPSIjMzk1N2NkIiBzdHJva2Utd2lkdGg9Ii4yNjUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwLjU4MyIgZm9udC13ZWlnaHQ9IjQwMCIgbGV0dGVyLXNwYWNpbmc9IjAiIHRyYW5zZm9ybT0icm90YXRlKC0zMy44NjUpIiB3b3JkLXNwYWNpbmc9IjAiPjx0c3BhbiB4PSIyMi4yODMiIHk9IjE0My4yNzQiPnRyYW5zZm9ybTwvdHNwYW4+PC90ZXh0PjwvZz48L3N2Zz4="}}]);